
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<!-- Mirrored from devlib.symbian.slions.net/belle/GUID-26FD66B4-A291-5DAD-991D-40AB5316F30C.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 04:04:52 GMT -->
<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="copyright" content="(C) Copyright 2012" /><meta name="DC.rights.owner" content="(C) Copyright 2012" /><meta name="DC.Type" content="concept" /><meta name="DC.Title" content="Initializing And Processing an Image Tutorial" /><meta name="DC.Relation" scheme="URI" content="GUID-F221B15F-B5DE-516F-8FB0-75C1971DB3AF" /><meta name="DC.Relation" scheme="URI" content="GUID-03866ADB-5916-5B31-BCF0-44F94E12B740" /><meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7" /><meta name="DC.Relation" scheme="URI" content="GUID-1DE5CDAD-8D71-5384-9E98-5665D5A4C792" /><meta name="DC.Relation" scheme="URI" content="GUID-3E341F9F-2635-589B-A59A-B999FE7DF9BE" /><meta name="DC.Relation" scheme="URI" content="GUID-7DB86BF1-0485-5CBA-9554-4C474B0EC1FB" /><meta name="DC.Relation" scheme="URI" content="GUID-042868E6-88BF-5797-BB53-8E34283DCF16" /><meta name="DC.Format" content="XHTML" /><meta name="DC.Identifier" content="GUID-26FD66B4-A291-5DAD-991D-40AB5316F30C" /><meta name="DC.Language" content="en" /><title> Initializing And Processing an Image Tutorial </title><link href="css/s60/style.css" rel="stylesheet" type="text/css" /><link href="PLUGINS_ROOT/com.nokia.forum.library/css/category_cpp5.html" rel="stylesheet" type="text/css" /></head><body><div class="body"><div class="contentLeft prTxt"><h1 class="pageHeading" id="GUID-26FD66B4-A291-5DAD-991D-40AB5316F30C"> Initializing And Processing an Image Tutorial</h1><div><p>This document gives you more information about Image Processor. </p> <div><h3 class="section-title">Purpose</h3> <p>The purpose of this tutorial is to show you how to initialize and process an image. </p> <p><strong>Required background</strong> </p> <p>Image Processor features are provided through the Imaging Frameworks and the Imaging Plug-ins components. </p> <p><strong>Introduction</strong> </p> <p>Every new instance of Image Processor must be initialized before processing. </p> <p><strong>Initializing an image </strong> </p> <p>You need to choose an input image you want to work with. You can start </p> <ul><li id="GUID-DDB8CA71-838F-539E-93E2-E0A7666573CC"><a name="GUID-DDB8CA71-838F-539E-93E2-E0A7666573CC"><!-- --></a><p>with an image file stored on flash memory or a hard drive </p> </li> <li id="GUID-D8DFE478-7542-5A43-BC51-61D294E5D8D9"><a name="GUID-D8DFE478-7542-5A43-BC51-61D294E5D8D9"><!-- --></a><p>with a memory buffer containing an image of any of the supported image formats </p> </li> <li id="GUID-E7FFA3E5-F264-51F2-8420-C4B9CDE538BE"><a name="GUID-E7FFA3E5-F264-51F2-8420-C4B9CDE538BE"><!-- --></a><p>with a Symbian bitmap or image frame </p> </li> <li id="GUID-60E1993A-51A7-5596-8D46-63F0BBB8D172"><a name="GUID-60E1993A-51A7-5596-8D46-63F0BBB8D172"><!-- --></a><p>by only specifying a background colour. </p> </li> </ul> <p>An image stored on file is the most likely option if you are building an editor (most mobile cameras store images in JPEG format on flash memory). If you transfer images from your Digital Still Camera (DSC) or your PC to your mobile phone, the images are probably stored as JPEG files. </p> <p>If you build a camera application, you receive viewfinder data from the camera module. In this case you will use Symbian bitmaps or image frames. </p> <p>If you want to start with an empty image, only specify the background colour. For example, if you want to create a collage of several images, you do not really have a main source image and it is memory efficient to set a ‘blank’ input. </p> <p><strong>Processing an image </strong> </p> <p>When you process an image, all the operations and settings you specified in your Image Processor instance are performed on your input image. </p> <p>There are three options to choose from to get the output format. In a mobile imaging application there are at least two formats you want your results in. You want to see a preview of the result on the screen of the mobile phone – in which case you render to a bitmap or image frame. When you are satisfied with the preview you want to apply the operations and effects on the source image that is usually significantly larger – you will then render to a file on the flash memory. </p> <p>To see a preview of the image call Imageprocessor::TPreview::RenderL(). To apply the effects on the source image to get a full resolution result call <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-13E30312-DD05-3581-9A59-C3569A981657.html#GUID-81D98D3A-7B5A-3D2E-81CE-A3F2F3D5BCA5"><code class="apiname">ImageProcessor::CImgProcessor::ProcessL()</code></a> which will render to the output you have set. </p> </div> <div><h3 class="section-title">Using the image processor</h3> <p>The following tasks are covered in this tutorial: </p> <ul><li id="GUID-FEAF6932-E193-5177-BFCD-A2CB6FB8DFF3"><a name="GUID-FEAF6932-E193-5177-BFCD-A2CB6FB8DFF3"><!-- --></a><p><a href="#GUID-12E1341A-966C-5033-BEB0-6F2C0705CCE3">How to set an input image</a> </p> </li> <li id="GUID-1362E175-4652-5645-A1E8-2732F2DF9EE4"><a name="GUID-1362E175-4652-5645-A1E8-2732F2DF9EE4"><!-- --></a><p><a href="#GUID-F3DCFD1D-A5E2-5005-8598-621A96646514">How to set an output image</a> </p> </li> <li id="GUID-0FBDA00D-1738-52A7-B5F3-74E29E719D04"><a name="GUID-0FBDA00D-1738-52A7-B5F3-74E29E719D04"><!-- --></a><p><a href="#GUID-681FC188-0A6C-5A18-8073-7CD55A18B010">How to process the image</a> </p> </li> </ul> <p id="GUID-12E1341A-966C-5033-BEB0-6F2C0705CCE3"><a name="GUID-12E1341A-966C-5033-BEB0-6F2C0705CCE3"><!-- --></a><strong>Basic procedure to set an input image</strong> </p> <p>The various ways to set an input image are as follows: </p> <ul><li id="GUID-49FACCE8-1728-5E3C-96AF-048B402C563B"><a name="GUID-49FACCE8-1728-5E3C-96AF-048B402C563B"><!-- --></a><p>To create an internal pixel buffer for an input image use <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-13E30312-DD05-3581-9A59-C3569A981657.html#GUID-DFD4ECDB-E1AF-35B0-87E4-2E6745227386"><code class="apiname">ImageProcessor::CImgProcessor::CreateInputL(CFbsBitmap&amp;
                  )</code></a>. </p> </li> <li id="GUID-8BBB9526-BCF0-5B12-909F-FCF107AE73F0"><a name="GUID-8BBB9526-BCF0-5B12-909F-FCF107AE73F0"><!-- --></a><p>To create an internal pixel buffer for an input image use <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-13E30312-DD05-3581-9A59-C3569A981657.html#GUID-6B18D0DA-CDDA-3F7C-AC81-994C579AF5C9"><code class="apiname">ImageProcessor::CImgProcessor::CreateInputL(CImageFrame&amp;
                  )</code></a>. </p> </li> <li id="GUID-FF4FA4E8-3090-57F3-B6AB-F2D69E3728D8"><a name="GUID-FF4FA4E8-3090-57F3-B6AB-F2D69E3728D8"><!-- --></a><p>To create an internal pixel buffer for an input image using a size and then initialize the source image with a colour use <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-13E30312-DD05-3581-9A59-C3569A981657.html#GUID-1A827FED-4622-3CC2-9DA6-8E80D2F02962"><code class="apiname">ImageProcessor::CImgProcessor::CreateInputL(const TSize&amp;
                  )</code></a>. </p> </li> <li id="GUID-9A7EAD5F-7F11-5C9E-944B-08D7A3D1F5E2"><a name="GUID-9A7EAD5F-7F11-5C9E-944B-08D7A3D1F5E2"><!-- --></a><p>To set or update an input image to a specified file name use <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-13E30312-DD05-3581-9A59-C3569A981657.html#GUID-45A69154-5273-3B30-A9B2-6C9E7B1D4035"><code class="apiname">ImageProcessor::CImgProcessor::SetInputL(const TDesC&amp;
                  )</code></a>. </p> </li> <li id="GUID-C13CD1AE-BBDB-58E3-85CE-FBEF7B72DDB0"><a name="GUID-C13CD1AE-BBDB-58E3-85CE-FBEF7B72DDB0"><!-- --></a><p>To set or updated an input image to a file use <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-13E30312-DD05-3581-9A59-C3569A981657.html#GUID-A9197BBB-D408-3D0C-A8A1-E40DBC3B89F5"><code class="apiname">ImageProcessor::CImgProcessor::SetInputL(RFile&amp; )</code></a>. </p> </li> <li id="GUID-22F43407-00DE-59F9-BD3B-1CA53981B9E2"><a name="GUID-22F43407-00DE-59F9-BD3B-1CA53981B9E2"><!-- --></a><p>To set or update a DRM protected input image use <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-13E30312-DD05-3581-9A59-C3569A981657.html#GUID-09022CC2-706D-37A5-8240-2C33F616E072"><code class="apiname">ImageProcessor::CImgProcessor::SetInputL(TMMSource&amp; )</code></a>. </p> </li> <li id="GUID-4FA894C9-857A-5FAC-A6FC-4F6755073980"><a name="GUID-4FA894C9-857A-5FAC-A6FC-4F6755073980"><!-- --></a><p>To set or update an input image from a memory buffer use <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-13E30312-DD05-3581-9A59-C3569A981657.html#GUID-34EE7AB6-5BD4-319B-80E1-D74BE1F9DE12"><code class="apiname">ImageProcessor::CImgProcessor::SetInputL(const TDesC8&amp;
                  )</code></a>. </p> </li> <li id="GUID-1214AC4F-E0D9-585E-99B9-E7DCA7BC289C"><a name="GUID-1214AC4F-E0D9-585E-99B9-E7DCA7BC289C"><!-- --></a><p>To set or update an input image from a provided bitmap use <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-13E30312-DD05-3581-9A59-C3569A981657.html#GUID-0A55857F-B839-3319-826A-EB5EE6316A52"><code class="apiname">ImageProcessor::CImgProcessor::SetInputL(const CFbsBitmap&amp;
                  )</code></a>. </p> </li> <li id="GUID-439696FB-08DE-541B-BA86-A13098DB052C"><a name="GUID-439696FB-08DE-541B-BA86-A13098DB052C"><!-- --></a><p>To set or update an input image from a provided image frame use <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-13E30312-DD05-3581-9A59-C3569A981657.html#GUID-8E379FFE-1CF9-30D4-B041-9D5EDED7C91B"><code class="apiname">ImageProcessor::CImgProcessor::SetInputL(const CImageFrame&amp;
                  )</code></a>. </p> </li> </ul> <p id="GUID-F3DCFD1D-A5E2-5005-8598-621A96646514"><a name="GUID-F3DCFD1D-A5E2-5005-8598-621A96646514"><!-- --></a><strong>Basic procedure to set an output image</strong> </p> <p>The various ways to set an output image are as follows: </p> <ul><li id="GUID-DAB7C887-94E0-5654-BC42-C926D86D2C7A"><a name="GUID-DAB7C887-94E0-5654-BC42-C926D86D2C7A"><!-- --></a><p>To set an output image image to a file call <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-13E30312-DD05-3581-9A59-C3569A981657.html#GUID-EFE2CBB2-ADF3-3239-B63F-F0272A6556DA"><code class="apiname">ImageProcessor::CImgProcessor::SetOutputL(const TDesC&amp;
                  )</code></a>. </p> </li> <li id="GUID-579ABD52-B3D8-5E53-A2BA-CB7869B18DDA"><a name="GUID-579ABD52-B3D8-5E53-A2BA-CB7869B18DDA"><!-- --></a><p>To set an output image to a file represented by a file handle call <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-13E30312-DD05-3581-9A59-C3569A981657.html#GUID-DF3E1C52-A491-3389-8C54-1EA1C14D3899"><code class="apiname">ImageProcessor::CImgProcessor::SetOutputL(RFile&amp;
                  )</code></a>. </p> </li> <li id="GUID-111D5DDA-677C-5F08-93D9-CE931CFED288"><a name="GUID-111D5DDA-677C-5F08-93D9-CE931CFED288"><!-- --></a><p>To set an output image to the memory buffer call <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-13E30312-DD05-3581-9A59-C3569A981657.html#GUID-BB45A1D3-88F0-3282-A78E-37B2EBEE5020"><code class="apiname">ImageProcessor::CImgProcessor::SetOutputL(RBuf8&amp; )</code></a>. </p> </li> <li id="GUID-1B0AF58D-9ADB-59B7-99DD-CFE2701ED6A9"><a name="GUID-1B0AF58D-9ADB-59B7-99DD-CFE2701ED6A9"><!-- --></a><p>To set an output image to a pixel buffer call <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-13E30312-DD05-3581-9A59-C3569A981657.html#GUID-11F95F53-ACE7-34BC-9B27-23CBC6C55A5D"><code class="apiname">ImageProcessor::CImgProcessor::SetOutputL(CImageFrame&amp;
                  )</code></a>. </p> </li> <li id="GUID-8534B622-766A-556B-B054-B78B9F2EDAD6"><a name="GUID-8534B622-766A-556B-B054-B78B9F2EDAD6"><!-- --></a><p>To set an output image to an OS native bitmap call <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-13E30312-DD05-3581-9A59-C3569A981657.html#GUID-24FFB475-134A-314E-848C-ED8A32A57161"><code class="apiname">ImageProcessor::CImgProcessor::SetOutputL(CFbsBitmap&amp;
                  )</code></a>. </p> </li> </ul> <p> <strong>Note:</strong> Rendering is not performed when you set an output image. In case of setting the output image to a memory buffer <code class="codeph">RBuf8</code> instance should not contain pre-allocated memory. </p> <p id="GUID-681FC188-0A6C-5A18-8073-7CD55A18B010"><a name="GUID-681FC188-0A6C-5A18-8073-7CD55A18B010"><!-- --></a><strong>Basic procedure to process the image</strong> </p> <p>The high level steps to process an image are as follows: </p> <ul><li id="GUID-8DC5181E-E2B2-5767-A369-0F23389ED119"><a name="GUID-8DC5181E-E2B2-5767-A369-0F23389ED119"><!-- --></a><p>To initialize the Image Processor instance call <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-13E30312-DD05-3581-9A59-C3569A981657.html#GUID-FF3D1D45-1330-3718-920E-D8EB135D2592"><code class="apiname">ImageProcessor::CImgProcessor::InitializeL()</code></a>. </p> <p> <strong>Note:</strong> By default the initialization of Image Processor is asynchronous. </p> </li> <li id="GUID-0EF128C0-719C-5072-955E-C03E17778D9F"><a name="GUID-0EF128C0-719C-5072-955E-C03E17778D9F"><!-- --></a><p>To set an input image call <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-13E30312-DD05-3581-9A59-C3569A981657.html#GUID-0448A658-7DD6-3767-82FC-1EE64B1CBEE3"><code class="apiname">ImageProcessor::CImgProcessor::SetInputL()</code></a>. </p> </li> <li id="GUID-A80B9E4D-EAE8-5F3F-A880-B15022D0AB4E"><a name="GUID-A80B9E4D-EAE8-5F3F-A880-B15022D0AB4E"><!-- --></a><p>To set an output image call <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-13E30312-DD05-3581-9A59-C3569A981657.html#GUID-D79E1EEA-5054-355E-8E61-E2AF5C7A229D"><code class="apiname">ImageProcessor::CImgProcessor::SetOutputL()</code></a>. </p> </li> <li id="GUID-74D87831-2393-5A6A-95B8-2F922056D014"><a name="GUID-74D87831-2393-5A6A-95B8-2F922056D014"><!-- --></a><p>To retrieve information about an output image call <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-13E30312-DD05-3581-9A59-C3569A981657.html#GUID-537F658F-3246-3A50-B528-7D801339AD08"><code class="apiname">ImageProcessor::CImgProcessor::TOutputInfo()</code></a>. </p> </li> <li id="GUID-BCF98768-978D-54AF-B056-67A31342C7B8"><a name="GUID-BCF98768-978D-54AF-B056-67A31342C7B8"><!-- --></a><p>To set quality for an output image (in the case of JPEG output) call TOutputInfo::SetJpegQualityL(TReal32&amp; ). </p> </li> <li id="GUID-D5BCC7BF-8885-5A27-AF86-D06D63CFE8B7"><a name="GUID-D5BCC7BF-8885-5A27-AF86-D06D63CFE8B7"><!-- --></a><p>To process an input image and create the output image call <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-13E30312-DD05-3581-9A59-C3569A981657.html#GUID-81D98D3A-7B5A-3D2E-81CE-A3F2F3D5BCA5"><code class="apiname">ImageProcessor::CImgProcessor::ProcessL()</code></a>. </p> </li> </ul> <p><strong>Example </strong> </p> <pre class="codeblock">

 ImageProcessor::ImageProcessor::CImgProcessor* imageProcessor = ImageProcessor::ImageProcessor::CImgProcessor::NewL(iFs, observer);
    CleanupStack::PushL(imageProcessor);
    
    // Initialize the Image Processor instance. By default the initialization is asynchronous.
    // (It might take some time to load Image Processor plugin and initialize it).
    imageProcessor-&gt;InitializeL();

    // Wait for asynchronous callback
    CActiveScheduler::Start();

    // Set input and output images
    imageProcessor-&gt;SetInputL(KInputFileName, KImageTypeJPGUid);
    imageProcessor-&gt;SetOutputL(KOutputFileName, KImageTypeJPGUid);
        
    // Get the TOutputInfo interface
    TOutputInfo* outputInfo = imageProcessor-&gt;OutputInfoL();

    // Set 0.75 quality for an output image.
    // (Note. Default quality value for an output image is the same as for the input image.)
    TReal32 quality = 0.75f;
    outputInfo-&gt;SetJpegQualityL(quality);

    // Process the input image to an output image. 
    // an output image size is QVGA and an output image keeps the same aspect ration as the input image.  
    imageProcessor-&gt;ProcessL(TSize(320, 240), ETrue);

    // Wait for asynchronous callback
    CActiveScheduler::Start();

    CleanupStack::PopAndDestroy(); //imageProcessor

</pre> </div> </div><h3>Related concepts</h3><ul><li><a href="GUID-F221B15F-B5DE-516F-8FB0-75C1971DB3AF.html">Adding Effects And Filters
                Guide</a></li><li><a href="GUID-03866ADB-5916-5B31-BCF0-44F94E12B740.html">Pluggable Advanced Image Editing
                Libraries</a></li></ul></div></div><div class="footer"><p class="metadata">Last updated October 9th, 2009</p><hr /><div class="copy">© Nokia 2012.</div></div></body>
<!-- Mirrored from devlib.symbian.slions.net/belle/GUID-26FD66B4-A291-5DAD-991D-40AB5316F30C.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 04:04:52 GMT -->
</html>