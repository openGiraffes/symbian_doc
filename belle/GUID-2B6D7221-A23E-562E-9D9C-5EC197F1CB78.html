
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<!-- Mirrored from devlib.symbian.slions.net/belle/GUID-2B6D7221-A23E-562E-9D9C-5EC197F1CB78.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 03:57:00 GMT -->
<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="copyright" content="(C) Copyright 2012" /><meta name="DC.rights.owner" content="(C) Copyright 2012" /><meta name="DC.Type" content="concept" /><meta name="DC.Title" content="Using String Pool" /><meta name="DC.Relation" scheme="URI" content="GUID-27340D18-A31D-512E-920A-B06C784A978A" /><meta name="DC.Relation" scheme="URI" content="GUID-24D509E8-CF46-58D3-85E9-27DA7AB22012" /><meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7" /><meta name="DC.Relation" scheme="URI" content="GUID-5072BE46-B1B4-5C3A-BF55-BEA7443E7657" /><meta name="DC.Relation" scheme="URI" content="GUID-324107D1-6E0B-56DD-BDC0-7296F688A9CF" /><meta name="DC.Relation" scheme="URI" content="GUID-D02B5AF1-B1C3-560D-9654-971A5CC1A904" /><meta name="DC.Relation" scheme="URI" content="GUID-C8BD333E-8384-534B-822B-F61B2F7C8B9F" /><meta name="DC.Relation" scheme="URI" content="GUID-85AA0FD4-3BD1-50A7-B241-AE3908ACCF30" /><meta name="DC.Format" content="XHTML" /><meta name="DC.Identifier" content="GUID-2B6D7221-A23E-562E-9D9C-5EC197F1CB78" /><meta name="DC.Language" content="en" /><title>Using String Pool </title><link href="css/s60/style.css" rel="stylesheet" type="text/css" /><link href="PLUGINS_ROOT/com.nokia.forum.library/css/category_cpp5.html" rel="stylesheet" type="text/css" /></head><body><div class="body"><div class="contentLeft prTxt"><h1 class="pageHeading" id="GUID-2B6D7221-A23E-562E-9D9C-5EC197F1CB78">Using String Pool</h1><div><p>You can perform any of the following tasks on a string pool: </p> <ul><li id="GUID-075FC6AA-FF50-53A5-958D-58887D1C72CF"><a name="GUID-075FC6AA-FF50-53A5-958D-58887D1C72CF"><!-- --></a><p><a href="#GUID-45792D4C-69C0-5E57-A678-870806C3233D">Adding tables to a string pool</a> </p> </li> <li id="GUID-C230C949-D94A-50F4-AFD6-C18752A20C11"><a name="GUID-C230C949-D94A-50F4-AFD6-C18752A20C11"><!-- --></a><p><a href="#GUID-B56DE379-D345-5A7A-9780-B29CA0D28C66">Accessing strings in a string pool</a> </p> </li> <li id="GUID-42328498-4535-54D8-BFBF-D7A744A9E1E6"><a name="GUID-42328498-4535-54D8-BFBF-D7A744A9E1E6"><!-- --></a><p><a href="#GUID-CDCAD75A-D210-5B04-B25C-DC8AD6136BDF">Retrieving a string from a string pool </a> </p> </li> <li id="GUID-94A9DFA5-71FE-5945-B95F-AE06FC7AE239"><a name="GUID-94A9DFA5-71FE-5945-B95F-AE06FC7AE239"><!-- --></a><p><a href="#GUID-0DB1030D-E073-5664-960A-A6FA33207D41">Comparing strings in a string pool</a> </p> </li> </ul> <div id="GUID-45792D4C-69C0-5E57-A678-870806C3233D"><h3 class="section-title">Adding tables to a string pool </h3> <ol id="GUID-E3C187AF-3693-5585-8AD3-716544DADFFC"><li id="GUID-140476B0-F437-5166-9193-1C3C8D7F8231"><a name="GUID-140476B0-F437-5166-9193-1C3C8D7F8231"><!-- --></a><p>Create a string pool with no static string tables. This is, in effect an empty string pool. Static string tables can be added later. Use the following variant of <code class="codeph">OpenL()</code>: </p> <pre class="codeblock">void RStringPool::OpenL()</pre> </li> <li id="GUID-601A7683-6E56-5666-B8B3-115F85234FE4"><a name="GUID-601A7683-6E56-5666-B8B3-115F85234FE4"><!-- --></a><p>Add a static string table to the pool by using the following variant of <code class="codeph">OpenL()</code>. </p> <pre class="codeblock">void RStringPool::OpenL( const TStringTable&amp; aTable )</pre> <p>This function creates the string pool, if it doesn't already exist, before adding the string table. Use the same function to add further string tables whenever required. </p> </li> </ol> <p>There is a variation on the <code class="codeph">OpenL()</code> function that provides a mechanism for notifying when the string pool is being closed. Following is the variant: </p> <pre class="codeblock">void OpenL(const TStringTable&amp; aTable, MStringPoolCloseCallBack&amp; aCallBack);</pre> <p>Closing the string pool is performed using the <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-4BF6ECD3-5FB3-3A6A-B9CE-98871BD0812B.html#GUID-A300515C-82B3-3CF1-92B2-363D7D4DC60B"><code class="apiname">RStringPool::Close()</code></a> function. It closes all open references to the string pool. This may be important in environments where asynchronous programming techniques is used. Provide an implementation of the <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-181D6F81-079E-39FD-A795-9274661C80D0.html#GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-181D6F81-079E-39FD-A795-9274661C80D0.html"><code class="apiname">MStringPoolCloseCallBack</code></a> to handle the situation. </p> <p> <strong>Note:</strong> The implementation assumes that the string tables remain in existence and are located at the same address for as long as the string pool remains open. This assumption is almost always justified as the tables are static data. </p> </div> <div id="GUID-B56DE379-D345-5A7A-9780-B29CA0D28C66"><h3 class="section-title">Accessing strings in a string pool</h3> <p>Accessing strings involves getting a handle to a string in the string pool. These handles are instances of <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-86301BC4-2A98-3F9B-BAE3-A6DE8D3BD632.html#GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-86301BC4-2A98-3F9B-BAE3-A6DE8D3BD632.html"><code class="apiname">RString</code></a> and <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-B886F0AA-DB9C-356C-9B96-33252820F93E.html#GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-B886F0AA-DB9C-356C-9B96-33252820F93E.html"><code class="apiname">RStringF</code></a> classes, which are used in the code to represent strings. </p> <p> <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-86301BC4-2A98-3F9B-BAE3-A6DE8D3BD632.html#GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-86301BC4-2A98-3F9B-BAE3-A6DE8D3BD632.html"><code class="apiname">RString</code></a> represents a case-sensitive string. For example, a string that is compared in a case-sensitive manner. </p> <p> <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-B886F0AA-DB9C-356C-9B96-33252820F93E.html#GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-B886F0AA-DB9C-356C-9B96-33252820F93E.html"><code class="apiname">RStringF</code></a> represents a case-insensitive string. For example, when you compare two <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-B886F0AA-DB9C-356C-9B96-33252820F93E.html#GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-B886F0AA-DB9C-356C-9B96-33252820F93E.html"><code class="apiname">RStringF</code></a> objects where the represented strings only differ in terms of case, the two strings are considered identical. </p> <p>Follow the steps given below to create an <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-86301BC4-2A98-3F9B-BAE3-A6DE8D3BD632.html#GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-86301BC4-2A98-3F9B-BAE3-A6DE8D3BD632.html"><code class="apiname">RString</code></a> to represent a specific string: </p> <p> <strong>Note</strong>: Creating an <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-B886F0AA-DB9C-356C-9B96-33252820F93E.html#GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-B886F0AA-DB9C-356C-9B96-33252820F93E.html"><code class="apiname">RStringF</code></a> object is same as creating an <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-86301BC4-2A98-3F9B-BAE3-A6DE8D3BD632.html#GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-86301BC4-2A98-3F9B-BAE3-A6DE8D3BD632.html"><code class="apiname">RString</code></a>. Where <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-86301BC4-2A98-3F9B-BAE3-A6DE8D3BD632.html#GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-86301BC4-2A98-3F9B-BAE3-A6DE8D3BD632.html"><code class="apiname">RString</code></a> is discussed, this information also applies to <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-B886F0AA-DB9C-356C-9B96-33252820F93E.html#GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-B886F0AA-DB9C-356C-9B96-33252820F93E.html"><code class="apiname">RStringF</code></a>: </p> <ol id="GUID-5D61F147-9CB7-5E0B-AEC3-5D3DDEE846E0"><li id="GUID-CB52068B-2D7E-564E-9E85-B1ECD3381D1E"><a name="GUID-CB52068B-2D7E-564E-9E85-B1ECD3381D1E"><!-- --></a><p>Create an <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-86301BC4-2A98-3F9B-BAE3-A6DE8D3BD632.html#GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-86301BC4-2A98-3F9B-BAE3-A6DE8D3BD632.html"><code class="apiname">RString</code></a> to represent a specific string in a static string table by using the variant, </p> <pre class="codeblock">RString RStringPool::String( TInt aIndex,const TStringTable&amp; aTable ) const;</pre> <p>pass the reference to the specific string table and the index number that identifies the string. Based on the example string table illustrated in <a href="GUID-27340D18-A31D-512E-920A-B06C784A978A.html#GUID-8221E235-15F9-55E9-8C17-4015051F70CD">Static String Tables</a> section, the following code is a commonly used pattern to generate an <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-86301BC4-2A98-3F9B-BAE3-A6DE8D3BD632.html#GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-86301BC4-2A98-3F9B-BAE3-A6DE8D3BD632.html"><code class="apiname">RString</code></a>. Here we generate an <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-86301BC4-2A98-3F9B-BAE3-A6DE8D3BD632.html#GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-86301BC4-2A98-3F9B-BAE3-A6DE8D3BD632.html"><code class="apiname">RString</code></a> to represent the string "banana". The code does no error handling and ignores leave situations. </p> <pre class="codeblock">#include &lt;&gt;

RStringPool thepool;
RString thebanana;
...
thepool.OpenL( ExampleStringTable::Table );
thebanana = thepool.String( ExampleStringTable::EBanana,ExampleStringTable::Table );
...</pre> <p>In more sophisticated code, and where there is more than one static string table, use a function or a member function of some class to retrieve that <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-91322CD6-6DA0-3868-A5D7-CA561A102074.html#GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-91322CD6-6DA0-3868-A5D7-CA561A102074.html"><code class="apiname">TStringTable</code></a> reference. The following is a common pattern: </p> <pre class="codeblock">void X::Foo( CSomeClass aInstance,... )
    {
    ...
    thebanana = thepool.String( ExampleStringTable::EBanana,aInstance.GetTable() );
    ...
    }</pre> <p>where <code class="codeph">GetTable()</code> is a function that returns a reference to a specific <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-91322CD6-6DA0-3868-A5D7-CA561A102074.html#GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-91322CD6-6DA0-3868-A5D7-CA561A102074.html"><code class="apiname">TStringTable</code></a>. </p> </li> <li id="GUID-79DB61DF-CFD8-573D-B8AE-2A93F41BB0A2"><a name="GUID-79DB61DF-CFD8-573D-B8AE-2A93F41BB0A2"><!-- --></a><p>Create an <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-86301BC4-2A98-3F9B-BAE3-A6DE8D3BD632.html#GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-86301BC4-2A98-3F9B-BAE3-A6DE8D3BD632.html"><code class="apiname">RString</code></a> to represent a string that may not exist in any existing static string table within the string pool. Use the following function: </p> <pre class="codeblock">RString  RStringPool::OpenStringL( const TDesC8&amp; aString ) const;</pre> <p>Following is an example of dynamically adding a string to the pool (which also generates the <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-86301BC4-2A98-3F9B-BAE3-A6DE8D3BD632.html#GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-86301BC4-2A98-3F9B-BAE3-A6DE8D3BD632.html"><code class="apiname">RString</code></a> to represent it). If the string already exists in a static string table, then the string value itself is not added; instead a new reference to the existing string is created. The following is a simple code fragment: </p> <pre class="codeblock">class X
    {
public :
    ...
    void Foo( const TDesC8&amp; aString,... );
    ...
    }</pre> <pre class="codeblock">void X::Foo( aString,... )
    {
    ...
    RString theString;
    theString = thepool.OpenStringL( aString );
    ...
    }</pre> </li> </ol> </div> <div id="GUID-CDCAD75A-D210-5B04-B25C-DC8AD6136BDF"><h3 class="section-title">Retrieving a string from a string pool </h3> <p>Given an <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-86301BC4-2A98-3F9B-BAE3-A6DE8D3BD632.html#GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-86301BC4-2A98-3F9B-BAE3-A6DE8D3BD632.html"><code class="apiname">RString</code></a> object (or an <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-B886F0AA-DB9C-356C-9B96-33252820F93E.html#GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-B886F0AA-DB9C-356C-9B96-33252820F93E.html"><code class="apiname">RStringF</code></a>), you can retrieve the string value itself. To retrieve the string value, use the <code class="codeph">DesC()</code> function that is provided by the <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-0829EF3D-5068-341C-946F-BFCEFD8F42AC.html#GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-0829EF3D-5068-341C-946F-BFCEFD8F42AC.html"><code class="apiname">RStringBase</code></a> base class of <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-86301BC4-2A98-3F9B-BAE3-A6DE8D3BD632.html#GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-86301BC4-2A98-3F9B-BAE3-A6DE8D3BD632.html"><code class="apiname">RString</code></a> and <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-B886F0AA-DB9C-356C-9B96-33252820F93E.html#GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-B886F0AA-DB9C-356C-9B96-33252820F93E.html"><code class="apiname">RStringF</code></a> classes. </p> <p>For example: </p> <pre class="codeblock">class X
    {
    public :
        ...
        void Foo( RString aString, ... );
        ...
    }</pre> <pre class="codeblock">void X::Foo( aString )
    {
    const TDesC8&amp; stringValue = aString.DesC();
    ...
    }</pre> </div> <div id="GUID-0DB1030D-E073-5664-960A-A6FA33207D41"><h3 class="section-title">Comparing strings in a string pool </h3> <p>Comparing strings becomes a fast and simple process once an <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-86301BC4-2A98-3F9B-BAE3-A6DE8D3BD632.html#GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-86301BC4-2A98-3F9B-BAE3-A6DE8D3BD632.html"><code class="apiname">RString</code></a> handle (or an <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-B886F0AA-DB9C-356C-9B96-33252820F93E.html#GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-B886F0AA-DB9C-356C-9B96-33252820F93E.html"><code class="apiname">RStringF</code></a>) has been created. A common use is to route processing based on the value of the string, for example: </p> <pre class="codeblock">class X
    {
    public :
        ...
        void Foo( RString aString,... );
        ...
    }</pre> <pre class="codeblock">void X::Foo( aString,... )
    {
    ...
    switch( aString )
        {
        case ExampleStringTable::EBanana :
            {
            // do something
            }
        case ExampleStringTable::EOrange :
            {
            // do something
            }
        ...
        }
    }</pre> </div> </div><h3>Related concepts</h3><ul><li><a href="GUID-27340D18-A31D-512E-920A-B06C784A978A.html">String Pools</a></li></ul><h3>Related tasks</h3><ul><li><a href="GUID-24D509E8-CF46-58D3-85E9-27DA7AB22012.html">Constructing a Static String
                Table</a></li></ul></div></div><div class="footer"><p class="metadata">Last updated October 9th, 2009</p><hr /><div class="copy">© Nokia 2012.</div></div></body>
<!-- Mirrored from devlib.symbian.slions.net/belle/GUID-2B6D7221-A23E-562E-9D9C-5EC197F1CB78.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 03:57:00 GMT -->
</html>