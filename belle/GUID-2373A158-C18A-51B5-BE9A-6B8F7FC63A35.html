
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<!-- Mirrored from devlib.symbian.slions.net/belle/GUID-2373A158-C18A-51B5-BE9A-6B8F7FC63A35.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 03:49:55 GMT -->
<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="copyright" content="(C) Copyright 2012" /><meta name="DC.rights.owner" content="(C) Copyright 2012" /><meta name="DC.Type" content="concept" /><meta name="DC.Title" content="Registering Services" /><meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7" /><meta name="DC.Relation" scheme="URI" content="GUID-227B6970-A536-470F-B5A1-A1871F65D7F3" /><meta name="DC.Relation" scheme="URI" content="GUID-071A1E59-FE77-5D4D-B4D1-E6ECDF68BB03" /><meta name="DC.Relation" scheme="URI" content="GUID-EC7A9299-4272-5C1E-8A10-8267E154D56A" /><meta name="DC.Relation" scheme="URI" content="GUID-756D831F-F302-594C-8116-144358DD8442" /><meta name="DC.Format" content="XHTML" /><meta name="DC.Identifier" content="GUID-2373A158-C18A-51B5-BE9A-6B8F7FC63A35" /><meta name="DC.Language" content="en" /><title>Registering Services </title><link href="css/s60/style.css" rel="stylesheet" type="text/css" /><link href="PLUGINS_ROOT/com.nokia.forum.library/css/category_cpp5.html" rel="stylesheet" type="text/css" /></head><body><div class="body"><div class="contentLeft prTxt"><h1 class="pageHeading" id="GUID-2373A158-C18A-51B5-BE9A-6B8F7FC63A35">Registering Services</h1><div><p>Services must be registered in the SDP database before they can be found by an SDP Agent query. </p> <div><h3 class="section-title">How to register a service in the database</h3> <p>After <a href="GUID-B75BD3DE-9C2E-5429-B55B-891462B92795.html">connecting to the SDP database</a>, a service record can be created. You do this by supplying the UUID for the service class of the record. As the service class may be a single UUID or a list of UUIDs in the form of a DES, there are two overloaded functions. </p> <p>The steps to register a service are as follows: </p> <ol id="GUID-AFA9213B-869F-5DDB-9572-181F4B058626"><li id="GUID-CD2C1B73-F3C0-5A9E-AA50-7E29B7D9C84E"><a name="GUID-CD2C1B73-F3C0-5A9E-AA50-7E29B7D9C84E"><!-- --></a><p>Create a blank service record object, TSdpServRecordHandle. </p> </li> <li id="GUID-60B2CB64-CAC7-5FF6-88B3-84D32A9C05F5"><a name="GUID-60B2CB64-CAC7-5FF6-88B3-84D32A9C05F5"><!-- --></a><p>If the service class attribute should be a single UUID, create and set a TUUID object. If the attribute should be a list of UUIDs, create a attribute list object, CSdpAttrValueDES or CSdpAttrValueDEA, and call <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-3DC9CB25-E55D-38E6-8940-B3320EF7E9DD.html#GUID-F073DB29-EF75-3D5D-A6D9-D7BC9ABFB4C3"><code class="apiname">MSdpElementBuilder::BuildUUIDL()</code></a> repeatedly to add UUIDs to the list. </p> </li> <li id="GUID-BD149ABF-42AD-5B2F-AF55-4FDF317B0D5A"><a name="GUID-BD149ABF-42AD-5B2F-AF55-4FDF317B0D5A"><!-- --></a><p>Call RSdpDatabase::CreateServiceRecordL() on an open subsession. On return, the record handle object holds a handle to the service record. </p> </li> </ol> </div> <div><h3 class="section-title">Registering a single service class</h3> <p>The following example creates a service record with a single service class. </p> <ol id="GUID-41928671-1E4F-56FD-99E1-3F8FCF2343AA"><li id="GUID-B6A06A7A-D068-5929-8E5C-315656738811"><a name="GUID-B6A06A7A-D068-5929-8E5C-315656738811"><!-- --></a><p>Create blank record handle </p> <pre class="codeblock">// Assumes sdpSession is an open session to the database
TSdpServRecordHandle recordHandle = 0;</pre> </li> <li id="GUID-E1AB9D3B-DDEB-50A0-A92A-B541FD6341C1"><a name="GUID-E1AB9D3B-DDEB-50A0-A92A-B541FD6341C1"><!-- --></a><p>Create the service class UUIDs </p> <pre class="codeblock">TUUID uuid(0x20000);</pre> </li> <li id="GUID-1E51A67C-5E03-5CE9-B7C0-F17C1C74CC50"><a name="GUID-1E51A67C-5E03-5CE9-B7C0-F17C1C74CC50"><!-- --></a><p>Enter record into the database </p> <pre class="codeblock">sdpSubSession.CreateServiceRecordL(uuid, recordHandle);</pre> </li> </ol> </div> <div><h3 class="section-title">Registering a service class list</h3> <p>The following example creates a service record with a list of service classes. </p> <ol id="GUID-C8474C59-C646-521E-AE94-DF156211002A"><li id="GUID-B435DA33-BC38-5659-9F18-05EE93E6B2C5"><a name="GUID-B435DA33-BC38-5659-9F18-05EE93E6B2C5"><!-- --></a><p>Create a blank record handle </p> <pre class="codeblock">TSdpServRecordHandle recordHandle = 0;</pre> </li> <li id="GUID-50FA6B1F-101C-523A-966B-FD818EB34BE4"><a name="GUID-50FA6B1F-101C-523A-966B-FD818EB34BE4"><!-- --></a><p>Create a list of service class UUIDs </p> <pre class="codeblock">CSdpAttrValueDES* UUIDlist = CSdpAttrValueDES::NewDESL(NULL);
CleanupStack::PushL(UUIDlist);
UUIDlist
    -&gt;StartListL()
        -&gt;BuildUUIDL(TUUID(TUint32(0x20002000)))
        -&gt;BuildUUIDL(TUUID(TUint32(0x11112222), TUint32(0x33334444), 
                              TUint32(0x55556666), TUint32(0x77778888)))
        -&gt;BuildUUIDL(TUUID(TUint32(0x40000)))
    -&gt;EndListL();
</pre> </li> <li id="GUID-3204B6B6-46AD-5C3E-A586-A1494B7C6D0B"><a name="GUID-3204B6B6-46AD-5C3E-A586-A1494B7C6D0B"><!-- --></a><p>Enter record into the database </p> <pre class="codeblock">sdpSubSession.CreateServiceRecordL(*UUIDlist, recordHandle);
CleanupStack::PopL(); // UUIDlist</pre> </li> </ol> <p><strong>Note </strong> </p> <p>The examples shows UUIDs of varying length. Both 16- and 32-bit integers may be used, which are assumed to be offsets from the Bluetooth base UUID. </p> </div> <div><h3 class="section-title">Where next?</h3> <p>The complete set of Service Discovery Database tutorials are shown below: </p> <ol id="GUID-1ADEBB09-347F-53DD-8CD0-355BA707D7BA"><li id="GUID-9B76001A-F7EE-5FC7-8F87-A9B5143AE36A"><a name="GUID-9B76001A-F7EE-5FC7-8F87-A9B5143AE36A"><!-- --></a><p> <a href="GUID-B75BD3DE-9C2E-5429-B55B-891462B92795.html">Connecting to the service discovery database</a> </p> </li> <li id="GUID-E5587A96-B45F-590F-BCA0-4AD46B293C5B"><a name="GUID-E5587A96-B45F-590F-BCA0-4AD46B293C5B"><!-- --></a><p> <a href="GUID-E2A2FA2A-5D9A-56FE-B7E5-69CCBC656BB9.html">Handling SDP attributes</a> </p> </li> <li id="GUID-82C85B76-5E78-507A-A61A-44B228528063"><a name="GUID-82C85B76-5E78-507A-A61A-44B228528063"><!-- --></a><p> <strong>Registering Services</strong> - This document </p> </li> <li id="GUID-DA18FDFD-CDAD-559C-8B7C-F075F9178F03"><a name="GUID-DA18FDFD-CDAD-559C-8B7C-F075F9178F03"><!-- --></a><p> <a href="GUID-33210C48-3198-51BC-9970-8B29F711A8E2.html">Setting service record attributes</a> </p> </li> <li id="GUID-196905A6-7D11-535D-87C0-F75C5F686F0A"><a name="GUID-196905A6-7D11-535D-87C0-F75C5F686F0A"><!-- --></a><p> <a href="GUID-ED342E6B-A4A3-576B-8934-7E7C049837F0.html">SDP Service records and attributes</a> </p> </li> </ol> <p>Also refer to the <a href="GUID-E5893C4A-024A-53A7-805F-68989382DC3F.html">Bluetooth Service Discovery Database overview</a> and the <a href="GUID-8451102A-8E68-5C86-9E40-D53183E32261.html">Bluetooth SDP Overview</a> for additional background information. </p> </div> </div></div></div><div class="footer"><p class="metadata">Last updated October 9th, 2009</p><hr /><div class="copy">Â© Nokia 2012.</div></div></body>
<!-- Mirrored from devlib.symbian.slions.net/belle/GUID-2373A158-C18A-51B5-BE9A-6B8F7FC63A35.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 03:49:55 GMT -->
</html>