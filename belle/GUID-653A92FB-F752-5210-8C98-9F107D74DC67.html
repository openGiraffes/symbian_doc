
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<!-- Mirrored from devlib.symbian.slions.net/belle/GUID-653A92FB-F752-5210-8C98-9F107D74DC67.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 04:03:10 GMT -->
<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="copyright" content="(C) Copyright 2012" /><meta name="DC.rights.owner" content="(C) Copyright 2012" /><meta name="DC.Type" content="concept" /><meta name="DC.Title" content="Forwarding or Replying to Email Messages Stored as Rich Text" /><meta name="abstract" content="This tutorial explains how to forward email messages that are stored as rich text." /><meta name="description" content="This tutorial explains how to forward email messages that are stored as rich text." /><meta name="DC.Relation" scheme="URI" content="GUID-2C8653F9-8873-59E8-9FD2-4215F6877ABC" /><meta name="DC.Relation" scheme="URI" content="GUID-BB35DBCC-FE56-547F-BADA-9EF854691ADC" /><meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7" /><meta name="DC.Relation" scheme="URI" content="GUID-5DD1010C-1648-5086-BA80-BC25F3C7A2C4" /><meta name="DC.Relation" scheme="URI" content="GUID-C290FA5E-8E41-5D19-B8C1-F88491EE6388" /><meta name="DC.Relation" scheme="URI" content="GUID-B394A824-8745-505E-8429-8B9B6D418387" /><meta name="DC.Relation" scheme="URI" content="GUID-DD27A452-8B0F-5C6D-A2E6-FC21145468B6" /><meta name="DC.Relation" scheme="URI" content="GUID-179099DA-1CD9-5912-B41B-363C132C7A86" /><meta name="DC.Relation" scheme="URI" content="GUID-9A3E0279-4F87-594D-A987-66DC77F408A0" /><meta name="DC.Format" content="XHTML" /><meta name="DC.Identifier" content="GUID-653A92FB-F752-5210-8C98-9F107D74DC67" /><meta name="DC.Language" content="en" /><title>Forwarding or Replying to Email Messages Stored as Rich Text </title><link href="css/s60/style.css" rel="stylesheet" type="text/css" /><link href="PLUGINS_ROOT/com.nokia.forum.library/css/category_cpp5.html" rel="stylesheet" type="text/css" /></head><body><div class="body"><div class="contentLeft prTxt"><h1 class="pageHeading" id="GUID-653A92FB-F752-5210-8C98-9F107D74DC67">Forwarding or Replying to Email Messages Stored as Rich Text</h1><div><p>This tutorial explains how to forward email messages that
are stored as rich text. </p>
<div id="GUID-2B3E284B-83F4-4BB6-BCFC-B0FBA97D2366"><h3 class="section-title">Procedure</h3> <ol id="GUID-4F6BB3EC-586E-5EAE-97DA-A4CF0E5017C8">
<li id="GUID-CB2BFF6E-193F-55F9-9559-B61FDFEE15E1"><a name="GUID-CB2BFF6E-193F-55F9-9559-B61FDFEE15E1"><!-- --></a><p>Use the<a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-3F7DC1AB-D13C-31E9-967B-526AD72CD498.html#GUID-5C13FD54-1C93-353C-9BDB-2A30A14BD159"><code class="apiname"> CImEmailOperation::CreateForwardL()</code></a> function or the CreateReplyL() function to forward or reply to an email. </p> <p>The newly created email will be stored in the same format as
the original email. In this case, it is rich text format and the formatting
information is preserved while forwarding or replying to the email. </p> </li>
<li id="GUID-38843C43-005E-5B42-9AAC-E098573C19AF"><a name="GUID-38843C43-005E-5B42-9AAC-E098573C19AF"><!-- --></a><p>Use the <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-3F7DC1AB-D13C-31E9-967B-526AD72CD498.html#GUID-38E7EABD-1300-3DF2-B9DF-B65EEABD8A31"><code class="apiname">CImEmailOperation::ProgressL()</code></a> function to obtain the TMsvId parameter of the newly created email. This is returned
through a <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-36B29964-420D-38D0-AF08-4DA70BED8B6E.html#GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-36B29964-420D-38D0-AF08-4DA70BED8B6E.html"><code class="apiname">TPckgC</code></a> &lt;TMsvId &gt;
descriptor. </p> </li>
<li id="GUID-86C3A5DB-6F5D-5E5C-9701-A74547EBAA97"><a name="GUID-86C3A5DB-6F5D-5E5C-9701-A74547EBAA97"><!-- --></a><p>Use the TMsvId <code class="codeph">aMessageId</code> parameter to create
a <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-85BBE389-81F7-3E2F-A789-446D9BE2CC49.html#GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-85BBE389-81F7-3E2F-A789-446D9BE2CC49.html"><code class="apiname">CMsvEntry</code></a> object. </p> </li>
<li id="GUID-E3378D43-F39E-5C6C-96F6-9086713D0C84"><a name="GUID-E3378D43-F39E-5C6C-96F6-9086713D0C84"><!-- --></a><p>Use the <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-85BBE389-81F7-3E2F-A789-446D9BE2CC49.html#GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-85BBE389-81F7-3E2F-A789-446D9BE2CC49.html"><code class="apiname">CMsvEntry</code></a> object to create a <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html"><code class="apiname">CImEmailMessage</code></a> object. </p> </li>
<li id="GUID-EE96F019-D147-5FD9-974B-A5C34ABD2A1D"><a name="GUID-EE96F019-D147-5FD9-974B-A5C34ABD2A1D"><!-- --></a><p>Use the <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-57CA3F50-33EA-359B-AABB-4E4E15AF2A18"><code class="apiname"> CImEmailMessage::GetBodyTextL()</code></a> function to get the body
text of the message that is being replied to or forwarded. This will
return a CRichText class. </p> </li>
<li id="GUID-E3B9F2CC-512E-56DB-BC9C-825426C6FF45"><a name="GUID-E3B9F2CC-512E-56DB-BC9C-825426C6FF45"><!-- --></a><p>If you want
to use the rich text format, complete the following step 1. If you
want to store the body text in plain text format, complete the following
steps from 2  to 4. </p> <ol type="a" id="GUID-CABBF3DD-DFB5-56EB-862A-E6A4CEC1C6C6">
<li id="GUID-57FC7507-A8D8-58B7-8282-3F349A69D0BD"><a name="GUID-57FC7507-A8D8-58B7-8282-3F349A69D0BD"><!-- --></a><p>Edit the CRichText class and call the <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-791117B4-C946-3D43-AE1E-68DDC10F85A3"><code class="apiname">CImEmailMessage::StoreBodyTextL()</code></a> function to store the edited body text. </p> </li>
<li id="GUID-531982EB-3274-5891-BCB3-27D89EA075F1"><a name="GUID-531982EB-3274-5891-BCB3-27D89EA075F1"><!-- --></a><p>Call the <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-B99E759E-E0D6-3A10-B81C-5BFCAF631B7D"><code class="apiname">CImEmailMessage::OpenPlainBodyTextForWriteL()</code></a> function
to get CImPlainBody Text. </p> </li>
<li id="GUID-0CD62596-7491-541F-95EE-754904620B47"><a name="GUID-0CD62596-7491-541F-95EE-754904620B47"><!-- --></a><p>Call the <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-14EA98A8-06E7-33FF-B2B1-4BC3D044518D.html#GUID-DFD5B13A-3CE5-35D9-B8F3-31D3DFA0DB41"><code class="apiname">CImPlainBodyText::StoreRichTextAsPlainTexL()</code></a> function and
pass the edited CRichText class to store the message. </p> </li>
<li id="GUID-6BE40DD9-4D5F-527E-A7DB-2D5E1BEBB718"><a name="GUID-6BE40DD9-4D5F-527E-A7DB-2D5E1BEBB718"><!-- --></a><p>Call the <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-14EA98A8-06E7-33FF-B2B1-4BC3D044518D.html#GUID-022C7A37-91EF-3363-A760-865A1F980917"><code class="apiname">CImPlainBodyText::CommitL()</code></a> function to complete the operation. </p> </li>
</ol> </li>
</ol> </div>
</div><h3>Related concepts</h3><ul><li><a href="GUID-2C8653F9-8873-59E8-9FD2-4215F6877ABC.html">Chunk
Method to Process Emails</a></li><li><a href="GUID-BB35DBCC-FE56-547F-BADA-9EF854691ADC.html">Pop3Example: An Email manager using POP3 and SMTP</a></li></ul></div></div><div class="footer"><p class="metadata">Last updated January 27th, 2012</p><hr /><div class="copy">Â© Nokia 2012.</div></div></body>
<!-- Mirrored from devlib.symbian.slions.net/belle/GUID-653A92FB-F752-5210-8C98-9F107D74DC67.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 04:03:10 GMT -->
</html>