<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en-us" xml:lang="en-us">

<!-- Mirrored from devlib.symbian.slions.net/belle/GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-A415607E-06D1-38CC-891E-5257B57C1367.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 04:19:25 GMT -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="copyright" content="(C) Copyright 2005" />
<meta name="DC.rights.owner" content="(C) Copyright 2005" />
<meta name="DC.Type" content="cxxStruct" />
<meta name="DC.Title" content="_GTypeValueTable" />
<meta name="abstract" content="" />
<meta name="description" content="" />
<meta name="DC.Format" content="XHTML" />
<meta name="DC.Identifier" content="GUID-A415607E-06D1-38CC-891E-5257B57C1367" />
<title>_GTypeValueTable</title>
<meta name="keywords" content="api" /><link rel="stylesheet" type="text/css" href="css/nokiacxxref.css" />
<link href="css/s60/style.css" rel="stylesheet" type="text/css" />
<link href="PLUGINS_ROOT/com.nokia.forum.library/css/category_cpp3.html" rel="stylesheet" type="text/css" />
<link href="PLUGINS_ROOT/com.nokia.forum.library/css/category-cover_cpp3.html" rel="stylesheet" type="text/css" /></head>
<body id="GUID-A415607E-06D1-38CC-891E-5257B57C1367"><a name="GUID-A415607E-06D1-38CC-891E-5257B57C1367"><!-- --></a><div class="body"><div class="contentLeft prTxt">
<h1 class="sectiontitle">_GTypeValueTable Struct Reference</h1>
<div class="state state apiQualifier apiQualifier cxxStructDeclarationFile section include"><p>#include 
            
                    &lt;stdapis/glib-2.0/gobject/gtype.h&gt;
                </p></div>
<div class="section signature"><table class="signature"><tr><td>struct _GTypeValueTable</td></tr></table></div><div class="section member-index"><table class="member-index"><thead><tr><th colspan="2">Public Attributes</th></tr></thead><tbody><tr><td align="right" valign="top" class="code">
<a class="xref xref apiRelation" href="GUID-A1774D19-C7DD-3397-9D4F-0095BFAE07E2.html">gchar</a> *</td><td><a href="#GUID-BA94F1C5-6775-358E-8BCB-BE17B56A96E6">collect_format</a></td></tr><tr class="bg"><td align="right" valign="top" class="code">
<a class="xref xref apiRelation" href="GUID-A1774D19-C7DD-3397-9D4F-0095BFAE07E2.html">gchar</a> *(*</td><td><a href="#GUID-3C4EB878-DCD2-3443-8745-100F202C3021">collect_value</a></td></tr><tr><td align="right" valign="top" class="code">
<a class="xref xref apiRelation" href="GUID-A1774D19-C7DD-3397-9D4F-0095BFAE07E2.html">gchar</a> *</td><td><a href="#GUID-F42A0AB1-5F0F-34DA-ACD3-6060C75A34F3">lcopy_format</a></td></tr><tr class="bg"><td align="right" valign="top" class="code">
<a class="xref xref apiRelation" href="GUID-A1774D19-C7DD-3397-9D4F-0095BFAE07E2.html">gchar</a> *(*</td><td><a href="#GUID-57DA87EE-9195-3CB0-9140-5AE8DE43B4A3">lcopy_value</a></td></tr><tr><td align="right" valign="top" class="code">void(*</td><td><a href="#GUID-18830BA3-0C12-305A-B6D9-9CF0D641620A">value_copy</a></td></tr><tr class="bg"><td align="right" valign="top" class="code">void(*</td><td><a href="#GUID-9C72AB38-F378-3F69-95A4-1BFF9AAF96F2">value_free</a></td></tr><tr><td align="right" valign="top" class="code">void(*</td><td><a href="#GUID-0FC007F1-8D87-323E-B768-840129F30207">value_init</a></td></tr><tr class="bg"><td align="right" valign="top" class="code">
<a class="xref xref apiRelation" href="GUID-A1774D19-C7DD-3397-9D4F-0095BFAE07E2.html">gpointer</a>(*</td><td><a href="#GUID-14A9B1DC-5066-3606-9526-CE6DC372AC88">value_peek_pointer</a></td></tr></tbody></table></div><div class="section section apiDesc section apidesc"><h2 class="sectiontitle">Detailed Description</h2>
<p class="p">GTypeValueTable: : Default initialize  contents by poking values directly into the value-&gt;data array. The data array of the <a class="xref" href="GUID-725C2EED-646E-3B03-9CBC-AC49185F9E91.html#GUID-3750FC48-F9A7-3CB1-9B26-074D0E6294CD">GValue</a> passed into this function was zero-filled with &lt;function&gt;<a class="xref" href="GUID-9AE779D6-6A00-3C0B-88C2-9663241DFB4A.html#GUID-65505089-DD7C-3367-A4AF-C7BD1E235F2E">memset()</a>&lt;/function&gt;, so no care has to be taken to free any old contents. E.g. for the implementation of a string value that may never be NULL, the implementation might look like: |[ value-&gt;data[0].v_pointer = g_strdup (""); ]| : Free any old contents that might be left in the data array of the passed in . No resources may remain allocated through the <a class="xref" href="GUID-725C2EED-646E-3B03-9CBC-AC49185F9E91.html#GUID-3750FC48-F9A7-3CB1-9B26-074D0E6294CD">GValue</a> contents after this function returns. E.g. for our above string type: |[ // only free strings without a specific flag for static storage if (!(value-&gt;data[1].v_uint &amp; G_VALUE_NOCOPY_CONTENTS)) g_free (value-&gt;data[0].v_pointer); ]| :  is a <a class="xref" href="GUID-725C2EED-646E-3B03-9CBC-AC49185F9E91.html#GUID-3750FC48-F9A7-3CB1-9B26-074D0E6294CD">GValue</a> with zero-filled data section and  is a properly setup <a class="xref" href="GUID-725C2EED-646E-3B03-9CBC-AC49185F9E91.html#GUID-3750FC48-F9A7-3CB1-9B26-074D0E6294CD">GValue</a> of same or derived type. The purpose of this function is to copy the contents of  into  in a way, that even after  has been freed, the contents of  remain valid. String type example: |[ dest_value-&gt;data[0].v_pointer = g_strdup (src_value-&gt;data[0].v_pointer); ]| : If the value contents fit into a pointer, such as objects or strings, return this pointer, so the caller can peek at the current contents. To extend on our above string example: |[ return value-&gt;data[0].v_pointer; ]| : A string format describing how to collect the contents of this value bit-by-bit. Each character in the format represents an argument to be collected, and the characters themselves indicate the type of the argument. Currently supported arguments are: &lt;variablelist&gt; &lt;varlistentry&gt;&lt;listitem&gt;</p>
<p class="p">'i' - Integers. passed as collect_values[].v_int. </p>
<p class="p">&lt;/listitem&gt;&lt;/varlistentry&gt; &lt;varlistentry&gt;&lt;listitem&gt;</p>
<p class="p">'l' - Longs. passed as collect_values[].v_long. </p>
<p class="p">&lt;/listitem&gt;&lt;/varlistentry&gt; &lt;varlistentry&gt;&lt;listitem&gt;</p>
<p class="p">'d' - Doubles. passed as collect_values[].v_double. </p>
<p class="p">&lt;/listitem&gt;&lt;/varlistentry&gt; &lt;varlistentry&gt;&lt;listitem&gt;</p>
<p class="p">'p' - Pointers. passed as collect_values[].v_pointer. </p>
<p class="p">&lt;/listitem&gt;&lt;/varlistentry&gt; &lt;/variablelist&gt; It should be noted that for variable argument list construction, ANSI C promotes every type smaller than an integer to an int, and floats to doubles. So for collection of short int or char, 'i' needs to be used, and for collection of floats 'd'. : The <a class="xref" href="GUID-A415607E-06D1-38CC-891E-5257B57C1367.html#GUID-3C4EB878-DCD2-3443-8745-100F202C3021">collect_value()</a> function is responsible for converting the values collected from a variable argument list into contents suitable for storage in a GValue. This function should setup  similar to <a class="xref" href="GUID-A415607E-06D1-38CC-891E-5257B57C1367.html#GUID-0FC007F1-8D87-323E-B768-840129F30207">value_init()</a>; e.g. for a string value that does not allow NULL pointers, it needs to either spew an error, or do an implicit conversion by storing an empty string. The  passed in to this function has a zero-filled data array, so just like for <a class="xref" href="GUID-A415607E-06D1-38CC-891E-5257B57C1367.html#GUID-0FC007F1-8D87-323E-B768-840129F30207">value_init()</a> it is guaranteed to not contain any old contents that might need freeing.  is exactly the string length of , and  is an array of unions <a class="xref" href="GUID-725C2EED-646E-3B03-9CBC-AC49185F9E91.html#GUID-476EE288-16E5-31AD-B9E1-31A5DC4FB9E0">GTypeCValue</a> with length , containing the collected values according to .  is an argument provided as a hint by the caller. It may contain the flag G_VALUE_NOCOPY_CONTENTS indicating, that the collected value contents may be considered "static" for the duration of the  lifetime. Thus an extra copy of the contents stored in  is not required for assignment to . For our above string example, we continue with: |[ if (!collect_values[0].v_pointer) value-&gt;data[0].v_pointer = g_strdup (""); else if (collect_flags &amp; G_VALUE_NOCOPY_CONTENTS) { value-&gt;data[0].v_pointer = collect_values[0].v_pointer; // keep a flag for the <a class="xref" href="GUID-A415607E-06D1-38CC-891E-5257B57C1367.html#GUID-9C72AB38-F378-3F69-95A4-1BFF9AAF96F2">value_free()</a> implementation to not free this string value-&gt;data[1].v_uint = G_VALUE_NOCOPY_CONTENTS; } else value-&gt;data[0].v_pointer = g_strdup (collect_values[0].v_pointer); return NULL; ]| It should be noted, that it is generally a bad idea to follow the <a class="xref" href="GUID-C028B419-3D95-3797-BCCD-8A048F130985.html#GUID-5E7B6F0D-5E84-3D6D-9B78-99A8084692CF">G_VALUE_NOCOPY_CONTENTS</a> hint for reference counted types. Due to reentrancy requirements and reference count assertions performed by the #GSignal code, reference counts should always be incremented for reference counted contents stored in the value-&gt;data array. To deviate from our string example for a moment, and taking a look at an exemplary implementation for <a class="xref" href="GUID-A415607E-06D1-38CC-891E-5257B57C1367.html#GUID-3C4EB878-DCD2-3443-8745-100F202C3021">collect_value()</a> of <a class="xref" href="GUID-2B42288F-5B59-3D42-A0EC-1236BD434F12.html#GUID-58FD7310-308C-31DA-8A71-031EB99F041F">GObject</a>: |[ if (collect_values[0].v_pointer) { GObject *object = G_OBJECT (collect_values[0].v_pointer); // never honour G_VALUE_NOCOPY_CONTENTS for ref-counted types value-&gt;data[0].v_pointer = g_object_ref (object); return NULL; } else return g_strdup_printf ("Object passed as invalid NULL pointer"); } ]| The reference count for valid objects is always incremented, regardless of . For invalid objects, the example returns a newly allocated string without altering . Upon success, <a class="xref" href="GUID-A415607E-06D1-38CC-891E-5257B57C1367.html#GUID-3C4EB878-DCD2-3443-8745-100F202C3021">collect_value()</a> needs to return NULL. If, however, an error condition occurred, <a class="xref" href="GUID-A415607E-06D1-38CC-891E-5257B57C1367.html#GUID-3C4EB878-DCD2-3443-8745-100F202C3021">collect_value()</a> may spew an error by returning a newly allocated non-NULL string, giving a suitable description of the error condition. The calling code makes no assumptions about the  contents being valid upon error returns,  is simply thrown away without further freeing. As such, it is a good idea to not allocate <a class="xref" href="GUID-725C2EED-646E-3B03-9CBC-AC49185F9E91.html#GUID-3750FC48-F9A7-3CB1-9B26-074D0E6294CD">GValue</a> contents, prior to returning an error, however, collect_values() is not obliged to return a correctly setup  for error returns, simply because any non-NULL return is considered a fatal condition so further program behaviour is undefined. : Format description of the arguments to collect for , analogous to . Usually,  string consists only of 'p's to provide <a class="xref" href="GUID-A415607E-06D1-38CC-891E-5257B57C1367.html#GUID-57DA87EE-9195-3CB0-9140-5AE8DE43B4A3">lcopy_value()</a> with pointers to storage locations. : This function is responsible for storing the  contents into arguments passed through a variable argument list which got collected into  according to .  equals the string length of , and  may contain G_VALUE_NOCOPY_CONTENTS. In contrast to <a class="xref" href="GUID-A415607E-06D1-38CC-891E-5257B57C1367.html#GUID-3C4EB878-DCD2-3443-8745-100F202C3021">collect_value()</a>, <a class="xref" href="GUID-A415607E-06D1-38CC-891E-5257B57C1367.html#GUID-57DA87EE-9195-3CB0-9140-5AE8DE43B4A3">lcopy_value()</a> is obliged to always properly support G_VALUE_NOCOPY_CONTENTS. Similar to <a class="xref" href="GUID-A415607E-06D1-38CC-891E-5257B57C1367.html#GUID-3C4EB878-DCD2-3443-8745-100F202C3021">collect_value()</a> the function may prematurely abort by returning a newly allocated string describing an error condition. To complete the string example: |[ gchar **string_p = collect_values[0].v_pointer; if (!string_p) return g_strdup_printf ("string location passed as NULL"); if (collect_flags &amp; G_VALUE_NOCOPY_CONTENTS) *string_p = value-&gt;data[0].v_pointer; else *string_p = g_strdup (value-&gt;data[0].v_pointer); ]| And an illustrative version of <a class="xref" href="GUID-A415607E-06D1-38CC-891E-5257B57C1367.html#GUID-57DA87EE-9195-3CB0-9140-5AE8DE43B4A3">lcopy_value()</a> for reference-counted types: |[ GObject **object_p = collect_values[0].v_pointer; if (!object_p) return g_strdup_printf ("object location passed as NULL"); if (!value-&gt;data[0].v_pointer) *object_p = NULL; else if (collect_flags &amp; G_VALUE_NOCOPY_CONTENTS) // always honour *object_p = value-&gt;data[0].v_pointer; else *object_p = g_object_ref (value-&gt;data[0].v_pointer); return NULL; ]|</p>
<p class="p">The <a class="xref" href="GUID-725C2EED-646E-3B03-9CBC-AC49185F9E91.html#GUID-76A93FD0-A523-3DEA-8E1F-C6F997822E50">GTypeValueTable</a> provides the functions required by the <a class="xref" href="GUID-725C2EED-646E-3B03-9CBC-AC49185F9E91.html#GUID-3750FC48-F9A7-3CB1-9B26-074D0E6294CD">GValue</a> implementation, to serve as a container for values of a type. </p>
</div>
<h2 class="sectiontitle">Member Attribute Documentation</h2><div class="topic reference apiRef apiValue cxxVariable nested1" id="GUID-BA94F1C5-6775-358E-8BCB-BE17B56A96E6"><a name="GUID-BA94F1C5-6775-358E-8BCB-BE17B56A96E6"><!-- --></a>
<h3 class="sectiontitle">collect_format</h3>
<div class="section signature"><table class="signature"><tr><td>
<a class="xref xref apiRelation" href="GUID-A1774D19-C7DD-3397-9D4F-0095BFAE07E2.html">gchar</a> *</td><td>collect_format</td></tr></table></div><div class="section section apiDesc section apidesc">
</div>
<div class="topic reference apiRef apiValue cxxVariable nested1" id="GUID-3C4EB878-DCD2-3443-8745-100F202C3021"><a name="GUID-3C4EB878-DCD2-3443-8745-100F202C3021"><!-- --></a>
<h3 class="sectiontitle">collect_value</h3>
<div class="section signature"><table class="signature"><tr><td>
<a class="xref xref apiRelation" href="GUID-A1774D19-C7DD-3397-9D4F-0095BFAE07E2.html">gchar</a> *(*</td><td>collect_value</td></tr></table></div><div class="section section apiDesc section apidesc">
</div>
<div class="topic reference apiRef apiValue cxxVariable nested1" id="GUID-F42A0AB1-5F0F-34DA-ACD3-6060C75A34F3"><a name="GUID-F42A0AB1-5F0F-34DA-ACD3-6060C75A34F3"><!-- --></a>
<h3 class="sectiontitle">lcopy_format</h3>
<div class="section signature"><table class="signature"><tr><td>
<a class="xref xref apiRelation" href="GUID-A1774D19-C7DD-3397-9D4F-0095BFAE07E2.html">gchar</a> *</td><td>lcopy_format</td></tr></table></div><div class="section section apiDesc section apidesc">
</div>
<div class="topic reference apiRef apiValue cxxVariable nested1" id="GUID-57DA87EE-9195-3CB0-9140-5AE8DE43B4A3"><a name="GUID-57DA87EE-9195-3CB0-9140-5AE8DE43B4A3"><!-- --></a>
<h3 class="sectiontitle">lcopy_value</h3>
<div class="section signature"><table class="signature"><tr><td>
<a class="xref xref apiRelation" href="GUID-A1774D19-C7DD-3397-9D4F-0095BFAE07E2.html">gchar</a> *(*</td><td>lcopy_value</td></tr></table></div><div class="section section apiDesc section apidesc">
</div>
<div class="topic reference apiRef apiValue cxxVariable nested1" id="GUID-18830BA3-0C12-305A-B6D9-9CF0D641620A"><a name="GUID-18830BA3-0C12-305A-B6D9-9CF0D641620A"><!-- --></a>
<h3 class="sectiontitle">value_copy</h3>
<div class="section signature"><table class="signature"><tr><td>void(*</td><td>value_copy</td></tr></table></div><div class="section section apiDesc section apidesc">
</div>
<div class="topic reference apiRef apiValue cxxVariable nested1" id="GUID-9C72AB38-F378-3F69-95A4-1BFF9AAF96F2"><a name="GUID-9C72AB38-F378-3F69-95A4-1BFF9AAF96F2"><!-- --></a>
<h3 class="sectiontitle">value_free</h3>
<div class="section signature"><table class="signature"><tr><td>void(*</td><td>value_free</td></tr></table></div><div class="section section apiDesc section apidesc">
</div>
<div class="topic reference apiRef apiValue cxxVariable nested1" id="GUID-0FC007F1-8D87-323E-B768-840129F30207"><a name="GUID-0FC007F1-8D87-323E-B768-840129F30207"><!-- --></a>
<h3 class="sectiontitle">value_init</h3>
<div class="section signature"><table class="signature"><tr><td>void(*</td><td>value_init</td></tr></table></div><div class="section section apiDesc section apidesc">
</div>
<div class="topic reference apiRef apiValue cxxVariable nested1" id="GUID-14A9B1DC-5066-3606-9526-CE6DC372AC88"><a name="GUID-14A9B1DC-5066-3606-9526-CE6DC372AC88"><!-- --></a>
<h3 class="sectiontitle">value_peek_pointer</h3>
<div class="section signature"><table class="signature"><tr><td>
<a class="xref xref apiRelation" href="GUID-A1774D19-C7DD-3397-9D4F-0095BFAE07E2.html">gpointer</a>(*</td><td>value_peek_pointer</td></tr></table></div><div class="section section apiDesc section apidesc">
</div>
</div></div><div class="footer"><hr /><div class="copy">© Nokia 2005.</div></div>
</div></div></div></div></div></div></div></div></body>
<!-- Mirrored from devlib.symbian.slions.net/belle/GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-A415607E-06D1-38CC-891E-5257B57C1367.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 04:19:25 GMT -->
</html>