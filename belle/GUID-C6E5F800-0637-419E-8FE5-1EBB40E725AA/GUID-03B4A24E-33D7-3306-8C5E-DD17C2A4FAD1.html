<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en-us" xml:lang="en-us">

<!-- Mirrored from devlib.symbian.slions.net/belle/GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-03B4A24E-33D7-3306-8C5E-DD17C2A4FAD1.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 04:22:42 GMT -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="copyright" content="(C) Copyright 2005" />
<meta name="DC.rights.owner" content="(C) Copyright 2005" />
<meta name="DC.Type" content="cxxClass" />
<meta name="DC.Title" content="RReadWriteLock" />
<meta name="abstract" content="" />
<meta name="description" content="" />
<meta name="DC.Format" content="XHTML" />
<meta name="DC.Identifier" content="GUID-03B4A24E-33D7-3306-8C5E-DD17C2A4FAD1" />
<title>RReadWriteLock</title>
<meta name="keywords" content="api" /><link rel="stylesheet" type="text/css" href="css/nokiacxxref.css" />
<link href="css/s60/style.css" rel="stylesheet" type="text/css" />
<link href="PLUGINS_ROOT/com.nokia.forum.library/css/category_cpp3.html" rel="stylesheet" type="text/css" />
<link href="PLUGINS_ROOT/com.nokia.forum.library/css/category-cover_cpp3.html" rel="stylesheet" type="text/css" /></head>
<body id="GUID-03B4A24E-33D7-3306-8C5E-DD17C2A4FAD1"><a name="GUID-03B4A24E-33D7-3306-8C5E-DD17C2A4FAD1"><!-- --></a><div class="body"><div class="contentLeft prTxt">
<h1 class="sectiontitle">RReadWriteLock Class Reference</h1>
<div class="state state apiQualifier apiQualifier cxxClassDeclarationFile section include"><p>#include 
            
                    &lt;e32cmn.h&gt;
                </p></div>
<div class="section signature"><table class="signature"><tr><td>class RReadWriteLock</td></tr></table></div><div class="section member-index"><table class="member-index"><thead><tr><th colspan="2">Public Member Enumerations</th></tr></thead><tbody><tr><td align="right" valign="top" class="code">enum</td><td><a href="#GUID-F50B41AA-8444-3BF6-9B27-C20E217082FB">TReadWriteLockClientCategoryLimit</a> { <a href="#GUID-EB95F4B1-031C-3112-89C9-E9B5B10D91D9">EReadWriteLockClientCategoryLimit</a> }</td></tr><tr class="bg"><td align="right" valign="top" class="code">enum</td><td><a href="#GUID-2EC76BE9-76D3-346F-BB31-351A6D781030">TReadWriteLockPriority</a> { <a href="#GUID-60E12C11-14A4-30A5-BFA0-974090DAEDFC">EWriterPriority</a>, <a href="#GUID-CCFD62AA-945E-3070-B6E9-6C338812040E">EAlternatePriority</a>, <a href="#GUID-2ADEF659-EBA0-37C9-A3B5-D52AE4645AE8">EReaderPriority</a> }</td></tr></tbody></table><table class="member-index"><thead><tr><th colspan="2">Public Member Functions</th></tr></thead><tbody><tr><td align="right" class="code"></td><td><a href="#GUID-EF86DCFD-90AC-393B-9181-A076D8F2F07C">RReadWriteLock</a>()</td></tr><tr class="bg"><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-A8F10301-09E1-39BA-97C2-3417AD516297">Close</a>()</td></tr><tr><td align="right" class="code">IMPORT_C <a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a></td><td><a href="#GUID-7E4589D5-5897-35E9-A751-CA3E4DFDEBF2">CreateLocal</a>(<a class="xref xref apiRelation" href="GUID-03B4A24E-33D7-3306-8C5E-DD17C2A4FAD1.html">TReadWriteLockPriority</a>)</td></tr><tr class="bg"><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-F8E708CE-0F46-31F6-B284-63E4382DFCF7">DowngradeWriteLock</a>()</td></tr><tr><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-A8E28743-194E-3750-B5B0-B87926800E4B">ReadLock</a>()</td></tr><tr class="bg"><td align="right" class="code">IMPORT_C <a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TBool</a></td><td><a href="#GUID-7A527F06-3590-397D-BCF0-457475AF9F5E">TryReadLock</a>()</td></tr><tr><td align="right" class="code">IMPORT_C <a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TBool</a></td><td><a href="#GUID-91304F9C-A807-33A2-8B94-3AC5F50D54FC">TryUpgradeReadLock</a>()</td></tr><tr class="bg"><td align="right" class="code">IMPORT_C <a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TBool</a></td><td><a href="#GUID-42445BCF-F15A-371D-AD4F-6A69F1E10209">TryWriteLock</a>()</td></tr><tr><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-F142B307-171E-3CF1-84E7-AF358684ED41">Unlock</a>()</td></tr><tr class="bg"><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-D11C3D23-3211-3664-92F0-6A1F0244F203">WriteLock</a>()</td></tr></tbody></table></div><div class="section section apiDesc section apidesc"><h2 class="sectiontitle">Detailed Description</h2>
<p class="p">A read-write lock.</p>
<p class="p">This is a lock for co-ordinating readers and writers to shared resources. It is designed to allow multiple concurrent readers. It is not a kernel side object and so does not inherit from <a class="xref" href="GUID-727D2B62-09A9-3CBC-AB6F-591E52EC68EB.html#GUID-727D2B62-09A9-3CBC-AB6F-591E52EC68EB">RHandleBase</a>. </p>
</div>
<h2 class="sectiontitle">Member Enumeration Documentation</h2><div class="topic reference apiRef apiValue cxxEnumeration nested1" id="GUID-F50B41AA-8444-3BF6-9B27-C20E217082FB"><a name="GUID-F50B41AA-8444-3BF6-9B27-C20E217082FB"><!-- --></a>
<h3 class="sectiontitle">Enum TReadWriteLockClientCategoryLimit</h3>
<div class="body refbody apiDetail apiValueDetail cxxEnumerationDetail section enumerationdetail"><div class="section section apiDesc section apidesc">
<div class="ph ph apiDefItem apiDefItem cxxEnumerators section enumerators"><table class="enumerators"><thead><tr><th>Enumerator</th><th>Value</th><th>Description</th></tr></thead><tr><td class="ph ph apiDefItem apiDefItem cxxEnumerator"><a name="GUID-EB95F4B1-031C-3112-89C9-E9B5B10D91D9"><span class="enumerator">EReadWriteLockClientCategoryLimit</span></a></td><td>KMaxTUint16</td><td>
<p class="p">Maximum number of clients in each category: read locked, read lock pending, write lock pending </p>
</td></tr></table></div>
</div>
</div>
<div class="topic reference apiRef apiValue cxxEnumeration nested1" id="GUID-2EC76BE9-76D3-346F-BB31-351A6D781030"><a name="GUID-2EC76BE9-76D3-346F-BB31-351A6D781030"><!-- --></a>
<h3 class="sectiontitle">Enum TReadWriteLockPriority</h3>
<div class="body refbody apiDetail apiValueDetail cxxEnumerationDetail section enumerationdetail"><div class="section section apiDesc section apidesc">
<div class="ph ph apiDefItem apiDefItem cxxEnumerators section enumerators"><table class="enumerators"><thead><tr><th>Enumerator</th><th>Value</th><th>Description</th></tr></thead><tr><td class="ph ph apiDefItem apiDefItem cxxEnumerator"><a name="GUID-60E12C11-14A4-30A5-BFA0-974090DAEDFC"><span class="enumerator">EWriterPriority</span></a></td><td></td><td>
<p class="p">Pending writers always get the lock before pending readers </p>
</td></tr><tr class="bg"><td class="ph ph apiDefItem apiDefItem cxxEnumerator"><a name="GUID-CCFD62AA-945E-3070-B6E9-6C338812040E"><span class="enumerator">EAlternatePriority</span></a></td><td></td><td>
<p class="p">Lock is given alternately to pending readers and writers </p>
</td></tr><tr><td class="ph ph apiDefItem apiDefItem cxxEnumerator"><a name="GUID-2ADEF659-EBA0-37C9-A3B5-D52AE4645AE8"><span class="enumerator">EReaderPriority</span></a></td><td></td><td>
<p class="p">Pending readers always get the lock before pending writers - beware writer starvation! </p>
</td></tr></table></div>
</div>
</div>
<h2 class="sectiontitle">Constructor &amp; Destructor Documentation</h2><div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-EF86DCFD-90AC-393B-9181-A076D8F2F07C"><a name="GUID-EF86DCFD-90AC-393B-9181-A076D8F2F07C"><!-- --></a>
<h3 class="sectiontitle">RReadWriteLock (  )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>RReadWriteLock</td><td>(</td><td>)</td><td>[inline]</td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Default constructor. </p>
</div>
</div>
</div>
<h2 class="sectiontitle">Member Function Documentation</h2><div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-A8F10301-09E1-39BA-97C2-3417AD516297"><a name="GUID-A8F10301-09E1-39BA-97C2-3417AD516297"><!-- --></a>
<h3 class="sectiontitle">Close (  )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C void</td><td>Close</td><td>(</td><td>)</td><td></td></tr></table></div><div class="section section apiDesc section apidesc">
<div class="p">Close a read-write lock object, releasing the associated semaphores. </div>
</div>
<div class="section panic"><table class="panic"><tr><th class="panic">Panic Codes</th></tr><tr><td class="paniccode">EReadWriteLockStillPending</td><td class="panicvalue">if there are any outstanding clients or pending clients</td></tr></table></div></div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-7E4589D5-5897-35E9-A751-CA3E4DFDEBF2"><a name="GUID-7E4589D5-5897-35E9-A751-CA3E4DFDEBF2"><!-- --></a>
<a name="GUID-23ACB42C-6450-352F-926B-76794EE4E1AF"><!-- --></a><h3 class="sectiontitle">CreateLocal ( TReadWriteLockPriority )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C <a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a></td><td>CreateLocal</td><td>(</td><td><a class="xref xref apiRelation" href="GUID-03B4A24E-33D7-3306-8C5E-DD17C2A4FAD1.html">TReadWriteLockPriority</a></td><td><span class="parameter">aPriority</span> = EWriterPriority</td><td>)</td><td></td></tr></table></div><div class="section section apiDesc section apidesc">
<div class="p">Initialise a read-write lock object. </div>
</div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">aPriority</td><td>Type of priority to use - see RReadWriteLockPriority::TReadWriteLockPriority  </td></tr></table></div>
<div class="ph ph apiDefNote cxxFunctionReturnDesc section returnsdoc"><dl class="returnsdoc"><dt class="dlterm">Return Value</dt><dd>KErrNone Instance successfully created Otherwise an error returned by RSemaphore::CreateLocal </dd></dl></div>
<div class="section panic"><table class="panic"><tr><th class="panic">Panic Codes</th></tr><tr><td class="paniccode">EReadWriteLockInvalidPriority</td><td class="panicvalue">if aPriority is not valid.</td></tr></table></div></div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-F8E708CE-0F46-31F6-B284-63E4382DFCF7"><a name="GUID-F8E708CE-0F46-31F6-B284-63E4382DFCF7"><!-- --></a>
<h3 class="sectiontitle">DowngradeWriteLock (  )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C void</td><td>DowngradeWriteLock</td><td>(</td><td>)</td><td></td></tr></table></div><div class="section section apiDesc section apidesc">
<div class="p">Atomically releases a held write lock and gains a read lock. Also unblocks any pending readers if:<ul class="ul"><li class="li"><p class="p">Priority is EPriorityReader or</p>
</li>
<li class="li"><div class="p">There are no pending writers This function can not fail, so it does not return anything. </div>
</li>
</ul>
</div>
</div>
<div class="section panic"><table class="panic"><tr><th class="panic">Panic Codes</th></tr><tr><td class="paniccode">EReadWriteLockBadLockState</td><td class="panicvalue">if the lock is not currently held</td></tr></table></div></div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-A8E28743-194E-3750-B5B0-B87926800E4B"><a name="GUID-A8E28743-194E-3750-B5B0-B87926800E4B"><!-- --></a>
<h3 class="sectiontitle">ReadLock (  )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C void</td><td>ReadLock</td><td>(</td><td>)</td><td></td></tr></table></div><div class="section section apiDesc section apidesc">
<div class="p">Ask for a read lock. Will be granted if: 1) No-one else currently holds the lock or 2) Only readers hold the lock and: a) There are no pending writers or b) The priority is for readers. Otherwise this function blocks until the lock becomes available to it. Please note that <a class="xref" href="GUID-03B4A24E-33D7-3306-8C5E-DD17C2A4FAD1.html#GUID-A8E28743-194E-3750-B5B0-B87926800E4B">ReadLock()</a> is not re-entrant - calling it a second time without releasing the first lock runs the risk of being blocked and risking a deadlock situation. </div>
</div>
<div class="section panic"><table class="panic"><tr><th class="panic">Panic Codes</th></tr><tr><td class="paniccode">EReadWriteLockTooManyClients</td><td class="panicvalue">if the resulting number of readers or pending readers exceeds EReadWriteLockClientCategoryLimit</td></tr></table></div></div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-7A527F06-3590-397D-BCF0-457475AF9F5E"><a name="GUID-7A527F06-3590-397D-BCF0-457475AF9F5E"><!-- --></a>
<h3 class="sectiontitle">TryReadLock (  )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C <a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TBool</a></td><td>TryReadLock</td><td>(</td><td>)</td><td></td></tr></table></div><div class="section section apiDesc section apidesc">
<div class="p">Ask for a read lock without blocking. </div>
<p class="p">See also: <a class="xref" href="GUID-03B4A24E-33D7-3306-8C5E-DD17C2A4FAD1.html#GUID-A8E28743-194E-3750-B5B0-B87926800E4B">ReadLock()</a> </p>
</div>
<div class="ph ph apiDefNote cxxFunctionReturnDesc section returnsdoc"><dl class="returnsdoc"><dt class="dlterm">Return Value</dt><dd>ETrue - lock granted EFalse - failed to obtain the lock </dd></dl></div>
<div class="section panic"><table class="panic"><tr><th class="panic">Panic Codes</th></tr><tr><td class="paniccode">EReadWriteLockTooManyClients</td><td class="panicvalue">if the resulting number of readers exceeds EReadWriteLockClientCategoryLimit</td></tr></table></div></div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-91304F9C-A807-33A2-8B94-3AC5F50D54FC"><a name="GUID-91304F9C-A807-33A2-8B94-3AC5F50D54FC"><!-- --></a>
<h3 class="sectiontitle">TryUpgradeReadLock (  )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C <a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TBool</a></td><td>TryUpgradeReadLock</td><td>(</td><td>)</td><td></td></tr></table></div><div class="section section apiDesc section apidesc">
<div class="p">Tries to atomically release a read lock and gain a write lock. This function will succeed if:<ul class="ul"><li class="li"><div class="p">This is the only reader and<ul class="ul"><li class="li"><p class="p">There are no pending writers or</p>
</li>
<li class="li"><div class="p">The priority is reader </div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="ph ph apiDefNote cxxFunctionReturnDesc section returnsdoc"><dl class="returnsdoc"><dt class="dlterm">Return Value</dt><dd>ETrue - write lock granted EFalse - failed to obtain a write lock, read lock retained </dd></dl></div>
<div class="section panic"><table class="panic"><tr><th class="panic">Panic Codes</th></tr><tr><td class="paniccode">EReadWriteLockBadLockState</td><td class="panicvalue">if the read lock is not currently held</td></tr></table></div></div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-42445BCF-F15A-371D-AD4F-6A69F1E10209"><a name="GUID-42445BCF-F15A-371D-AD4F-6A69F1E10209"><!-- --></a>
<h3 class="sectiontitle">TryWriteLock (  )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C <a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TBool</a></td><td>TryWriteLock</td><td>(</td><td>)</td><td></td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Ask for a write lock without blocking. </p>
<p class="p">See also: <a class="xref" href="GUID-03B4A24E-33D7-3306-8C5E-DD17C2A4FAD1.html#GUID-D11C3D23-3211-3664-92F0-6A1F0244F203">WriteLock()</a> </p>
</div>
<div class="ph ph apiDefNote cxxFunctionReturnDesc section returnsdoc"><dl class="returnsdoc"><dt class="dlterm">Return Value</dt><dd>ETrue - lock granted EFalse - failed to obtain the lock </dd></dl></div>
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-F142B307-171E-3CF1-84E7-AF358684ED41"><a name="GUID-F142B307-171E-3CF1-84E7-AF358684ED41"><!-- --></a>
<h3 class="sectiontitle">Unlock (  )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C void</td><td>Unlock</td><td>(</td><td>)</td><td></td></tr></table></div><div class="section section apiDesc section apidesc">
<div class="p">Releases a held read or write lock. If no-one else holds this lock (ie other readers) then this will unblock one or more pending clients based on the priority: EAlternatePriority - If a read lock is being released then:<ul class="ul"><li class="li"><p class="p">Give the lock to the first pending writer, if there is one</p>
</li>
<li class="li"><p class="p">Else give the lock to all pending readers, if there are any</p>
</li>
</ul>
</div>
<div class="p">If a write lock is being released then:<ul class="ul"><li class="li"><div class="p">If there are pending readers:<ul class="ul"><li class="li"><p class="p">If there are pending writers then unblock one pending reader</p>
</li>
<li class="li"><p class="p">Else if there are no pending writers then unblock all pending readers</p>
</li>
</ul>
</div>
</li>
<li class="li"><div class="p">Else unblock one pending writer, if there is one EReaderPriority - Unblock all pending readers. If none then unblock one pending writer, if there is one EWriterPriority - Unblock one pending writer, if there is one. If none then unblock any and all pending readers </div>
</li>
</ul>
</div>
</div>
<div class="section panic"><table class="panic"><tr><th class="panic">Panic Codes</th></tr><tr><td class="paniccode">EReadWriteLockBadLockState</td><td class="panicvalue">if the lock is not currently held</td></tr></table></div></div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-D11C3D23-3211-3664-92F0-6A1F0244F203"><a name="GUID-D11C3D23-3211-3664-92F0-6A1F0244F203"><!-- --></a>
<h3 class="sectiontitle">WriteLock (  )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C void</td><td>WriteLock</td><td>(</td><td>)</td><td></td></tr></table></div><div class="section section apiDesc section apidesc">
<div class="p">Ask for a write lock. Will be granted if no-one else currently holds the lock. Otherwise this function blocks until the lock becomes available to it. Only one writer can hold the lock at one time. No readers can hold the lock while a writer has it. Please note that <a class="xref" href="GUID-03B4A24E-33D7-3306-8C5E-DD17C2A4FAD1.html#GUID-D11C3D23-3211-3664-92F0-6A1F0244F203">WriteLock()</a> is not re-entrant - calling it a second time without releasing the first lock will block and cause a deadlock situation. </div>
</div>
<div class="section panic"><table class="panic"><tr><th class="panic">Panic Codes</th></tr><tr><td class="paniccode">EReadWriteLockTooManyClients</td><td class="panicvalue">if the resulting number of pending writers exceeds EReadWriteLockClientCategoryLimit</td></tr></table></div></div>
</div>
</div></div><div class="footer"><hr /><div class="copy">© Nokia 2005.</div></div>
</div></div></body>
<!-- Mirrored from devlib.symbian.slions.net/belle/GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-03B4A24E-33D7-3306-8C5E-DD17C2A4FAD1.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 04:22:42 GMT -->
</html>