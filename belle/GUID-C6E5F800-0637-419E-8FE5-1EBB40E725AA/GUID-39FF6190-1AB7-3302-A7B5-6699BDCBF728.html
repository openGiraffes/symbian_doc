<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en-us" xml:lang="en-us">

<!-- Mirrored from devlib.symbian.slions.net/belle/GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-39FF6190-1AB7-3302-A7B5-6699BDCBF728.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 04:21:50 GMT -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="copyright" content="(C) Copyright 2005" />
<meta name="DC.rights.owner" content="(C) Copyright 2005" />
<meta name="DC.Type" content="cxxFile" />
<meta name="DC.Title" content="sem.html" />
<meta name="abstract" content="" />
<meta name="description" content="" />
<meta name="DC.Format" content="XHTML" />
<meta name="DC.Identifier" content="GUID-39FF6190-1AB7-3302-A7B5-6699BDCBF728" />
<title>sem.h</title>
<meta name="keywords" content="api" /><link rel="stylesheet" type="text/css" href="css/nokiacxxref.css" />
<link href="css/s60/style.css" rel="stylesheet" type="text/css" />
<link href="PLUGINS_ROOT/com.nokia.forum.library/css/category_cpp3.html" rel="stylesheet" type="text/css" />
<link href="PLUGINS_ROOT/com.nokia.forum.library/css/category-cover_cpp3.html" rel="stylesheet" type="text/css" /></head>
<body id="GUID-39FF6190-1AB7-3302-A7B5-6699BDCBF728"><a name="GUID-39FF6190-1AB7-3302-A7B5-6699BDCBF728"><!-- --></a><div class="body"><div class="contentLeft prTxt">
<h1 class="sectiontitle">sem.h File Reference</h1>
<div class="body refbody apiDetail apiClassifierDetail cxxFileDetail"><p class="shortdesc">
<div class="section section apiDesc section apidesc">
</div>
<div class="topic reference apiRef apiOperation cxxDefine nested1" id="GUID-C793ECA6-1A74-3E8D-A7D5-2969A7CD1A5B"><a name="GUID-C793ECA6-1A74-3E8D-A7D5-2969A7CD1A5B"><!-- --></a>
<h3 class="sectiontitle">SEM_UNDO</h3>
<div class="body refbody apiDetail apiOperationDetail cxxDefineDetail"><p class="shortdesc">
<div class="section section apiDesc section apidesc">
</div>
</p></div>
<div class="topic reference apiRef apiOperation cxxDefine nested1" id="GUID-066B81BF-6EDB-3BA0-9553-CC6D56157046"><a name="GUID-066B81BF-6EDB-3BA0-9553-CC6D56157046"><!-- --></a>
<h3 class="sectiontitle">GETNCNT</h3>
<div class="body refbody apiDetail apiOperationDetail cxxDefineDetail"><p class="shortdesc">
<div class="section section apiDesc section apidesc">
<p class="p">commands for semctl. Return the value of semncnt.</p>
</div>
</p></div>
</div>
<div class="topic reference apiRef apiOperation cxxDefine nested1" id="GUID-D221B700-5FE6-3D83-A3F8-970BC6C7AE1E"><a name="GUID-D221B700-5FE6-3D83-A3F8-970BC6C7AE1E"><!-- --></a>
<h3 class="sectiontitle">GETPID</h3>
<div class="body refbody apiDetail apiOperationDetail cxxDefineDetail"><p class="shortdesc">
<div class="section section apiDesc section apidesc">
<p class="p">commands for semctl. Return the value of sempid</p>
</div>
</p></div>
</div>
<div class="topic reference apiRef apiOperation cxxDefine nested1" id="GUID-CD5FF5FB-0F7E-33F4-A5B0-F49D4AB110C1"><a name="GUID-CD5FF5FB-0F7E-33F4-A5B0-F49D4AB110C1"><!-- --></a>
<h3 class="sectiontitle">GETVAL</h3>
<div class="body refbody apiDetail apiOperationDetail cxxDefineDetail"><p class="shortdesc">
<div class="section section apiDesc section apidesc">
<p class="p">commands for semctl. Return the value of semval.</p>
</div>
</p></div>
</div>
<div class="topic reference apiRef apiOperation cxxDefine nested1" id="GUID-51B6C0F6-747B-367D-821F-C7BC3DEE4C57"><a name="GUID-51B6C0F6-747B-367D-821F-C7BC3DEE4C57"><!-- --></a>
<h3 class="sectiontitle">GETALL</h3>
<div class="body refbody apiDetail apiOperationDetail cxxDefineDetail"><p class="shortdesc">
<div class="section section apiDesc section apidesc">
<p class="p">commands for semctl. Return semvals into arg.array</p>
</div>
</p></div>
</div>
<div class="topic reference apiRef apiOperation cxxDefine nested1" id="GUID-847F2769-25F6-32B1-B3BA-7827F7FF0C82"><a name="GUID-847F2769-25F6-32B1-B3BA-7827F7FF0C82"><!-- --></a>
<h3 class="sectiontitle">GETZCNT</h3>
<div class="body refbody apiDetail apiOperationDetail cxxDefineDetail"><p class="shortdesc">
<div class="section section apiDesc section apidesc">
<p class="p">commands for semctl. Return the value of semzcnt.</p>
</div>
</p></div>
</div>
<div class="topic reference apiRef apiOperation cxxDefine nested1" id="GUID-04D9F792-8F01-3F70-8951-05E1DE0329F6"><a name="GUID-04D9F792-8F01-3F70-8951-05E1DE0329F6"><!-- --></a>
<h3 class="sectiontitle">SETVAL</h3>
<div class="body refbody apiDetail apiOperationDetail cxxDefineDetail"><p class="shortdesc">
<div class="section section apiDesc section apidesc">
<p class="p">commands for semctl. Set the value of semval to arg.val.</p>
</div>
</p></div>
</div>
<div class="topic reference apiRef apiOperation cxxDefine nested1" id="GUID-A7C05ABA-2B0D-326C-9BF9-233E2CEED369"><a name="GUID-A7C05ABA-2B0D-326C-9BF9-233E2CEED369"><!-- --></a>
<h3 class="sectiontitle">SETALL</h3>
<div class="body refbody apiDetail apiOperationDetail cxxDefineDetail"><p class="shortdesc">
<div class="section section apiDesc section apidesc">
<p class="p">commands for semctl. Set semvals from arg.array.</p>
</div>
</p></div>
</div>
<div class="topic reference apiRef apiOperation cxxDefine nested1" id="GUID-0DD9A2DA-B5B4-389E-83FC-BF439349F406"><a name="GUID-0DD9A2DA-B5B4-389E-83FC-BF439349F406"><!-- --></a>
<h3 class="sectiontitle">SEM_STAT</h3>
<div class="body refbody apiDetail apiOperationDetail cxxDefineDetail"><p class="shortdesc">
<div class="section section apiDesc section apidesc">
</div>
</p></div>
<div class="topic reference apiRef apiOperation cxxDefine nested1" id="GUID-A724BD29-7AED-34C2-9CF4-1A05EBEC702A"><a name="GUID-A724BD29-7AED-34C2-9CF4-1A05EBEC702A"><!-- --></a>
<h3 class="sectiontitle">SEM_INFO</h3>
<div class="body refbody apiDetail apiOperationDetail cxxDefineDetail"><p class="shortdesc">
<div class="section section apiDesc section apidesc">
</div>
</p></div>
<div class="topic reference apiRef apiOperation cxxDefine nested1" id="GUID-5FFFDFB1-58C9-35A4-8C70-2C857D32F1CE"><a name="GUID-5FFFDFB1-58C9-35A4-8C70-2C857D32F1CE"><!-- --></a>
<h3 class="sectiontitle">SEM_A</h3>
<div class="body refbody apiDetail apiOperationDetail cxxDefineDetail"><p class="shortdesc">
<div class="section section apiDesc section apidesc">
</div>
</p></div>
<div class="topic reference apiRef apiOperation cxxDefine nested1" id="GUID-32253CE3-66B6-368C-A124-80B5DFE924E4"><a name="GUID-32253CE3-66B6-368C-A124-80B5DFE924E4"><!-- --></a>
<h3 class="sectiontitle">SEM_R</h3>
<div class="body refbody apiDetail apiOperationDetail cxxDefineDetail"><p class="shortdesc">
<div class="section section apiDesc section apidesc">
</div>
</p></div>
<div class="topic reference apiRef apiValue cxxTypedef nested1" id="GUID-BE25FFE1-646E-34EF-B1E7-CCAAB66666AF"><a name="GUID-BE25FFE1-646E-34EF-B1E7-CCAAB66666AF"><!-- --></a>
<h3 class="sectiontitle">Typedef size_t</h3>
<div class="section signature"><table class="signature"><tr><td>typedef 
					<a class="xref xref apiRelation" href="GUID-6B9FA9E3-BBBA-3B9F-8538-94583F2D3BA4.html">__size_t</a>
</td><td>size_t</td></tr></table></div><div class="section section apiDesc section apidesc">
</div>
<div class="topic reference apiRef apiOperation cxxDefine nested1" id="GUID-70E6211E-7ADA-33FD-B9D0-4E6335A159A2"><a name="GUID-70E6211E-7ADA-33FD-B9D0-4E6335A159A2"><!-- --></a>
<h3 class="sectiontitle">_SIZE_T_DECLARED</h3>
<div class="body refbody apiDetail apiOperationDetail cxxDefineDetail"><p class="shortdesc">
<div class="section section apiDesc section apidesc">
</div>
</p></div>
<div class="topic reference apiRef apiValue cxxTypedef nested1" id="GUID-4A881CBD-10C9-35C6-A45B-B6B5215AC0D9"><a name="GUID-4A881CBD-10C9-35C6-A45B-B6B5215AC0D9"><!-- --></a>
<h3 class="sectiontitle">Typedef pid_t</h3>
<div class="section signature"><table class="signature"><tr><td>typedef 
					<a class="xref xref apiRelation" href="GUID-6B9FA9E3-BBBA-3B9F-8538-94583F2D3BA4.html">__pid_t</a>
</td><td>pid_t</td></tr></table></div><div class="section section apiDesc section apidesc">
</div>
<div class="topic reference apiRef apiOperation cxxDefine nested1" id="GUID-A787F2C9-E58F-342D-BD1E-B8EEB268586C"><a name="GUID-A787F2C9-E58F-342D-BD1E-B8EEB268586C"><!-- --></a>
<h3 class="sectiontitle">_PID_T_DECLARED</h3>
<div class="body refbody apiDetail apiOperationDetail cxxDefineDetail"><p class="shortdesc">
<div class="section section apiDesc section apidesc">
</div>
</p></div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-C8BFDBDF-C755-3F3C-BC46-BD7C23B9CE8A"><a name="GUID-C8BFDBDF-C755-3F3C-BC46-BD7C23B9CE8A"><!-- --></a>
<a name="GUID-3A07D707-91EE-3716-8ED7-5E358EB3B12A"><!-- --></a><h3 class="sectiontitle">semget ( key_t, int, int )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C int</td><td>semget</td><td>(</td><td><a class="xref xref apiRelation" href="GUID-9AF632B1-1CBB-3174-89E1-839D5B6E2CC8.html">key_t</a></td><td><span class="parameter">key</span>,</td></tr><tr><td colspan="3"> </td><td>int</td><td><span class="parameter">nsems</span>,</td></tr><tr><td colspan="3"> </td><td>int</td><td><span class="parameter">semflg</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"></td></tr></table></div><div class="section section apiDesc section apidesc">
<div class="p">
<pre class="pre codeblock"> SEM_R Read access for user.
 SEM_A Alter access for user.
 ( SEM_R&gt;&gt;3 )
  Read access for group.
 ( SEM_A&gt;&gt;3 )
  Alter access for group.
 ( SEM_R&gt;&gt;6 )
  Read access for other.
 ( SEM_A&gt;&gt;6 )
  Alter access for other.

Note:The 'group' flags (SEM_R &gt;&gt; 3 and SEM_A &gt;&gt; 3) are ignored in Symbian OS.</pre>
 Based on the values of key and semflg, semget returns the identifier of a newly created or previously existing set of semaphores. The key is analogous to a filename: it provides a handle that names an IPC object. There are three ways to specify a key: IPC_PRIVATE may be specified, in which case a new IPC object will be created. An integer constant may be specified. If no IPC object corresponding to key is specified and the IPC_CREAT bit is set in semflg, a new one will be created. The ftok function may be used to generate a key from a pathname.</div>
<div class="p">
<pre class="pre codeblock"> The mode of a newly created IPC object is determined by OR 'ing the following constants into the semflg argument: SEM_R Read access for user. SEM_A Alter access for user. ( SEM_R&gt;&gt;3 )  Read access for group. ( SEM_A&gt;&gt;3 )  Alter access for group. ( SEM_R&gt;&gt;6 )  Read access for other. ( SEM_A&gt;&gt;6 )  Alter access for other.</pre>
</div>
<p class="p">If a new set of semaphores is being created, nsems is used to indicate the number of semaphores the set should contain. Otherwise, nsems may be specified as 0.</p>
<div class="p">Examples: <pre class="pre codeblock">#include &lt;sys/ipc.h&gt;
#include &lt;sys/sem.h&gt;
#include &lt;stdio.h&gt;
#include &lt;errno.h&gt;

#define SEM_SET_KEY 1000
#define NO_OF_SEMAPHORES 2

int main(void)
{
    int sem_set_id;
    int perm;
    /*
 Create 2 semaphores in a set, with access only to
 the owner
     */
    perm = SEM_R | SEM_A;
    if((sem_set_id = semget(SEM_SET_KEY, NO_OF_SEMAPHORES, IPC_CREAT | perm))
        == -1) {
       printf("Semaphore creation failed with errno %d", errno);
       return -1;
    }
    return 0;
}</pre>
</div>
<div class="p">
<pre class="pre codeblock">Note :If the user need to create a semaphore which can be accessed from a different process, the 'other' flags (SEM_R &gt;&gt; 6 and SEM_A &gt;&gt; 6) must be added in parameter of shmflg.
e.g The value of the variable perm used in the above example code should be as below
perm = SEM_R | SEM_A | SEM_R &gt;&gt; 6 | SEM_A &gt;&gt; 6</pre>
</div>
<p class="p">
</p><p class="p">See also: <a class="xref" href="GUID-39FF6190-1AB7-3302-A7B5-6699BDCBF728.html#GUID-91EAD5EF-37D0-30DC-AB61-2823755EAE9C">semctl()</a> <a class="xref" href="GUID-39FF6190-1AB7-3302-A7B5-6699BDCBF728.html#GUID-00252FAD-C961-3766-AA86-E70E79827B92">semop()</a> <a class="xref" href="GUID-9AF632B1-1CBB-3174-89E1-839D5B6E2CC8.html#GUID-C3E73BB0-4271-3E7D-9023-36D7CDD735AF">ftok()</a></p>
</div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters">
<div class="ph ph apiDefNote cxxFunctionReturnDesc section returnsdoc"><dl class="returnsdoc"><dt class="dlterm">Return Value</dt><dd>The semget call returns the id of a semaphore set if successful; otherwise, -1 is returned and errno is set to indicate the error.</dd></dl></div>
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-00252FAD-C961-3766-AA86-E70E79827B92"><a name="GUID-00252FAD-C961-3766-AA86-E70E79827B92"><!-- --></a>
<a name="GUID-D9496DC0-7FE3-3642-8DDC-9A9B9995589F"><!-- --></a><h3 class="sectiontitle">semop ( int, struct sembuf *, unsigned )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C int</td><td>semop</td><td>(</td><td>int</td><td><span class="parameter">semid</span>,</td></tr><tr><td colspan="3"> </td><td>struct <a class="xref xref apiRelation" href="GUID-1DD3AEFA-F6A7-3744-9532-DCEDFEA496D0.html">sembuf</a> *</td><td><span class="parameter">sops</span>,</td></tr><tr><td colspan="3"> </td><td>unsigned</td><td><span class="parameter">nsops</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"></td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">The semop system call atomically performs the array of operations indicated by array on the semaphore set indicated by semid. The length of array is indicated by nops. Each operation is encoded in a struct sembuf , which is defined as follows:</p>
<div class="p">
<pre class="pre codeblock">struct sembuf {
        u_short sem_num;        /* semaphore # */
        short   sem_op;         /* semaphore operation */
        short   sem_flg;        /* operation flags */
};</pre>
</div>
<p class="p">For each element in array, sem_op and sem_flg determine an operation to be performed on semaphore number sem_num in the set. The values SEM_UNDO and IPC_NOWAIT may be ORed into the sem_flg member in order to modify the behavior of the given operation.</p>
<p class="p">The operation performed depends as follows on the value of sem_op: When sem_op is positive and the process has alter permission, the semaphore's value is incremented by sem_op's value. If SEM_UNDO is specified, the semaphore's adjust on exit value is decremented by sem_op's value. A positive value for sem_op generally corresponds to a process releasing a resource associated with the semaphore. The behavior when sem_op is negative and the process has alter permission, depends on the current value of the semaphore: If the current value of the semaphore is greater than or equal to the absolute value of sem_op, then the value is decremented by the absolute value of sem_op. If SEM_UNDO is specified, the semaphore's adjust on exit value is incremented by the absolute value of sem_op. If the current value of the semaphore is less than the absolute value of sem_op, one of the following happens: If IPC_NOWAIT was specified, then semop returns immediately with a return value of EAGAIN. Otherwise, the calling process is put to sleep until one of the following conditions is satisfied: Some other process removes the semaphore with the IPC_RMID option of semctl . In this case, semop returns immediately with a return value of EIDRM. The semaphore's value is greater than or equal to the absolute value of sem_op. When this condition becomes true, the semaphore's value is decremented by the absolute value of sem_op, the semaphore's adjust on exit value is incremented by the absolute value of sem_op.</p>
<p class="p">A negative value for sem_op generally means that a process is waiting for a resource to become available. When sem_op is zero and the process has read permission, one of the following will occur: If the current value of the semaphore is equal to zero then semop can return immediately. If IPC_NOWAIT was specified, then semop returns immediately with a return value of EAGAIN. Otherwise, the calling process is put to sleep until one of the following conditions is satisfied: Some other process removes the semaphore with the IPC_RMID option of semctl . In this case, semop returns immediately with a return value of EIDRM. The semaphore's value becomes zero.</p>
<p class="p">For each semaphore a process has in use, an "adjust on exit" value is maintained, as alluded to earlier. When a process exits, either voluntarily or involuntarily, the adjust on exit value for each semaphore is added to the semaphore's value. This can be used to insure that a resource is released if a process terminates unexpectedly.</p>
<div class="p">Examples: <pre class="pre codeblock">#include &lt;sys/ipc.h&gt;
#include &lt;sys/sem.h&gt;
#include &lt;stdio.h&gt;

void File_Update(char* path, int val)
{
    struct sembuf sem_op;
    FILE* fp;
    /*
 Wait on the semaphore till the value is non-negative.
     */
    sem_op.sem_num = 0;
    sem_op.sem_op = -1;
    sem_op.sem_flg = 0;
    semop(sem_set_id, &amp;sem;_op, 1);
    /*
 If we are here, then We have locked the semaphore,
 and are assured exclusive access to file.
 We can now manipulate the file
     */
    fp = fopen(path, "w");
    if (fp) {
        fprintf(fp, "%d", val);
        fclose(fp);
    }
    /*
 Increase the value of the semaphore by 1 so that others blocked on
 this semaphore get awakened.
     */
    sem_op.sem_num = 0;
    sem_op.sem_op = 1;
    sem_op.sem_flg = 0;
    semop(sem_set_id, &amp;sem;_op, 1);
}</pre>
</div>
<p class="p">See also: <a class="xref" href="GUID-39FF6190-1AB7-3302-A7B5-6699BDCBF728.html#GUID-91EAD5EF-37D0-30DC-AB61-2823755EAE9C">semctl()</a> <a class="xref" href="GUID-39FF6190-1AB7-3302-A7B5-6699BDCBF728.html#GUID-C8BFDBDF-C755-3F3C-BC46-BD7C23B9CE8A">semget()</a></p>
<p class="p">Bugs:</p>
<p class="p">The semop system call may block waiting for memory even if IPC_NOWAIT was specified.</p>
</div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters">
<div class="ph ph apiDefNote cxxFunctionReturnDesc section returnsdoc"><dl class="returnsdoc"><dt class="dlterm">Return Value</dt><dd>The semop function returns 0 if successful; otherwise the value -1 is returned and errno is set to indicate the error.</dd></dl></div>
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-91EAD5EF-37D0-30DC-AB61-2823755EAE9C"><a name="GUID-91EAD5EF-37D0-30DC-AB61-2823755EAE9C"><!-- --></a>
<a name="GUID-4387B0A3-FB9E-3ACA-86A7-6D79F6C2EFCC"><!-- --></a><h3 class="sectiontitle">semctl ( int, int, int, ... )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C int</td><td>semctl</td><td>(</td><td>int</td><td><span class="parameter">semid</span>,</td></tr><tr><td colspan="3"> </td><td>int</td><td><span class="parameter">semnum</span>,</td></tr><tr><td colspan="3"> </td><td>int</td><td><span class="parameter">cmd</span>,</td></tr><tr><td colspan="3"> </td><td>...</td><td><span class="parameter"></span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"></td></tr></table></div><div class="section section apiDesc section apidesc">
<div class="p">
<pre class="pre codeblock"> IPC_STAT Fetch the semaphore sets struct semid_ds ,
 storing it in the memory pointed to by arg.buf .
 IPC_SET Changes the sem_perm.uid, sem_perm.gid, and sem_perm.mode members of the semaphore sets struct semid_ds to match those of the struct pointed to by arg.buf.
 IPC_RMID Immediately removes the semaphore set from the system.
 The calling
 processe'ss uid must equal the semaphore sets sem_perm.uid or sem_perm.cuid,
 GETVAL Return the value of semaphore number semnum.
 SETVAL Set the value of semaphore number semnum to arg.val. Outstanding adjust on exit values for this semaphore in any process
 are cleared.
 GETPID Return the pid of the last process to perform an operation on
 semaphore number semnum.
 GETNCNT Return the number of processes waiting for semaphore number semnum's value to become greater than its current value.
 GETZCNT Return the number of processes waiting for semaphore number semnum's value to become 0.
 GETALL Fetch the value of all of the semaphores in the set into the
 array pointed to by arg.array.
 SETALL Set the values of all of the semaphores in the set to the values
 in the array pointed to by arg.array. Outstanding adjust on exit values for all semaphores in this set,
 in any process are cleared.</pre>
 The semctl system call performs the operation indicated by cmd on the semaphore set indicated by semid. A fourth argument, a union semun arg , is required for certain values of cmd. For the commands that use the arg argument, union semun is defined as follows: <pre class="pre codeblock">union semun {
        int     val;            /* value for SETVAL */
        struct  semid_ds *buf;  /* buffer for IPC_STAT &amp; IPC_SET */
        u_short *array;         /* array for GETALL &amp; SETALL */
};</pre>
</div>
<p class="p">Commands are performed as follows:</p>
<div class="p">
<pre class="pre codeblock">IPC_STAT Fetch the semaphore sets struct semid_ds ,
storing it in the memory pointed to by arg.buf . 
IPC_SET Changes the sem_perm.uid, sem_perm.gid, and sem_perm.mode members of the semaphore sets struct semid_ds to match those of the struct pointed to by arg.buf. 
IPC_RMID Immediately removes the semaphore set from the system.</pre>
</div>
<p class="p">The calling process's uid must equal the semaphore sets sem_perm.uid or sem_perm.cuid, GETVAL Return the value of semaphore number semnum. SETVAL Set the value of semaphore number semnum to arg.val. Outstanding adjust on exit values for this semaphore in any process are cleared.</p>
<div class="p">
<pre class="pre codeblock">GETPID Return the pid of the last process to perform an operation on
semaphore number semnum. 
GETNCNT Return the number of processes waiting for semaphore number semnum's value to become greater than its current value. 
GETZCNT Return the number of processes waiting for semaphore number semnum s value to become 0. 
GETALL Fetch the value of all of the semaphores in the set into the
array pointed to by arg.array. 
SETALL Set the values of all of the semaphores in the set to the values
in the array pointed to by arg.array. Outstanding adjust on exit values for all semaphores in this set,
in any process are cleared.</pre>
</div>
<div class="p">The struct <a class="xref" href="GUID-BF15D1B1-37C9-3934-85BD-4F20765E9BC3.html#GUID-BF15D1B1-37C9-3934-85BD-4F20765E9BC3">semid_ds</a> is defined as follows: <pre class="pre codeblock">struct semid_ds {
        struct  ipc_perm sem_perm;      /* operation permission struct */
        struct  sem *sem_base;  /* pointer to first semaphore in set */
        u_short sem_nsems;      /* number of sems in set */
        time_t  sem_otime;      /* last operation time */
        long    sem_pad1;       /* SVABI/386 says I need this here */
        time_t  sem_ctime;      /* last change time */
                                /* Times measured in secs since */
                                /* 00:00:00 GMT, Jan. 1, 1970 */
        long    sem_pad2;       /* SVABI/386 says I need this here */
        long    sem_pad3[4];    /* SVABI/386 says I need this here */
};</pre>
</div>
<div class="p">Examples: <pre class="pre codeblock">#include &lt;sys/ipc.h&gt;
#include &lt;sys/sem.h&gt;
#include &lt;stdio.h&gt;
#include &lt;errno.h&gt;

#define SEM_SET_KEY 1000
#define NO_OF_SEMAPHORES 2

int main(void)
{
    int sem_set_id;
    union semun sem_val;
    /*
 Create 2 semaphores in a set, with access only to
 the owner
     */
    if((sem_set_id = semget(SEM_SET_KEY, NO_OF_SEMAPHORES, IPC_CREAT | 0600))
        == -1) {
       printf("Semaphore creation failed with errno %d", errno);
       return -1;
    }
    /*
 Initialize the first semaphore in our set to 1
     */
    sem_val.array = NULL;
    sem_val.buf = NULL;
    sem_val.val = 1;
    if(semctl(sem_set_id, 0, SETVAL, sem_val) == -1) {
       printf("Could not initialize first semaphore (errno %d)", errno);
       return -1;
    }
    /*
 Initialize the second semaphore in our set to 0
     */
    sem_val.val = 0;
    if(semctl(sem_set_id, 1, SETVAL, sem_val) == -1) {
       printf("Could not initialize second semaphore (errno %d)", errno);
       return -1;
    }
    /*
 Delete the semaphore set
     */
    if(semctl(sem_set_id, NO_OF_SEMAPHORES, IPC_RMID) == -1) {
       printf("Could not delete semaphore set (errno %d)", errno);
       return -1;
    }
    return 0;
}</pre>
</div>
<p class="p">See also: <a class="xref" href="GUID-39FF6190-1AB7-3302-A7B5-6699BDCBF728.html#GUID-C8BFDBDF-C755-3F3C-BC46-BD7C23B9CE8A">semget()</a> <a class="xref" href="GUID-39FF6190-1AB7-3302-A7B5-6699BDCBF728.html#GUID-00252FAD-C961-3766-AA86-E70E79827B92">semop()</a></p>
</div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters">
<div class="ph ph apiDefNote cxxFunctionReturnDesc section returnsdoc"><dl class="returnsdoc"><dt class="dlterm">Return Value</dt><dd>On success, when cmd is one of GETVAL, GETPID, GETNCNT or GETZCNT, semctl returns the corresponding value; otherwise, 0 is returned. On failure, -1 is returned, and errno is set to indicate the error.</dd></dl></div>
</div>
</div>
</div></div><div class="footer"><hr /><div class="copy">© Nokia 2005.</div></div>
</div></div></div></div></div></div></div></div></div></div></p></div></div></div></body>
<!-- Mirrored from devlib.symbian.slions.net/belle/GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-39FF6190-1AB7-3302-A7B5-6699BDCBF728.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 04:21:52 GMT -->
</html>