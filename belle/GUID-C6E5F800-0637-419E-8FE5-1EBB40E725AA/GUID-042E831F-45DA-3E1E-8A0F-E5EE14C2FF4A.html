<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en-us" xml:lang="en-us">

<!-- Mirrored from devlib.symbian.slions.net/belle/GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-042E831F-45DA-3E1E-8A0F-E5EE14C2FF4A.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 04:21:53 GMT -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="copyright" content="(C) Copyright 2005" />
<meta name="DC.rights.owner" content="(C) Copyright 2005" />
<meta name="DC.Type" content="cxxFile" />
<meta name="DC.Title" content="shm.html" />
<meta name="abstract" content="" />
<meta name="description" content="" />
<meta name="DC.Format" content="XHTML" />
<meta name="DC.Identifier" content="GUID-042E831F-45DA-3E1E-8A0F-E5EE14C2FF4A" />
<title>shm.h</title>
<meta name="keywords" content="api" /><link rel="stylesheet" type="text/css" href="css/nokiacxxref.css" />
<link href="css/s60/style.css" rel="stylesheet" type="text/css" />
<link href="PLUGINS_ROOT/com.nokia.forum.library/css/category_cpp3.html" rel="stylesheet" type="text/css" />
<link href="PLUGINS_ROOT/com.nokia.forum.library/css/category-cover_cpp3.html" rel="stylesheet" type="text/css" /></head>
<body id="GUID-042E831F-45DA-3E1E-8A0F-E5EE14C2FF4A"><a name="GUID-042E831F-45DA-3E1E-8A0F-E5EE14C2FF4A"><!-- --></a><div class="body"><div class="contentLeft prTxt">
<h1 class="sectiontitle">shm.h File Reference</h1>
<div class="body refbody apiDetail apiClassifierDetail cxxFileDetail"><p class="shortdesc">
<div class="section section apiDesc section apidesc">
</div>
<div class="topic reference apiRef apiOperation cxxDefine nested1" id="GUID-9CED2689-91D6-3762-8AF9-D0F2AADE6016"><a name="GUID-9CED2689-91D6-3762-8AF9-D0F2AADE6016"><!-- --></a>
<h3 class="sectiontitle">SHM_RDONLY</h3>
<div class="body refbody apiDetail apiOperationDetail cxxDefineDetail"><p class="shortdesc">
<div class="section section apiDesc section apidesc">
<p class="p">Attach read-only (else read-write)</p>
</div>
</p></div>
</div>
<div class="topic reference apiRef apiOperation cxxDefine nested1" id="GUID-88DC52B7-E393-392C-92CA-A52BBF85ACF1"><a name="GUID-88DC52B7-E393-392C-92CA-A52BBF85ACF1"><!-- --></a>
<h3 class="sectiontitle">SHM_RND</h3>
<div class="body refbody apiDetail apiOperationDetail cxxDefineDetail"><p class="shortdesc">
<div class="section section apiDesc section apidesc">
<p class="p">Round attach address to SHMLBA</p>
</div>
</p></div>
</div>
<div class="topic reference apiRef apiOperation cxxDefine nested1" id="GUID-36E2768C-3476-36AB-B175-14B07A0D737C"><a name="GUID-36E2768C-3476-36AB-B175-14B07A0D737C"><!-- --></a>
<h3 class="sectiontitle">SHMLBA</h3>
<div class="body refbody apiDetail apiOperationDetail cxxDefineDetail"><p class="shortdesc">
<div class="section section apiDesc section apidesc">
<p class="p">Segment low boundary address multiple</p>
</div>
</p></div>
</div>
<div class="topic reference apiRef apiOperation cxxDefine nested1" id="GUID-5BD52CA3-AD15-3E24-8F79-09EC5D24474A"><a name="GUID-5BD52CA3-AD15-3E24-8F79-09EC5D24474A"><!-- --></a>
<h3 class="sectiontitle">SHM_R</h3>
<div class="body refbody apiDetail apiOperationDetail cxxDefineDetail"><p class="shortdesc">
<div class="section section apiDesc section apidesc">
</div>
</p></div>
<div class="topic reference apiRef apiOperation cxxDefine nested1" id="GUID-CA25263D-295E-3283-894E-1AC42AA4C9F9"><a name="GUID-CA25263D-295E-3283-894E-1AC42AA4C9F9"><!-- --></a>
<h3 class="sectiontitle">SHM_W</h3>
<div class="body refbody apiDetail apiOperationDetail cxxDefineDetail"><p class="shortdesc">
<div class="section section apiDesc section apidesc">
</div>
</p></div>
<div class="topic reference apiRef apiOperation cxxDefine nested1" id="GUID-869E54C8-C59E-318A-A409-BF3B2581E445"><a name="GUID-869E54C8-C59E-318A-A409-BF3B2581E445"><!-- --></a>
<h3 class="sectiontitle">SHM_LOCK</h3>
<div class="body refbody apiDetail apiOperationDetail cxxDefineDetail"><p class="shortdesc">
<div class="section section apiDesc section apidesc">
</div>
</p></div>
<div class="topic reference apiRef apiOperation cxxDefine nested1" id="GUID-ED58346C-F6B6-3B81-B5B6-FB4E1EDE6C01"><a name="GUID-ED58346C-F6B6-3B81-B5B6-FB4E1EDE6C01"><!-- --></a>
<h3 class="sectiontitle">SHM_UNLOCK</h3>
<div class="body refbody apiDetail apiOperationDetail cxxDefineDetail"><p class="shortdesc">
<div class="section section apiDesc section apidesc">
</div>
</p></div>
<div class="topic reference apiRef apiOperation cxxDefine nested1" id="GUID-595BC155-FBA7-374B-B7D1-6F592FE01F31"><a name="GUID-595BC155-FBA7-374B-B7D1-6F592FE01F31"><!-- --></a>
<h3 class="sectiontitle">SHM_STAT</h3>
<div class="body refbody apiDetail apiOperationDetail cxxDefineDetail"><p class="shortdesc">
<div class="section section apiDesc section apidesc">
</div>
</p></div>
<div class="topic reference apiRef apiOperation cxxDefine nested1" id="GUID-5E9349FB-9D66-397B-BCD6-1D855CFF2242"><a name="GUID-5E9349FB-9D66-397B-BCD6-1D855CFF2242"><!-- --></a>
<h3 class="sectiontitle">SHM_INFO</h3>
<div class="body refbody apiDetail apiOperationDetail cxxDefineDetail"><p class="shortdesc">
<div class="section section apiDesc section apidesc">
</div>
</p></div>
<div class="topic reference apiRef apiValue cxxTypedef nested1" id="GUID-4A881CBD-10C9-35C6-A45B-B6B5215AC0D9"><a name="GUID-4A881CBD-10C9-35C6-A45B-B6B5215AC0D9"><!-- --></a>
<h3 class="sectiontitle">Typedef pid_t</h3>
<div class="section signature"><table class="signature"><tr><td>typedef 
					<a class="xref xref apiRelation" href="GUID-6B9FA9E3-BBBA-3B9F-8538-94583F2D3BA4.html">__pid_t</a>
</td><td>pid_t</td></tr></table></div><div class="section section apiDesc section apidesc">
</div>
<div class="topic reference apiRef apiOperation cxxDefine nested1" id="GUID-A787F2C9-E58F-342D-BD1E-B8EEB268586C"><a name="GUID-A787F2C9-E58F-342D-BD1E-B8EEB268586C"><!-- --></a>
<h3 class="sectiontitle">_PID_T_DECLARED</h3>
<div class="body refbody apiDetail apiOperationDetail cxxDefineDetail"><p class="shortdesc">
<div class="section section apiDesc section apidesc">
</div>
</p></div>
<div class="topic reference apiRef apiValue cxxTypedef nested1" id="GUID-77F2BC7C-8164-32B5-9944-90C208562815"><a name="GUID-77F2BC7C-8164-32B5-9944-90C208562815"><!-- --></a>
<h3 class="sectiontitle">Typedef time_t</h3>
<div class="section signature"><table class="signature"><tr><td>typedef 
					<a class="xref xref apiRelation" href="GUID-6B9FA9E3-BBBA-3B9F-8538-94583F2D3BA4.html">__time_t</a>
</td><td>time_t</td></tr></table></div><div class="section section apiDesc section apidesc">
</div>
<div class="topic reference apiRef apiOperation cxxDefine nested1" id="GUID-B2FA5370-4959-35E7-8259-E9A8C7D6DA7E"><a name="GUID-B2FA5370-4959-35E7-8259-E9A8C7D6DA7E"><!-- --></a>
<h3 class="sectiontitle">_TIME_T_DECLARED</h3>
<div class="body refbody apiDetail apiOperationDetail cxxDefineDetail"><p class="shortdesc">
<div class="section section apiDesc section apidesc">
</div>
</p></div>
<div class="topic reference apiRef apiValue cxxTypedef nested1" id="GUID-BE25FFE1-646E-34EF-B1E7-CCAAB66666AF"><a name="GUID-BE25FFE1-646E-34EF-B1E7-CCAAB66666AF"><!-- --></a>
<h3 class="sectiontitle">Typedef size_t</h3>
<div class="section signature"><table class="signature"><tr><td>typedef 
					<a class="xref xref apiRelation" href="GUID-6B9FA9E3-BBBA-3B9F-8538-94583F2D3BA4.html">__size_t</a>
</td><td>size_t</td></tr></table></div><div class="section section apiDesc section apidesc">
</div>
<div class="topic reference apiRef apiOperation cxxDefine nested1" id="GUID-70E6211E-7ADA-33FD-B9D0-4E6335A159A2"><a name="GUID-70E6211E-7ADA-33FD-B9D0-4E6335A159A2"><!-- --></a>
<h3 class="sectiontitle">_SIZE_T_DECLARED</h3>
<div class="body refbody apiDetail apiOperationDetail cxxDefineDetail"><p class="shortdesc">
<div class="section section apiDesc section apidesc">
</div>
</p></div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-8F14A94A-4B07-36CD-929C-42E8AB7CAA7E"><a name="GUID-8F14A94A-4B07-36CD-929C-42E8AB7CAA7E"><!-- --></a>
<a name="GUID-AB87305F-B8AA-38EE-867A-9D8443C85AEE"><!-- --></a><h3 class="sectiontitle">shmget ( key_t, int, int )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C int</td><td>shmget</td><td>(</td><td><a class="xref xref apiRelation" href="GUID-9AF632B1-1CBB-3174-89E1-839D5B6E2CC8.html">key_t</a></td><td><span class="parameter">key</span>,</td></tr><tr><td colspan="3"> </td><td>int</td><td><span class="parameter">size</span>,</td></tr><tr><td colspan="3"> </td><td>int</td><td><span class="parameter">shmflg</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"></td></tr></table></div><div class="section section apiDesc section apidesc">
<div class="p">
<pre class="pre codeblock"> SHM_R Read access for user.
 SHM_W Write access for user.
 ( SHM_R&gt;&gt;3 )
  Read access for group.
 ( SHM_W&gt;&gt;3 )
  Write access for group.
 ( SHM_R&gt;&gt;6 )
  Read access for other.
 ( SHM_W&gt;&gt;6 )
  Write access for other.</pre>
 Based on the values of key and shmflg, shmget returns the identifier of a newly created or previously existing shared memory segment. The key is analogous to a filename: it provides a handle that names an IPC object. There are three ways to specify a key: IPC_PRIVATE may be specified, in which case a new IPC object will be created. An integer constant may be specified. If no IPC object corresponding to key is specified and the IPC_CREAT bit is set in shmflg, a new one will be created. The ftok may be used to generate a key from a pathname.</div>
<div class="p">
<pre class="pre codeblock"> The mode of a newly created IPC object is determined by OR 'ing the following constants into the shmflg argument: SHM_R Read access for user. SHM_W Write access for user. ( SHM_R&gt;&gt;3 )  Read access for group. ( SHM_W&gt;&gt;3 )  Write access for group. ( SHM_R&gt;&gt;6 )  Read access for other. ( SHM_W&gt;&gt;6 )  Write access for other.</pre>
</div>
<p class="p">When creating a new shared memory segment, size indicates the desired size of the new segment in bytes. The size of the segment may be rounded up to a multiple convenient to the kernel (i.e., the page size).</p>
<div class="p">Examples: <pre class="pre codeblock">#include &lt;sys/ipc.h&gt;
#include &lt;sys/shm.h&gt;
#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
#include &lt;errno.h&gt;

#define SHM_SEG_SIZE 1024

int main(void)
{
    int shm_id;
    int perm;
    /*
 Create a shared memory segment
     */
    perm = SHM_R | SHM_W;
    if ((shm_id = shmget(IPC_PRIVATE, SHM_SEG_SIZE,
                         IPC_CREAT | IPC_EXCL | perm))
         == -1) {
        printf("Shared memory create failed with errno %d", errno);
        return -1;
    }
    return 0;
}</pre>
</div>
</div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters">
<div class="ph ph apiDefNote cxxFunctionReturnDesc section returnsdoc"><dl class="returnsdoc"><dt class="dlterm">Return Value</dt><dd>Upon successful completion, shmget returns the positive integer identifier of a shared memory segment. Otherwise, -1 is returned and errno set to indicate the error.</dd></dl></div>
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-B5347A3D-A0B0-3EFF-BB18-96ABB81C1AC4"><a name="GUID-B5347A3D-A0B0-3EFF-BB18-96ABB81C1AC4"><!-- --></a>
<a name="GUID-C4229D50-A600-3684-B918-3F7A96060750"><!-- --></a><h3 class="sectiontitle">shmat ( int, const void *, int )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C void *</td><td>shmat</td><td>(</td><td>int</td><td><span class="parameter">shmid</span>,</td></tr><tr><td colspan="3"> </td><td>const void *</td><td><span class="parameter">shmaddr</span>,</td></tr><tr><td colspan="3"> </td><td>int</td><td><span class="parameter">shmflg</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"></td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">The shmat system call attaches the shared memory segment identified by shmid to the calling process's address space. The address where the segment is attached is determined as follows: If shmaddr is 0, the segment is attached at an address selected by the kernel. If shmaddr is nonzero and SHM_RND is not specified in shmflg, the segment is attached the specified address. (a nonzero addr is not supported) If addr is specified and SHM_RND is specified, addr is rounded down to the nearest multiple of SHMLBA.(a nonzero addr is not supported)</p>
<p class="p">The shmdt system call detaches the shared memory segment at the address specified by shmaddr from the calling process's address space.</p>
<div class="p">Examples: <pre class="pre codeblock">#include &lt;sys/ipc.h&gt;
#include &lt;sys/shm.h&gt;
#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
#include &lt;errno.h&gt;

#define SHM_SEG_SIZE 1024

int main(void)
{
    int shm_id;
    char *shm_addr;
    /*
 Create a shared memory segment
     */
    if ((shm_id = shmget(IPC_PRIVATE, SHM_SEG_SIZE,
                         IPC_CREAT | IPC_EXCL | 0666))
         == -1) {
        printf("Shared memory create failed with errno %d", errno);
        return -1;
    }
    /*
 Attach the shared memory segment to the
 process address space
     */
    if((shm_addr = (char *)shmat(shm_id, NULL, 0)) == (void *)-1) {
       printf("Shared memory attach failed with errno %d", errno);
       return -1;
    }
    /*
 Copy data to shared memory segment
     */
    strcpy(shm_addr, "some_random_data");
    /*
 Detach the shared memory segment
     */
    if(shmdt(shm_addr) == -1) {
       printf("Shared memory detach failed with errno %d", errno);
    }
    /*
 Remove the shared memory segment
     */
    if(shmctl(shm_id, IPC_RMID, NULL) == -1) {
       printf("Shared memory destroy failed with errno %d", errno);
    }
    return 0;
}</pre>
</div>
</div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">shmflg</td><td>Note: This description also covers the following functions - shmdt() </td></tr></table></div>
<div class="ph ph apiDefNote cxxFunctionReturnDesc section returnsdoc"><dl class="returnsdoc"><dt class="dlterm">Return Value</dt><dd>Upon success, shmat returns the address where the segment is attached; otherwise, -1 is returned and errno is set to indicate the error. The shmdt function returns the value 0 if successful; otherwise the value -1 is returned and errno is set to indicate the error.</dd></dl></div>
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-E9CF331B-54FA-3B17-8D28-D0D16DB6DD05"><a name="GUID-E9CF331B-54FA-3B17-8D28-D0D16DB6DD05"><!-- --></a>
<a name="GUID-5499A117-58FE-3E73-87C0-9374922E8499"><!-- --></a><h3 class="sectiontitle">shmdt ( const void * )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C int</td><td>shmdt</td><td>(</td><td>const void *</td><td><span class="parameter">shmaddr</span></td><td>)</td><td></td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">
</p></div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">shmaddr</td><td>Refer to shmat() for the documentation </td></tr></table></div>
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-6FFFAEA1-CFAA-3A5F-BECE-355C3849536F"><a name="GUID-6FFFAEA1-CFAA-3A5F-BECE-355C3849536F"><!-- --></a>
<a name="GUID-64F26ECE-D511-3548-9C3B-535F03B08107"><!-- --></a><h3 class="sectiontitle">shmctl ( int, int, struct shmid_ds * )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C int</td><td>shmctl</td><td>(</td><td>int</td><td><span class="parameter">shmid</span>,</td></tr><tr><td colspan="3"> </td><td>int</td><td><span class="parameter">cmd</span>,</td></tr><tr><td colspan="3"> </td><td>struct <a class="xref xref apiRelation" href="GUID-6150225A-D6EA-3068-B5FB-6AEFD532F902.html">shmid_ds</a> *</td><td><span class="parameter">buf</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"></td></tr></table></div><div class="section section apiDesc section apidesc">
<div class="p">
<pre class="pre codeblock"> IPC_STAT Fetch the segment's struct shmid_ds ,
 storing it in the memory pointed to by buf.
 IPC_SET Changes the shm_perm.uid, shm_perm.gid, and shm_perm.mode members of the segment's struct shmid_ds to match those of the struct pointed to by buf.
 IPC_RMID Removes the segment from the system.
 The removal will not take
 effect until all processes having attached the segment have exited;
 however, once the IPC_RMID operation has taken place, no further
 processes will be allowed to attach the segment.</pre>
</div>
<p class="p">Performs the action specified by cmd on the shared memory segment identified by shmid:</p>
<p class="p">IPC_STAT Fetch the segment's struct <a class="xref" href="GUID-6150225A-D6EA-3068-B5FB-6AEFD532F902.html#GUID-6150225A-D6EA-3068-B5FB-6AEFD532F902">shmid_ds</a> , storing it in the memory pointed to by buf. IPC_SET Changes the shm_perm.uid, shm_perm.gid, and shm_perm.mode members of the segment's struct <a class="xref" href="GUID-6150225A-D6EA-3068-B5FB-6AEFD532F902.html#GUID-6150225A-D6EA-3068-B5FB-6AEFD532F902">shmid_ds</a> to match those of the struct pointed to by buf. IPC_RMID Removes the segment from the system.</p>
<p class="p">The removal will not take effect until all processes having attached the segment have exited; however, once the IPC_RMID operation has taken place, no further processes will be allowed to attach the segment.</p>
<div class="p">The <a class="xref" href="GUID-6150225A-D6EA-3068-B5FB-6AEFD532F902.html#GUID-6150225A-D6EA-3068-B5FB-6AEFD532F902">shmid_ds</a> structure is defined as follows: <pre class="pre codeblock">struct shmid_ds {
    struct ipc_perm shm_perm;   /* operation permission structure */
    int             shm_segsz;  /* size of segment in bytes */
    pid_t           shm_lpid;   /* process ID of last shared memory op */
    pid_t           shm_cpid;   /* process ID of creator */
    short           shm_nattch; /* number of current attaches */
    time_t          shm_atime;  /* time of last shmat() */
    time_t          shm_dtime;  /* time of last shmdt() */
    time_t          shm_ctime;  /* time of last change by shmctl() */
    void           *shm_internal; /* sysv stupidity */
};</pre>
</div>
<div class="p">Examples: <pre class="pre codeblock">#include &lt;sys/ipc.h&gt;
#include &lt;sys/shm.h&gt;
#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
#include &lt;errno.h&gt;

#define SHM_SEG_SIZE 1024

int main(void)
{
    int shm_id;
    char *shm_addr;
    /*
 Create a shared memory segment
     */
    if ((shm_id = shmget(IPC_PRIVATE, SHM_SEG_SIZE,
                         IPC_CREAT | IPC_EXCL | 0666))
         == -1) {
        printf("Shared memory create failed with errno %d", errno);
        return -1;
    }
    /*
 Attach the shared memory segment to the
 process address space
     */
    if((shm_addr = (char *)shmat(shm_id, NULL, 0)) == (void *)-1) {
       printf("Shared memory attach failed with errno %d", errno);
       return -1;
    }
    /*
 Copy data to shared memory segment
     */
    strcpy(shm_addr, "some_random_data");
    /*
 Detach the shared memory segment
     */
    if(shmdt(shm_addr) == -1) {
       printf("Shared memory detach failed with errno %d", errno);
    }
    /*
 Remove the shared memory segment
     */
    if(shmctl(shm_id, IPC_RMID, NULL) == -1) {
       printf("Shared memory destroy failed with errno %d", errno);
    }
    return 0;
}</pre>
</div>
</div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters">
<div class="ph ph apiDefNote cxxFunctionReturnDesc section returnsdoc"><dl class="returnsdoc"><dt class="dlterm">Return Value</dt><dd>The shmctl function returns the value 0 if successful; otherwise the value -1 is returned and errno is set to indicate the error.</dd></dl></div>
</div>
</div>
</div></div><div class="footer"><hr /><div class="copy">© Nokia 2005.</div></div>
</div></div></div></div></div></div></div></div></div></div></div></div></p></div></div></div></body>
<!-- Mirrored from devlib.symbian.slions.net/belle/GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-042E831F-45DA-3E1E-8A0F-E5EE14C2FF4A.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 04:21:56 GMT -->
</html>