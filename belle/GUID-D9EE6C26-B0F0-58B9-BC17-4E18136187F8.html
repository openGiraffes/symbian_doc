
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<!-- Mirrored from devlib.symbian.slions.net/belle/GUID-D9EE6C26-B0F0-58B9-BC17-4E18136187F8.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 03:59:26 GMT -->
<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="copyright" content="(C) Copyright 2012" /><meta name="DC.rights.owner" content="(C) Copyright 2012" /><meta name="DC.Type" content="concept" /><meta name="DC.Title" content="Cancelling and closing transactions" /><meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7" /><meta name="DC.Relation" scheme="URI" content="GUID-C0D38954-2FC5-4E8B-BC11-229464DCF16C" /><meta name="DC.Relation" scheme="URI" content="GUID-1E8904E3-43AC-5332-A2EF-F11F5728DBE8" /><meta name="DC.Relation" scheme="URI" content="GUID-B4A54501-4AA4-5ACB-96D7-4427C7752639" /><meta name="DC.Format" content="XHTML" /><meta name="DC.Identifier" content="GUID-D9EE6C26-B0F0-58B9-BC17-4E18136187F8" /><meta name="DC.Language" content="en" /><title>Cancelling and closing transactions </title><link href="css/s60/style.css" rel="stylesheet" type="text/css" /><link href="PLUGINS_ROOT/com.nokia.forum.library/css/category_cpp5.html" rel="stylesheet" type="text/css" /></head><body><div class="body"><div class="contentLeft prTxt"><h1 class="pageHeading" id="GUID-D9EE6C26-B0F0-58B9-BC17-4E18136187F8">Cancelling and closing transactions</h1><div><p>Transactions that have been submitted can be cancelled at any time using <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-2E673024-239B-3965-8880-C47B7CC24EF6.html#GUID-48A73A16-E6EB-39F4-88A5-0D84BD164FF2"><code class="apiname">RHTTPTransaction::Cancel()</code></a>. When this is done, no further events are received for that transaction as originally submitted. </p> <p>An example from <code>HTTPEXAMPLECLIENT</code>: </p> <pre class="codeblock">void CHttpEventHandler::MHFRunL(RHTTPTransaction aTransaction, const THTTPEvent&amp; aEvent)
    {
    switch (aEvent.iStatus)
        {
        case THTTPEvent::EGotResponseHeaders:
            {
            ...
            // If we're cancelling, do it now...
            if (cancelling)
                {
                iUtils.Test().Printf(_L("\nTransaction Cancelled\n"));
                aTransaction.Close();
                CActiveScheduler::Stop();
                }
...</pre> <p>In this case, the transaction is left in a cancelled state. The client now has the option to modify the request if required, and to resubmit the transaction. This might be done, for example, if the HTTP server has indicated with a 400-series status code that there was a client error. </p> <p>When a transaction is resubmitted after cancellation, it is exactly as if it had been submitted for the first time. For example, no preferential treatment is given to it in terms of time-to-service. </p> <p>The process of cancelling in an <code class="codeph">MHFRunL()</code> method, modifying the request, and resubmitting is common in filter design. See <a href="GUID-AA2A730E-A7C9-5647-AD42-11C3BAF4C38D.html">Filters</a> for more information. </p> <p>If the client wants to abort a transaction, it can close the transaction using <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-2E673024-239B-3965-8880-C47B7CC24EF6.html#GUID-0ABF9404-EA7F-3CB3-B08B-D9154EF6F2D8"><code class="apiname">RHTTPTransaction::Close()</code></a>. It is not necessary to cancel first, since a <code class="codeph">Cancel()</code> is done automatically during the <code class="codeph">Close()</code>. Closing the transaction enables HTTP to clean up resources allocated during the execution of that transaction. </p> <p>Once a transaction is closed, it must <em>not</em> be reused. Reusing a closed transaction causes the client to behave unpredictably. </p> </div></div></div><div class="footer"><p class="metadata">Last updated December 14th, 2009</p><hr /><div class="copy">Â© Nokia 2012.</div></div></body>
<!-- Mirrored from devlib.symbian.slions.net/belle/GUID-D9EE6C26-B0F0-58B9-BC17-4E18136187F8.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 03:59:26 GMT -->
</html>