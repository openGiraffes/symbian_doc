<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<!-- Mirrored from devlib.symbian.slions.net/belle/GUID-1A9B515C-C20F-4EC7-B62A-223B219BBC4E/sf_mw_classicui_classicui_pub_information_preview_popup_api.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 04:10:46 GMT -->
<head><title>Information Preview Popup API Specification</title><?php include ("define.html"); ??><?php include (ROOT."/nokiaglobal/styles.php"); ??><?php include ("archdoc_head.html"); ??><link href="css/html.css" media="screen" rel="stylesheet" title="Nokia Web Guidelines" type="text/css" /></head><body><?php include (ROOT."/nokiaglobal/header.php"); ??><div id="sdl_container"><div id="leftMenu"><div id="expandcontractdiv"><a id="index">Symbian Platform API Specifications</a></div><div id="treeDiv1">&#160;</div><script type="text/javascript">var currentIconMode = 0; window.name="i127 i368 i463 i489"; YAHOO.util.Event.onDOMReady(buildTree,this,true);</script></div><div id="sdl_content"><h1>Information Preview Popup API Specification</h1>
<table class="toc" id="toc" summary="Contents"><tr><td><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1"><a href="#Overview"><span class="tocnumber">1</span> <span class="toctext">Overview</span></a>
<ul>
<li class="toclevel-2"><a href="#Description"><span class="tocnumber">1.1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-2"><a href="#Changes"><span class="tocnumber">1.2</span> <span class="toctext">Changes</span></a></li>
<li class="toclevel-2"><a href="#Use_Cases"><span class="tocnumber">1.3</span> <span class="toctext">Use Cases</span></a></li>
<li class="toclevel-2"><a href="#Class_Structure"><span class="tocnumber">1.4</span> <span class="toctext">Class Structure</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#Using_The_API"><span class="tocnumber">2</span> <span class="toctext">Using The API</span></a>
<ul>
<li class="toclevel-2"><a href="#Creating_preview_popup"><span class="tocnumber">2.1</span> <span class="toctext">Creating preview popup</span></a>
<ul>
<li class="toclevel-3"><a href="#Synchronous_content_building"><span class="tocnumber">2.1.1</span> <span class="toctext">Synchronous content building</span></a></li>
<li class="toclevel-3"><a href="#Asynchronous_content_building"><span class="tocnumber">2.1.2</span> <span class="toctext">Asynchronous content building</span></a></li>
<li class="toclevel-3"><a href="#Setting_properties"><span class="tocnumber">2.1.3</span> <span class="toctext">Setting properties</span></a></li>
</ul>
</li>
<li class="toclevel-2"><a href="#Showing_popup"><span class="tocnumber">2.2</span> <span class="toctext">Showing popup</span></a></li>
<li class="toclevel-2"><a href="#Hiding_popup"><span class="tocnumber">2.3</span> <span class="toctext">Hiding popup</span></a></li>
<li class="toclevel-2"><a href="#Deleting_popup"><span class="tocnumber">2.4</span> <span class="toctext">Deleting popup</span></a></li>
<li class="toclevel-2"><a href="#Error_handling"><span class="tocnumber">2.5</span> <span class="toctext">Error handling</span></a></li>
</ul>
</li>
</ul>
</td></tr></table>
<a name="Overview"><h2> <span class="mw-headline">1 Overview </span></h2>
</a><p>Preview popup component is a floating AVKON popup component. Its
purpose is to provide a common popup frame that applications can utilize
to show additional information to the user.
</p><p>Preview popup can be used in two behavioral modes; in the default
mode where the popup is hidden automatically as a result of timeout
or input event (either a key press or a pointer event) or in permanent
mode where the popup stays visible until it is dismissed by the application
code.
</p><p><br />
</p>
<table border="1" cellspacing="0">
<tr>
<td width="12%"><b>API category</b></td><td>public
</td></tr>
<tr>
<td width="12%"><b>API type</b></td><td>c++
</td></tr>
<tr>
<td width="12%"><b>Existed since</b></td><td>Legacy S60 3.2
</td></tr>
<tr>
<td width="12%"><b>API libraries</b></td><td>avkon.lib
</td></tr>
<tr>
<td width="12%"><b>Location</b></td><td><span class="plainlinks"><code>/sf/mw/classicui/classicui_pub/information_preview_popup_api</code></span>
</td></tr>
<tr>
<td width="12%"><b>Buildfiles</b></td><td><span class="plainlinks"><code>/sf/mw/classicui/classicui_pub/information_preview_popup_api/group/bld.inf</code></span>
</td></tr></table>
<p><br />
</p>
<a name="Description"><h3> <span class="mw-headline">1.1 Description </span></h3>
</a><p>Information Preview Popup API can be used by all GUI applications.
It is a library API that provides an interface for construction and
using the Preview Popup UI component. The interface contains only
method calls that can be used for creating local objects of provided
interface classes and then using these objects.
</p>
<a name="Changes"><h3> <span class="mw-headline">1.2 Changes </span></h3>
</a><p>This API is available on S60 Release 3.2 and onwards.
</p>
<a name="Use_Cases"><h3> <span class="mw-headline">1.3 Use Cases </span></h3>
</a><p>The most important use cases of Information Preview Popup API are
illustrated in [Information_Preview_Popup_API_Specification.topic2.1_fig1 Figure 1].
</p>
<div style="text-align:center"><a class="image" href="images/SPB_10_1_Information_Preview_Popup_API_Use_Cases.png" title="Information Preview Popup API use cases"><img alt="Information Preview Popup API use cases" border="0" height="350" src="images/SPB_10_1_Information_Preview_Popup_API_Use_Cases.png" width="353" /></a></div>
<div style="text-align:center"><i>Information Preview Popup API use cases</i></div>
<p>The use cases are as follows:
</p><p><b> Creating popup</b>
</p>
<ul><li> Create controller for the popup
</li><li> Set content for the popup, or provide interface for asynchronous
</li></ul>
<p>content building.
</p>
<ul><li> Set properties and timeouts for the popup.
</li></ul>
<p><b> Showing popup</b>
</p>
<ul><li> Set the position for the popup.
</li><li> Request popup to be shown after specified timeout.
</li></ul>
<p><b> Hiding popup</b>
</p>
<ul><li> Request the popup to be hidden immediately.
</li></ul>
<p><b> Deleting popup</b>
</p>
<ul><li> Release the resources reserved for the popup.
</li></ul>
<a name="Class_Structure"><h3> <span class="mw-headline">1.4 Class Structure </span></h3>
<table border="1" cellspacing="0">
<caption> Summary of API classes and header files
</caption>
<tr bgcolor="gray">
<th>Classes</th><th>Files
</th></tr>
<tr>
<td><span class="plainlinks"><code></code></span></td></tr></table></a>CAknPreviewPopUpController <td><span class="plainlinks"><code>/epoc32/include/mw/AknPreviewPopUpController.h</code></span>
</td>
<tr>
<td><span class="plainlinks"><code>MAknPreviewPopUpContentProvider</code> </span></td><td><span class="plainlinks"><code>/epoc32/include/mw/AknPreviewPopUpContentProvider.h</code></span>
</td></tr>
<tr>
<td><span class="plainlinks"><code>MAknPreviewPopUpObserver</code> </span></td><td><span class="plainlinks"><code>/epoc32/include/mw/AknPreviewPopUpObserver.h</code></span>
</td></tr>
<p>The class structure for Information Preview Popup API consists
of three classes: <span class="plainlinks"><code>CAknPreviewPopUpController</code> </span>, <span class="plainlinks"><code>MAknPreviewPopUpObserver</code> </span>, and <span class="plainlinks"><code>MAknPreviewPopUpContentProvider</code> </span>. The API class structure is shown in [Information_Preview_Popup_API_Specification.topic2.2_fig2 Figure 2] below.
</p>
<div style="text-align:center"><a class="image" href="images/SPB_10_1_Information_Preview_Popup_API_Class_Structure.png" title="Information Preview Popup API class structure"><img alt="Information Preview Popup API class structure" border="0" height="258" src="images/SPB_10_1_Information_Preview_Popup_API_Class_Structure.png" width="545" /></a></div>
<div style="text-align:center"><i>Information Preview Popup API class structure</i></div>
<p>The <span class="plainlinks"><code>CAknPreviewPopUpController</code> </span> class provides
an interface for controlling preview popups. A separate instance of
this class is required for each preview popup.
</p><p>The client application using preview popup, must realize the <span class="plainlinks"><code>MAknPreviewPopUpObserver</code> </span> interface. This interface is used
as a callback hook between the actual popup and the client application.
The client application receives notifications through this interface
when popup is shown or hidden.
</p><p>The content for the preview popup can be provided either synchronously
or asynchronously. When synchronous contend building is used, the
client application sets the content for the popup when the popup up
is constructed. Alternatively, the <span class="plainlinks"><code>MAknPreviewPopUpContentProvider</code> </span> interface can be used for utilizing asynchronous content building
for the preview popup. In this case, the client application has to
provide realization for the interface, which builds the content when
requested by the interface, and then notifies the popup when content
has been build.
</p>
<a name="Using_The_API"><h2> <span class="mw-headline">2 Using The API </span></h2>
</a><p>The use of Information Preview Popup API usually contains the following
steps:
</p>
<ul><li> Link the AVKON library to the project file of the application.
</li><li> Provide an observer class that realizes the <span class="plainlinks"><code>MAknPreviewPopUpObserver</code> </span> interface.
</li><li> If asynchronous content building is used, provide a class that
</li></ul>
<p>realizes the <span class="plainlinks"><code>MAknPreviewPopUpContentProvider</code> </span> interface.
</p>
<ul><li> Create an instance of the <span class="plainlinks"><code>CAknPreviewPopUpController</code> </span> class.
</li><li> Provide content for the preview popup either synchronously or
</li></ul>
<p>asynchronously.
</p>
<ul><li> Show and hide the popup.
</li><li> Receive information of the visibility changes through the observer
</li></ul>
<p>interface.
</p>
<ul><li> Delete the popup and its controller.
</li><li> Delete popup content
</li></ul>
<p>More detailed instruction on using the API can be found in the
following sections.
</p>
<a name="Creating_preview_popup"><h3> <span class="mw-headline">2.1 Creating preview popup </span></h3>
</a><p>A preview popup is created by creating a controller, an instance
of <span class="plainlinks"><code>CAknPreviewPopUpController</code> </span>, for the popup. During
the construction, the style for the popup must be specified. The behavior
flags used in specifying the style for the preview popup are defined
in the <span class="plainlinks"><code>CAknPreviewPopUpController::TAknPreviewStyle</code> </span> enumeration. These flags can be given as an argument to the constructors.
Description for each flag is listed below:
</p>
<ul><li> <span class="plainlinks"><code>ELayoutDefault</code> </span> specifies the popup to use the
</li></ul>
<p>default graphics and layout.
</p>
<ul><li> <span class="plainlinks"><code>ELayoutSubMenu</code> </span> specifies the popup to use the
</li></ul>
<p>submenu graphics and layout instead of the default ones, even if the <span class="plainlinks"><code>ELayoutDefault</code> </span> flag is set as well.
</p>
<ul><li> <span class="plainlinks"><code>EPermanentMode</code> </span> sets the preview popup to permanent
</li></ul>
<p>mode. In permanent mode, the visible preview popup is not dismissed
by pen or key events, and a timeout for hiding the popup is not used.
Instead, the client application must hide the visible popup explicitly,
when necessary.
</p>
<ul><li> <span class="plainlinks"><code>EFixedMode</code> </span> sets the preview popup to use the
</li></ul>
<p>default size defined in the layout data instead of scaling itself
to accommodate its content. The flag is intended for splitting the
screen into two halves with preview popup occupying the other half.
</p>
<ul><li> <span class="plainlinks"><code>EExcludeFrames</code> </span> can be used in conjunction with
</li></ul>
<p>the <span class="plainlinks"><code>EFixedMode</code> </span> flag. When both of them are set, the
preview popup uses the default size defined in the layout data, as
with only the <span class="plainlinks"><code>EFixedMode</code> </span> flag, but the areas reserved
for the popup heading and frames are subtracted from the size of the
popup content. This flag has no effect, when the <span class="plainlinks"><code>EFixedMode</code> </span> flag is not set.
</p><p>The preview popup itself is responsible for providing the frame
for the popup, but the content of the popup has to be provided by
the client application. The content must be implemented as a class,
which is derived from <span class="plainlinks"><code>CCoeControl</code> </span>, and an instance
of that class must be given to the constructor of the popup's controller.
</p><p>There are few important issues when implementing the content of
a preview popup.
</p>
<ul><li> In default mode, the content defines the size for the whole preview
</li></ul>
<p>popup; the size of the popup is equal to the size of the content combined
with the space reserved for the frames and optional heading pane.
Preview popup uses the content's <span class="plainlinks"><code><font color="darkred">MinimumSize()</font></code> </span> method
for determining the size of the content, thus, the method must be
implemented properly.
</p>
<ul><li> In fixed mode, the preview popup uses the size and position defined
</li></ul>
<p>in the layout data, and the same size is also set for the content
without reserving any space for its frames or optional heading text.
</p>
<ul><li> Component controls of the content class must always be positioned
</li></ul>
<p>relative to the content's rectangle, returned by the <span class="plainlinks"><code><font color="darkred">Rect()</font></code> </span> method, because the content does not own the whole window. This
should also be taken into account when drawing the content, for example,
by setting correct clipping rectangle, so that the drawing is not
done over the popup frame or heading.
</p>
<ul><li> The content cannot receive any key events since the preview popup
</li></ul>
<p>cannot gain focus. Pen events are mediated normally to the <span class="plainlinks"><code><font color="darkred">HandlePointerEventL()</font></code> </span> method.
</p>
<ul><li> The preview popup elects to be a background drawer of the popup
</li></ul>
<p>content, which means that the content is not responsible for drawing
the background and should only draw the content, for example, text
and icons, over the already drawn background
</p><p>The following subsections describe how the content can be build
either synchronously or asynchronously.
</p>
<a name="Synchronous_content_building"><h4> <span class="mw-headline">2.1.1 Synchronous content building </span></h4>
</a><p>The sequence diagram for constructing the preview popup controller
with synchronous content building is illustrated in [Information_Preview_Popup_API_Specification.topic3.1.1_fig3 Figure 3] below.
</p>
<div style="text-align:center"><a class="image" href="images/SPB_10_1_Information_Preview_Popup_API_Create_Popup_Basic_Flow.png" title="Creating preview popup"><img alt="Creating preview popup" border="0" height="181" src="images/SPB_10_1_Information_Preview_Popup_API_Create_Popup_Basic_Flow.png" width="444" /></a></div>
<div style="text-align:center"><i>Creating preview popup</i></div>
<p>Note that the constructor takes only reference to the popup content
and the ownership of this content is not passed to the controller.
Thus, the client application is responsible for deleting the content
after the controller has been deleted.
</p>
<a name="Asynchronous_content_building"><h4> <span class="mw-headline">2.1.2 Asynchronous content building </span></h4>
</a><p>The sequence diagram for constructing the preview popup controller
with asynchronous content building is illustrated in [Information_Preview_Popup_API_Specification.topic3.1.2_fig4 Figure 4] below.
</p>
<div style="text-align:center"><a class="image" href="images/SPB_10_1_Information_Preview_Popup_API_Create_Popup_Alternate_Flow.png" title="Creating preview popup with asynchronous content provider"><img alt="Creating preview popup with asynchronous content provider" border="0" height="238" src="images/SPB_10_1_Information_Preview_Popup_API_Create_Popup_Alternate_Flow.png" width="642" /></a></div>
<div style="text-align:center"><i>Creating preview popup with asynchronous content provider</i></div>
<p>Although the application specific content class has to be provided
to the controller also with asynchronous content building, the content
does not have to complete until the preview popup is displayed. The
client application will receive request through the <span class="plainlinks"><code>MAknPreviewPopUpContentProvider</code> </span> interface to build the content before the popup is displayed. The
realization for this interface has to be given to the constructor
as well.
</p>
<a name="Setting_properties"><h4> <span class="mw-headline">2.1.3 Setting properties </span></h4>
</a><p>After the instance of the <span class="plainlinks"><code>CAknPreviewPopUpController</code> </span> class has been successfully constructed, the client application
can add observers for the popup and change its default properties.
An example of this is illustrated in [Information_Preview_Popup_API_Specification.topic3.1.3_fig5 Figure 5].
</p>
<div style="text-align:center"><a class="image" href="images/SPB_10_1_Information_Preview_Popup_API_Set_Properties.png" title="Changing popup properties"><img alt="Changing popup properties" border="0" height="292" src="images/SPB_10_1_Information_Preview_Popup_API_Set_Properties.png" width="619" /></a></div>
<div style="text-align:center"><i>Changing popup properties</i></div>
<p>In order to receive notifications of changes in the visibility
of the popup, the client application can provide realizations for
the <span class="plainlinks"><code>MAknPreviewPopUpObserver</code> </span> interface, and register
those to the preview popup controller with the <span class="plainlinks"><code>CAknPreviewPopUpController::AddObserverL()</code> </span> method. The number of registered observers is not restricted. Registered
observers can later be removed with the <span class="plainlinks"><code>CAknPreviewPopUpController::RemoveObserver()</code> </span> method.
</p><p>The show and hide delays can be changed from the default with <span class="plainlinks"><code>CAknPreviewPopUpController::SetPopUpShowDelay()</code> </span> and <span class="plainlinks"><code>CAknPreviewPopUpController::SetPopUpHideDelay()</code> </span> methods.
The show delay is the time interval between the request to display
the popup and the moment when the popup is actually displayed. The
hide delay is the time interval for how long the popup is displayed
unless hidden by key or pen event, or explicitly by the client application.
Setting hide delay for popup has no effect, if the popup is used in
permanent mode. Default values for show and hide delays are 0.1 and
10 seconds respectively. If hide delay is set to zero, no timeout
for hiding the popup is used.
</p><p>By default, preview popup's heading pane is hidden, and it is shown
when heading text is provided with the <span class="plainlinks"><code>CAknPreviewPopUpController::SetHeadingTextL()</code> </span> method. The heading text can later be changed with the same method,
and the heading pane can be hidden by replacing the heading text with <span class="plainlinks"><code>KNullDesC</code> </span>. Setting the heading text also shows the closing
button that resides in the same heading pane. The closing button is
suppressed if stylus is not supported by the currently active layout
or the popup is used in permanent mode.
</p>
<a name="Showing_popup"><h3> <span class="mw-headline">2.2 Showing popup </span></h3>
</a><p>Displaying a preview popup instance consists of setting up the
position for the popup and then requesting the popup controller to
show the popup after the previously specified delay.
</p><p>The position for the popup can be set through the controller using
two possible methods: <span class="plainlinks"><code><font color="darkred">SetPosition()</font></code> </span> and <span class="plainlinks"><code><font color="darkred">SetPositionByHighlight()</font></code> </span>. The first of these sets the top-right corner to the given coordinate
and, if necessary, moves the location to make the popup fully visible
when shown. The latter of these can be used, for example, in conjunction
with list or grids. The method requires the highlight rectangle of
currently focused list or grid item, which is used to position the
popup near the focused item. These methods have no effect in fixed
mode.
</p><p>After the location for the popup has been set, the client application
must request the controller to display the popup with the <span class="plainlinks"><code>CAknPreviewPopUpController::ShowPopUp()</code> </span> method. The sequence
for this is shown in [Information_Preview_Popup_API_Specification.topic3.2_fig6 Figure 6]. The <span class="plainlinks"><code><font color="darkred">ShowPopUp()</font></code> </span> call starts the timer and
returns to the caller. When the timer expires, it first initiates
the asynchronous content building, if such is used, and when the content
provider signals that the content for the popup has been build, the
popup is set visible. The controller notifies all the registered observers
of the event by calling the <span class="plainlinks"><code>MAknPreviewPopUpObserver::HandlePreviewPopUpEventL()</code> </span> method with <span class="plainlinks"><code>MAknPreviewPopUpObserver::EPreviewPopUpShown</code> </span> as the event.
</p><p>After the preview popup is shown, the controller starts the timer
to count the hide delay. When the timer expires again, the controller
hides the visible popup, and notifies the registered observers, this
time with the <span class="plainlinks"><code>MAknPreviewPopUpObserver::EPreviewPopUpHidden</code> </span> event.
</p>
<div style="text-align:center"><a class="image" href="images/SPB_10_1_Information_Preview_Popup_API_Show_Popup.png" title="Showing popup using asynchronous content"><img alt="Showing popup using asynchronous content" border="0" height="444" src="images/SPB_10_1_Information_Preview_Popup_API_Show_Popup.png" width="716" /></a></div>
<div style="text-align:center"><i>Showing popup using asynchronous content</i></div>
<p>The sequence for showing a popup without asynchronous content building
would otherwise be similar to this sequence, but with synchronous
content building the popup is shown right after the show delay without
content building request.
</p>
<a name="Hiding_popup"><h3> <span class="mw-headline">2.3 Hiding popup </span></h3>
</a><p>Unless the preview popup is in permanent mode, it is dismissed
after the specified popup hide delay, or when the user dismisses it
with key event or with pen event outside of the popup. Note also that,
if the user is keeping the pen pressed over the popup when the hide
timer expires, the popup is not hidden before the user releases the
pen from the screen.
</p><p>A visible popup can be hidden immediately by calling the function <span class="plainlinks"><code>CAknPreviewPopUpController::HidePopUp()</code> </span>.
</p><p>Whenever the preview popup is hidden, all of its observers are
notified of the event.
</p>
<a name="Deleting_popup"><h3> <span class="mw-headline">2.4 Deleting popup </span></h3>
</a><p>After the preview popup is no longer needed, the client can delete
the <span class="plainlinks"><code>CAknPreviewPopUpController</code> </span> instance. Note that
neither the content, content provider, nor the observers are owned
by the controller, so they are not automatically deleted.
</p>
<a name="Error_handling"><h3> <span class="mw-headline">2.5 Error handling </span></h3>
</a><p>The leave mechanism of Symbian OS environment is used to handle
memory exhaustion.
</p>
<div class="copy"><?php include ("copy.html"); ??></div></div></div><?php include (ROOT."/nokiaglobal/footer.php"); ??></body>
<!-- Mirrored from devlib.symbian.slions.net/belle/GUID-1A9B515C-C20F-4EC7-B62A-223B219BBC4E/sf_mw_classicui_classicui_pub_information_preview_popup_api.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 04:10:52 GMT -->
</html>