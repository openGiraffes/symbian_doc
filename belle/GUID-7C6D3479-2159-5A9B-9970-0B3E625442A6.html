
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<!-- Mirrored from devlib.symbian.slions.net/belle/GUID-7C6D3479-2159-5A9B-9970-0B3E625442A6.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 03:57:00 GMT -->
<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="copyright" content="(C) Copyright 2012" /><meta name="DC.rights.owner" content="(C) Copyright 2012" /><meta name="DC.Type" content="concept" /><meta name="DC.Title" content="Using Environment Change Notifier" /><meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7" /><meta name="DC.Relation" scheme="URI" content="GUID-5072BE46-B1B4-5C3A-BF55-BEA7443E7657" /><meta name="DC.Relation" scheme="URI" content="GUID-324107D1-6E0B-56DD-BDC0-7296F688A9CF" /><meta name="DC.Relation" scheme="URI" content="GUID-D02B5AF1-B1C3-560D-9654-971A5CC1A904" /><meta name="DC.Relation" scheme="URI" content="GUID-C8BD333E-8384-534B-822B-F61B2F7C8B9F" /><meta name="DC.Relation" scheme="URI" content="GUID-85AA0FD4-3BD1-50A7-B241-AE3908ACCF30" /><meta name="DC.Format" content="XHTML" /><meta name="DC.Identifier" content="GUID-7C6D3479-2159-5A9B-9970-0B3E625442A6" /><meta name="DC.Language" content="en" /><title>Using Environment Change Notifier </title><link href="css/s60/style.css" rel="stylesheet" type="text/css" /><link href="PLUGINS_ROOT/com.nokia.forum.library/css/category_cpp5.html" rel="stylesheet" type="text/css" /></head><body><div class="body"><div class="contentLeft prTxt"><h1 class="pageHeading" id="GUID-7C6D3479-2159-5A9B-9970-0B3E625442A6">Using Environment Change Notifier</h1><div><p>Environment Change Notifier is provided so that an application can be notified of changes in the environment such as a switch in locale, crossing over past midnight and so on. </p> <p>The <code class="codeph">TChanges</code> enumerator lists the possible events. This set of events may be extended as the operating system evolves. </p> <div><h3 class="section-title">Introduction</h3> <p>An environment change notifier is an instance of a <code class="codeph">CEnvironmentChangeNotifier</code> class. This is an active object which allows an application to respond to change events easily. These change events are generated by a kernel side change notifier service. The <code class="codeph">CEnvironmentChangeNotifier</code> class uses the kernel side change notifier service through an <code class="codeph">RChangeNotifier</code> handle. </p> <p>An application supplies a callback function to <code class="codeph">CEnvironmentChangeNotifier</code> when it is constructed. </p> <p>When an outstanding request for change events completes, <code class="codeph">CEnvironmentChangeNotifier</code> issues another request for change events before calling the callback function (encapsulated in a <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-6C5766BC-05DE-32A8-993D-6BB582931F43.html#GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-6C5766BC-05DE-32A8-993D-6BB582931F43.html"><code class="apiname">TCallBack</code></a>). </p> <p>The implementation of the callback function depends on the application but, typically, it would flag the required changes and schedule other changes either to the application's engine or the application's user interface. </p> <p>Programs can use Environment Change Notifier to request for notifications for the following changes: </p> <ul><li id="GUID-616002CB-557F-5BCB-850A-811856CBDDE9"><a name="GUID-616002CB-557F-5BCB-850A-811856CBDDE9"><!-- --></a><p>change of system locale </p> </li> <li id="GUID-6B8DDABD-3B12-5997-BA5F-D24A26ACFFF4"><a name="GUID-6B8DDABD-3B12-5997-BA5F-D24A26ACFFF4"><!-- --></a><p>system time passes midnight </p> </li> <li id="GUID-252E53D1-CDD4-5CA3-9F38-79E7495D9BEA"><a name="GUID-252E53D1-CDD4-5CA3-9F38-79E7495D9BEA"><!-- --></a><p>system time changes </p> </li> <li id="GUID-DB191A3A-3D2F-57A3-B1BC-320CB6F58F17"><a name="GUID-DB191A3A-3D2F-57A3-B1BC-320CB6F58F17"><!-- --></a><p>any thread dies </p> </li> <li id="GUID-7BE23762-BB35-5D37-A561-B248787F2071"><a name="GUID-7BE23762-BB35-5D37-A561-B248787F2071"><!-- --></a><p>status of the power supply changes </p> </li> </ul> </div> <div><h3 class="section-title">Procedure</h3> <p>To use the Environment Change Notifier, an application must perform the following: </p> <ol id="GUID-A6041480-76EA-59AE-A187-65175B244E65"><li id="GUID-6985BDF3-997C-57FF-832E-32731948C240"><a name="GUID-6985BDF3-997C-57FF-832E-32731948C240"><!-- --></a><p>Implement a callback function to handle the environment change. </p> <pre class="codeblock"> 
TInt CExHandleNotification::ChangeLangSettings()
    {
     //Code for changing the language settings.
    }
</pre> </li> <li id="GUID-498A463D-4CD3-5CEC-85E6-A7087E517BE9"><a name="GUID-498A463D-4CD3-5CEC-85E6-A7087E517BE9"><!-- --></a><p>Construct a <code class="codeph">CEnvironmentChangeNotifier</code> object using its <code class="codeph">NewL()</code> function, specifying the active object priority and a pointer to the callback function encapsulated in a <code class="codeph">TCallBack</code> object. </p> <p> <code class="codeph">NewL()</code> also adds this <code class="codeph">CEnvironmentChangeNotifier</code> active object to the current <em>active scheduler</em>. </p> <pre class="codeblock">
CExHandleNotification::Initialise()
                {
    //Creating a notifier object with ChangeLangSettings as the callback function.
                CEnvironmentChangeNotifier envNotifier = CEnvironmentChangeNotifier::NewL( EActivePriorityDefault,TCallBack(CExHandleNotification::ChangeLangSettings, this) );
                }</pre> </li> <li id="GUID-3E7AA7CA-F7A0-5D63-83A2-6A9DFEF7958A"><a name="GUID-3E7AA7CA-F7A0-5D63-83A2-6A9DFEF7958A"><!-- --></a><p>Issue a request for change events by calling the <code class="codeph">Start()</code> member function. </p> </li> </ol> <p>Whenever a request completes, <code class="codeph">CEnvironmentChangeNotifier</code> issues another request for change events before the callback function is invoked. </p> <p>The first call to the callback function occurs immediately after the first call to <code class="codeph">Start()</code>. This is because of the way the underlying change notifier service is implemented; the changes reported are those defined by the <code class="codeph">TChanges</code> enum. </p> <p>To stop the environment change notifier, an application must: </p> <ol id="GUID-3859F4AA-A656-5486-91C6-BE8F29FF9C0B"><li id="GUID-4B8C6E17-B904-5A8D-BB1C-3794664BB6B3"><a name="GUID-4B8C6E17-B904-5A8D-BB1C-3794664BB6B3"><!-- --></a><p>Call <code class="codeph">CEnvironmentChangeNotifier</code>'s <code class="codeph">Cancel()</code> function. Note that this is a member of the <code class="codeph">CActive</code> base class. </p> </li> <li id="GUID-11F57FDC-E773-551C-A0A9-79AAE8AC61BD"><a name="GUID-11F57FDC-E773-551C-A0A9-79AAE8AC61BD"><!-- --></a><p>Delete the <code class="codeph">CEnvironmentChangeNotifier</code> object. </p> </li> </ol> </div> </div></div></div><div class="footer"><p class="metadata">Last updated October 9th, 2009</p><hr /><div class="copy">Â© Nokia 2012.</div></div></body>
<!-- Mirrored from devlib.symbian.slions.net/belle/GUID-7C6D3479-2159-5A9B-9970-0B3E625442A6.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 03:57:00 GMT -->
</html>