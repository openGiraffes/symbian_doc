<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<!-- Mirrored from devlib.symbian.slions.net/belle/GUID-6013A680-57F9-415B-8851-C4FA63356636/4_2src_2libvorbis_2doc_2stereo_8html_source.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 08:17:59 GMT -->
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Example Code: examples/SFExamples/oggvorbiscodec94/src/libvorbis/doc/stereo.html Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.2 -->
<h1>examples/SFExamples/oggvorbiscodec94/src/libvorbis/doc/stereo.html</h1><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;!DOCTYPE html PUBLIC <span class="stringliteral">&quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot;</span> <span class="stringliteral">&quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;</span>&gt;
<a name="l00002"></a>00002 &lt;html&gt;
<a name="l00003"></a>00003 &lt;head&gt;
<a name="l00004"></a>00004 
<a name="l00005"></a>00005 &lt;meta http-equiv=<span class="stringliteral">&quot;Content-Type&quot;</span> content=<span class="stringliteral">&quot;text/html; charset=iso-8859-15&quot;</span>/&gt;
<a name="l00006"></a>00006 &lt;title&gt;Ogg Vorbis Documentation&lt;/title&gt;
<a name="l00007"></a>00007 
<a name="l00008"></a>00008 &lt;style type=<span class="stringliteral">&quot;text/css&quot;</span>&gt;
<a name="l00009"></a>00009 body {
<a name="l00010"></a>00010   margin: 0 18px 0 18px;
<a name="l00011"></a>00011   padding-bottom: 30px;
<a name="l00012"></a>00012   font-family: Verdana, Arial, Helvetica, sans-serif;
<a name="l00013"></a>00013   color: #333333;
<a name="l00014"></a>00014   font-size: .8em;
<a name="l00015"></a>00015 }
<a name="l00016"></a>00016 
<a name="l00017"></a>00017 a {
<a name="l00018"></a>00018   color: #3366cc;
<a name="l00019"></a>00019 }
<a name="l00020"></a>00020 
<a name="l00021"></a>00021 img {
<a name="l00022"></a>00022   border: 0;
<a name="l00023"></a>00023 }
<a name="l00024"></a>00024 
<a name="l00025"></a>00025 <span class="preprocessor">#xiphlogo {</span>
<a name="l00026"></a>00026 <span class="preprocessor"></span>  margin: 30px 0 16px 0;
<a name="l00027"></a>00027 }
<a name="l00028"></a>00028 
<a name="l00029"></a>00029 <span class="preprocessor">#content p {</span>
<a name="l00030"></a>00030 <span class="preprocessor"></span>  line-height: 1.4;
<a name="l00031"></a>00031 }
<a name="l00032"></a>00032 
<a name="l00033"></a>00033 h1, h1 a, h2, h2 a, h3, h3 a, h4, h4 a {
<a name="l00034"></a>00034   font-weight: bold;
<a name="l00035"></a>00035   color: #ff9900;
<a name="l00036"></a>00036   margin: 1.3em 0 8px 0;
<a name="l00037"></a>00037 }
<a name="l00038"></a>00038 
<a name="l00039"></a>00039 h1 {
<a name="l00040"></a>00040   font-size: 1.3em;
<a name="l00041"></a>00041 }
<a name="l00042"></a>00042 
<a name="l00043"></a>00043 h2 {
<a name="l00044"></a>00044   font-size: 1.2em;
<a name="l00045"></a>00045 }
<a name="l00046"></a>00046 
<a name="l00047"></a>00047 h3 {
<a name="l00048"></a>00048   font-size: 1.1em;
<a name="l00049"></a>00049 }
<a name="l00050"></a>00050 
<a name="l00051"></a>00051 li {
<a name="l00052"></a>00052   line-height: 1.4;
<a name="l00053"></a>00053 }
<a name="l00054"></a>00054 
<a name="l00055"></a>00055 <span class="preprocessor">#copyright {</span>
<a name="l00056"></a>00056 <span class="preprocessor"></span>  margin-top: 30px;
<a name="l00057"></a>00057   line-height: 1.5em;
<a name="l00058"></a>00058   text-align: center;
<a name="l00059"></a>00059   font-size: .8em;
<a name="l00060"></a>00060   color: #888888;
<a name="l00061"></a>00061   clear: both;
<a name="l00062"></a>00062 }
<a name="l00063"></a>00063 &lt;/style&gt;
<a name="l00064"></a>00064 
<a name="l00065"></a>00065 &lt;/head&gt;
<a name="l00066"></a>00066 
<a name="l00067"></a>00067 &lt;body&gt;
<a name="l00068"></a>00068 
<a name="l00069"></a>00069 &lt;div <span class="keywordtype">id</span>=<span class="stringliteral">&quot;xiphlogo&quot;</span>&gt;
<a name="l00070"></a>00070   &lt;a href=<span class="stringliteral">&quot;http://www.xiph.org/&quot;</span>&gt;&lt;img src=<span class="stringliteral">&quot;fish_xiph_org.png&quot;</span> alt=<span class="stringliteral">&quot;Fish Logo and Xiph.org&quot;</span>/&gt;&lt;/a&gt;
<a name="l00071"></a>00071 &lt;/div&gt;
<a name="l00072"></a>00072 
<a name="l00073"></a>00073 &lt;h1&gt;Ogg Vorbis stereo-specific channel coupling discussion&lt;/h1&gt;
<a name="l00074"></a>00074 
<a name="l00075"></a>00075 &lt;h2&gt;Abstract&lt;/h2&gt;
<a name="l00076"></a>00076 
<a name="l00077"></a>00077 &lt;p&gt;The Vorbis audio CODEC provides a channel coupling
<a name="l00078"></a>00078 mechanisms designed to reduce effective bitrate by both eliminating
<a name="l00079"></a>00079 interchannel redundancy and eliminating stereo image information
<a name="l00080"></a>00080 labeled inaudible or undesirable according to spatial psychoacoustic
<a name="l00081"></a>00081 models. This document describes both the mechanical coupling
<a name="l00082"></a>00082 mechanisms available within the Vorbis specification, as well as the
<a name="l00083"></a>00083 specific stereo coupling models used by the reference
<a name="l00084"></a>00084 &lt;tt&gt;libvorbis&lt;/tt&gt; codec provided by xiph.org.&lt;/p&gt;
<a name="l00085"></a>00085 
<a name="l00086"></a>00086 &lt;h2&gt;Mechanisms&lt;/h2&gt;
<a name="l00087"></a>00087 
<a name="l00088"></a>00088 &lt;p&gt;In encoder release beta 4 and earlier, Vorbis supported multiple
<a name="l00089"></a>00089 channel encoding, but the channels were encoded entirely separately
<a name="l00090"></a>00090 with no cross-analysis or redundancy elimination between channels.
<a name="l00091"></a>00091 This multichannel strategy is very similar to the mp3<span class="stringliteral">&#39;s &lt;em&gt;dual</span>
<a name="l00092"></a>00092 <span class="stringliteral">stereo&lt;/em&gt; mode and Vorbis uses the same name for its analogous</span>
<a name="l00093"></a>00093 <span class="stringliteral">uncoupled multichannel modes.&lt;/p&gt;</span>
<a name="l00094"></a>00094 <span class="stringliteral"></span>
<a name="l00095"></a>00095 <span class="stringliteral">&lt;p&gt;However, the Vorbis spec provides for, and Vorbis release 1.0 rc1 and</span>
<a name="l00096"></a>00096 <span class="stringliteral">later implement a coupled channel strategy. Vorbis has two specific</span>
<a name="l00097"></a>00097 <span class="stringliteral">mechanisms that may be used alone or in conjunction to implement</span>
<a name="l00098"></a>00098 <span class="stringliteral">channel coupling. The first is &lt;em&gt;channel interleaving&lt;/em&gt; via</span>
<a name="l00099"></a>00099 <span class="stringliteral">residue backend type 2, and the second is &lt;em&gt;square polar</span>
<a name="l00100"></a>00100 <span class="stringliteral">mapping&lt;/em&gt;. These two general mechanisms are particularly well</span>
<a name="l00101"></a>00101 <span class="stringliteral">suited to coupling due to the structure of Vorbis encoding, as we&#39;</span>ll
<a name="l00102"></a>00102 explore below, and <span class="keyword">using</span> both we can implement both totally
<a name="l00103"></a>00103 &lt;em&gt;lossless stereo image coupling&lt;/em&gt; [bit-<span class="keywordflow">for</span>-bit decode-identical
<a name="l00104"></a>00104 to uncoupled modes], as well as various lossy models that seek to
<a name="l00105"></a>00105 eliminate inaudible or unimportant aspects of the stereo image in
<a name="l00106"></a>00106 order to enhance bitrate. The exact coupling implementation is
<a name="l00107"></a>00107 generalized to allow the encoder a great deal of flexibility in
<a name="l00108"></a>00108 implementation of a stereo or surround model without requiring any
<a name="l00109"></a>00109 significant complexity increase over the combinatorially simpler
<a name="l00110"></a>00110 mid/side joint stereo of mp3 and other current audio codecs.&lt;/p&gt;
<a name="l00111"></a>00111 
<a name="l00112"></a>00112 &lt;p&gt;A particular Vorbis bitstream may apply channel coupling directly to
<a name="l00113"></a>00113 more than a pair of channels; polar mapping is hierarchical such that
<a name="l00114"></a>00114 polar coupling may be extrapolated to an arbitrary number of channels
<a name="l00115"></a>00115 and is not restricted to only stereo, quadraphonics, ambisonics or 5.1
<a name="l00116"></a>00116 surround. However, the scope of <span class="keyword">this</span> document restricts itself to the
<a name="l00117"></a>00117 stereo coupling <span class="keywordflow">case</span>.&lt;/p&gt;
<a name="l00118"></a>00118 
<a name="l00119"></a>00119 &lt;h3&gt;Square Polar Mapping&lt;/h3&gt;
<a name="l00120"></a>00120 
<a name="l00121"></a>00121 &lt;h4&gt;maximal correlation&lt;/h4&gt;
<a name="l00122"></a>00122  
<a name="l00123"></a>00123 &lt;p&gt;Recall that the basic structure of a a Vorbis I stream first generates
<a name="l00124"></a>00124 from input audio a spectral <span class="stringliteral">&#39;floor&#39;</span> function that serves as an
<a name="l00125"></a>00125 MDCT-domain whitening filter. This floor is meant to represent the
<a name="l00126"></a>00126 rough envelope of the frequency spectrum, <span class="keyword">using</span> whatever metric the
<a name="l00127"></a>00127 encoder cares to define. This floor is subtracted from the log
<a name="l00128"></a>00128 frequency spectrum, effectively normalizing the spectrum by frequency.
<a name="l00129"></a>00129 Each input channel is associated with a unique floor function.&lt;/p&gt;
<a name="l00130"></a>00130 
<a name="l00131"></a>00131 &lt;p&gt;The basic idea behind any stereo coupling is that the left and right
<a name="l00132"></a>00132 channels usually correlate. This correlation is even stronger <span class="keywordflow">if</span> one
<a name="l00133"></a>00133 first accounts <span class="keywordflow">for</span> energy differences in any given frequency band
<a name="l00134"></a>00134 across left and right; think <span class="keywordflow">for</span> example of individual instruments
<a name="l00135"></a>00135 mixed into different portions of the stereo image, or a stereo
<a name="l00136"></a>00136 recording with a dominant feature not perfectly in the center. The
<a name="l00137"></a>00137 floor functions, each specific to a channel, provide the perfect means
<a name="l00138"></a>00138 of normalizing left and right energies across the spectrum to maximize
<a name="l00139"></a>00139 correlation before coupling. This feature of the Vorbis format is not
<a name="l00140"></a>00140 a convenient accident.&lt;/p&gt;
<a name="l00141"></a>00141 
<a name="l00142"></a>00142 &lt;p&gt;Because we strive to maximally correlate the left and right channels
<a name="l00143"></a>00143 and generally succeed in doing so, left and right residue is typically
<a name="l00144"></a>00144 nearly identical. We could use channel interleaving (discussed below)
<a name="l00145"></a>00145 alone to efficiently <span class="keyword">remove</span> the redundancy between the left and right
<a name="l00146"></a>00146 channels as a side effect of entropy encoding, but a polar
<a name="l00147"></a>00147 representation gives benefits when left/right correlation is
<a name="l00148"></a>00148 strong.&lt;/p&gt;
<a name="l00149"></a>00149 
<a name="l00150"></a>00150 &lt;h4&gt;point and diffuse imaging&lt;/h4&gt;
<a name="l00151"></a>00151 
<a name="l00152"></a>00152 &lt;p&gt;The first advantage of a polar representation is that it effectively
<a name="l00153"></a>00153 separates the spatial audio information into a <span class="stringliteral">&#39;point image&#39;</span>
<a name="l00154"></a>00154 (magnitude) at a given frequency and located somewhere in the sound
<a name="l00155"></a>00155 field, and a <span class="stringliteral">&#39;diffuse image&#39;</span> (angle) that fills a large amount of
<a name="l00156"></a>00156 space simultaneously. Even if we preserve only the magnitude (point)
<a name="l00157"></a>00157 data, a detailed and carefully chosen floor function in each channel
<a name="l00158"></a>00158 provides us with a free, fine-grained, frequency relative intensity
<a name="l00159"></a>00159 stereo*. Angle information represents diffuse sound fields, such as
<a name="l00160"></a>00160 reverberation that fills the entire space simultaneously.&lt;/p&gt;
<a name="l00161"></a>00161 
<a name="l00162"></a>00162 &lt;p&gt;*&lt;em&gt;Because the Vorbis model supports a number of different possible
<a name="l00163"></a>00163 stereo models and these models may be mixed, we do not use the term
<a name="l00164"></a>00164 &#39;intensity stereo&#39; talking about Vorbis; instead we use the terms
<a name="l00165"></a>00165 &#39;point stereo&#39;, &#39;phase stereo&#39; and subcategories of each.&lt;/em&gt;&lt;/p&gt;
<a name="l00166"></a>00166 
<a name="l00167"></a>00167 &lt;p&gt;The majority of a stereo image is representable by polar magnitude
<a name="l00168"></a>00168 alone, as strong sounds tend to be produced at near-point sources;
<a name="l00169"></a>00169 even non-diffuse, fast, sharp echoes track very accurately using
<a name="l00170"></a>00170 magnitude representation almost alone (<a class="code" href="interfacefor.html">for</a> those experimenting with
<a name="l00171"></a>00171 Vorbis tuning, this strategy works much better with the precise,
<a name="l00172"></a>00172 piecewise control of floor 1; the continuous approximation of floor 0
<a name="l00173"></a>00173 results in unstable imaging). Reverberation and diffuse sounds tend
<a name="l00174"></a>00174 to contain less energy and be psychoacoustically dominated by the
<a name="l00175"></a>00175 point sources embedded in them. Thus, we again tend to concentrate
<a name="l00176"></a>00176 more represented energy into a predictably smaller number of numbers.
<a name="l00177"></a>00177 Separating representation of point and diffuse imaging also allows us
<a name="l00178"></a>00178 to model and manipulate point and diffuse qualities separately.&lt;/p&gt;
<a name="l00179"></a>00179 
<a name="l00180"></a>00180 &lt;h4&gt;controlling bit leakage and symbol crosstalk&lt;/h4&gt;
<a name="l00181"></a>00181 
<a name="l00182"></a>00182 &lt;p&gt;Because polar
<a name="l00183"></a>00183 representation concentrates represented energy into fewer large
<a name="l00184"></a>00184 values, we reduce bit &#39;leakage&#39; during cascading (multistage VQ
<a name="l00185"></a>00185 encoding) as a secondary benefit. A single large, monolithic VQ
<a name="l00186"></a>00186 <a class="code" href="structcodebook.html">codebook</a> is more efficient than a cascaded book due to entropy
<a name="l00187"></a>00187 &#39;crosstalk&#39; among symbols between different stages of a multistage cascade.
<a name="l00188"></a>00188 Polar representation is a way of further concentrating entropy into
<a name="l00189"></a>00189 predictable locations so that <a class="code" href="structcodebook.html">codebook</a> design can take steps to
<a name="l00190"></a>00190 improve multistage <a class="code" href="structcodebook.html">codebook</a> efficiency. It also allows us to cascade
<a name="l00191"></a>00191 various elements of the stereo image independently.&lt;/p&gt;
<a name="l00192"></a>00192 
<a name="l00193"></a>00193 &lt;h4&gt;eliminating trigonometry and rounding&lt;/h4&gt;
<a name="l00194"></a>00194 
<a name="l00195"></a>00195 &lt;p&gt;Rounding and computational complexity are potential problems with a
<a name="l00196"></a>00196 polar representation. As our encoding process involves quantization,
<a name="l00197"></a>00197 mixing a polar representation and quantization makes it potentially
<a name="l00198"></a>00198 impossible, depending on implementation, to construct a coupled stereo
<a name="l00199"></a>00199 mechanism that results in bit-identical decompressed output compared
<a name="l00200"></a>00200 to an uncoupled encoding should the encoder desire it.&lt;/p&gt;
<a name="l00201"></a>00201 
<a name="l00202"></a>00202 &lt;p&gt;Vorbis uses a mapping that preserves the most useful qualities of
<a name="l00203"></a>00203 polar representation, relies only on addition/subtraction (during
<a name="l00204"></a>00204 decode; high quality encoding still requires some trig), and makes it
<a name="l00205"></a>00205 trivial before or after quantization to represent an angle/magnitude
<a name="l00206"></a>00206 through a one-to-one mapping from possible left/right value
<a name="l00207"></a>00207 permutations. We do this by basing our polar representation on the
<a name="l00208"></a>00208 unit square rather than the unit-circle.&lt;/p&gt;
<a name="l00209"></a>00209 
<a name="l00210"></a>00210 &lt;p&gt;Given a magnitude and angle, we recover left and right using the
<a name="l00211"></a>00211 following function (note that A/B may be left/right or right/left
<a name="l00212"></a>00212 depending on the coupling definition used by the encoder):&lt;/p&gt;
<a name="l00213"></a>00213 
<a name="l00214"></a>00214 &lt;pre&gt;
<a name="l00215"></a>00215       if(magnitude&gt;0)
<a name="l00216"></a>00216         if(angle&gt;0){
<a name="l00217"></a>00217           A=magnitude;
<a name="l00218"></a>00218           B=magnitude-angle;
<a name="l00219"></a>00219         }<span class="keywordflow">else</span>{
<a name="l00220"></a>00220           B=magnitude;
<a name="l00221"></a>00221           A=magnitude+angle;
<a name="l00222"></a>00222         }
<a name="l00223"></a>00223       <span class="keywordflow">else</span>
<a name="l00224"></a>00224         <span class="keywordflow">if</span>(angle&gt;0){
<a name="l00225"></a>00225           A=magnitude;
<a name="l00226"></a>00226           B=magnitude+angle;
<a name="l00227"></a>00227         }<span class="keywordflow">else</span>{
<a name="l00228"></a>00228           B=magnitude;
<a name="l00229"></a>00229           A=magnitude-angle;
<a name="l00230"></a>00230         }
<a name="l00231"></a>00231     }
<a name="l00232"></a>00232 &lt;/pre&gt;
<a name="l00233"></a>00233 
<a name="l00234"></a>00234 &lt;p&gt;The function is antisymmetric <span class="keywordflow">for</span> positive and negative magnitudes in
<a name="l00235"></a>00235 order to eliminate a redundant value when quantizing. For example, <span class="keywordflow">if</span>
<a name="l00236"></a>00236 we<span class="stringliteral">&#39;re quantizing to integer values, we can visualize a magnitude of 5</span>
<a name="l00237"></a>00237 <span class="stringliteral">and an angle of -2 as follows:&lt;/p&gt;</span>
<a name="l00238"></a>00238 <span class="stringliteral"></span>
<a name="l00239"></a>00239 <span class="stringliteral">&lt;p&gt;&lt;img src=&quot;squarepolar.png&quot; alt=&quot;square polar&quot;/&gt;&lt;/p&gt;</span>
<a name="l00240"></a>00240 <span class="stringliteral"></span>
<a name="l00241"></a>00241 <span class="stringliteral">&lt;p&gt;This representation loses or replicates no values; if the range of A</span>
<a name="l00242"></a>00242 <span class="stringliteral">and B are integral -5 through 5, the number of possible Cartesian</span>
<a name="l00243"></a>00243 <span class="stringliteral">permutations is 121. Represented in square polar notation, the</span>
<a name="l00244"></a>00244 <span class="stringliteral">possible values are:&lt;/p&gt;</span>
<a name="l00245"></a>00245 <span class="stringliteral"></span>
<a name="l00246"></a>00246 <span class="stringliteral">&lt;pre&gt;</span>
<a name="l00247"></a>00247 <span class="stringliteral"> 0, 0</span>
<a name="l00248"></a>00248 <span class="stringliteral"></span>
<a name="l00249"></a>00249 <span class="stringliteral">-1,-2  -1,-1  -1, 0  -1, 1</span>
<a name="l00250"></a>00250 <span class="stringliteral"></span>
<a name="l00251"></a>00251 <span class="stringliteral"> 1,-2   1,-1   1, 0   1, 1</span>
<a name="l00252"></a>00252 <span class="stringliteral"></span>
<a name="l00253"></a>00253 <span class="stringliteral">-2,-4  -2,-3  -2,-2  -2,-1  -2, 0  -2, 1  -2, 2  -2, 3  </span>
<a name="l00254"></a>00254 <span class="stringliteral"></span>
<a name="l00255"></a>00255 <span class="stringliteral"> 2,-4   2,-3   ... following the pattern ...</span>
<a name="l00256"></a>00256 <span class="stringliteral"></span>
<a name="l00257"></a>00257 <span class="stringliteral"> ...   5, 1   5, 2   5, 3   5, 4   5, 5   5, 6   5, 7   5, 8   5, 9</span>
<a name="l00258"></a>00258 <span class="stringliteral"></span>
<a name="l00259"></a>00259 <span class="stringliteral">&lt;/pre&gt;</span>
<a name="l00260"></a>00260 <span class="stringliteral"></span>
<a name="l00261"></a>00261 <span class="stringliteral">&lt;p&gt;...for a grand total of 121 possible values, the same number as in</span>
<a name="l00262"></a>00262 <span class="stringliteral">Cartesian representation (note that, for example, &lt;tt&gt;5,-10&lt;/tt&gt; is</span>
<a name="l00263"></a>00263 <span class="stringliteral">the same as &lt;tt&gt;-5,10&lt;/tt&gt;, so there&#39;</span>s no reason to represent
<a name="l00264"></a>00264 both. 2,10 cannot happen, and there<span class="stringliteral">&#39;s no reason to account for it.)</span>
<a name="l00265"></a>00265 <span class="stringliteral">It&#39;</span>s also obvious that <span class="keyword">this</span> mapping is exactly reversible.&lt;/p&gt;
<a name="l00266"></a>00266 
<a name="l00267"></a>00267 &lt;h3&gt;Channel interleaving&lt;/h3&gt;
<a name="l00268"></a>00268 
<a name="l00269"></a>00269 &lt;p&gt;We can remap and A/B vector <span class="keyword">using</span> polar mapping into a magnitude/angle
<a name="l00270"></a>00270 vector, and it<span class="stringliteral">&#39;s clear that, in general, this concentrates energy in</span>
<a name="l00271"></a>00271 <span class="stringliteral">the magnitude vector and reduces the amount of information to encode</span>
<a name="l00272"></a>00272 <span class="stringliteral">in the angle vector. Encoding these vectors independently with</span>
<a name="l00273"></a>00273 <span class="stringliteral">residue backend #0 or residue backend #1 will result in bitrate</span>
<a name="l00274"></a>00274 <span class="stringliteral">savings. However, there are still implicit correlations between the</span>
<a name="l00275"></a>00275 <span class="stringliteral">magnitude and angle vectors. The most obvious is that the amplitude</span>
<a name="l00276"></a>00276 <span class="stringliteral">of the angle is bounded by its corresponding magnitude value.&lt;/p&gt;</span>
<a name="l00277"></a>00277 <span class="stringliteral"></span>
<a name="l00278"></a>00278 <span class="stringliteral">&lt;p&gt;Entropy coding the results, then, further benefits from the entropy</span>
<a name="l00279"></a>00279 <span class="stringliteral">model being able to compress magnitude and angle simultaneously. For</span>
<a name="l00280"></a>00280 <span class="stringliteral">this reason, Vorbis implements residue backend #2 which pre-interleaves</span>
<a name="l00281"></a>00281 <span class="stringliteral">a number of input vectors (in the stereo case, two, A and B) into a</span>
<a name="l00282"></a>00282 <span class="stringliteral">single output vector (with the elements in the order of</span>
<a name="l00283"></a>00283 <span class="stringliteral">A_0, B_0, A_1, B_1, A_2 ... A_n-1, B_n-1) before entropy encoding. Thus</span>
<a name="l00284"></a>00284 <span class="stringliteral">each vector to be coded by the vector quantization backend consists of</span>
<a name="l00285"></a>00285 <span class="stringliteral">matching magnitude and angle values.&lt;/p&gt;</span>
<a name="l00286"></a>00286 <span class="stringliteral"></span>
<a name="l00287"></a>00287 <span class="stringliteral">&lt;p&gt;The astute reader, at this point, will notice that in the theoretical</span>
<a name="l00288"></a>00288 <span class="stringliteral">case in which we can use monolithic codebooks of arbitrarily large</span>
<a name="l00289"></a>00289 <span class="stringliteral">size, we can directly interleave and encode left and right without</span>
<a name="l00290"></a>00290 <span class="stringliteral">polar mapping; in fact, the polar mapping does not appear to lend any</span>
<a name="l00291"></a>00291 <span class="stringliteral">benefit whatsoever to the efficiency of the entropy coding. In fact,</span>
<a name="l00292"></a>00292 <span class="stringliteral">it is perfectly possible and reasonable to build a Vorbis encoder that</span>
<a name="l00293"></a>00293 <span class="stringliteral">dispenses with polar mapping entirely and merely interleaves the</span>
<a name="l00294"></a>00294 <span class="stringliteral">channel. Libvorbis based encoders may configure such an encoding and</span>
<a name="l00295"></a>00295 <span class="stringliteral">it will work as intended.&lt;/p&gt;</span>
<a name="l00296"></a>00296 <span class="stringliteral"></span>
<a name="l00297"></a>00297 <span class="stringliteral">&lt;p&gt;However, when we leave the ideal/theoretical domain, we notice that</span>
<a name="l00298"></a>00298 <span class="stringliteral">polar mapping does give additional practical benefits, as discussed in</span>
<a name="l00299"></a>00299 <span class="stringliteral">the above section on polar mapping and summarized again here:&lt;/p&gt;</span>
<a name="l00300"></a>00300 <span class="stringliteral"></span>
<a name="l00301"></a>00301 <span class="stringliteral">&lt;ul&gt;</span>
<a name="l00302"></a>00302 <span class="stringliteral">&lt;li&gt;Polar mapping aids in controlling entropy &#39;</span>leakage<span class="stringliteral">&#39; between stages</span>
<a name="l00303"></a>00303 <span class="stringliteral">of a cascaded codebook.&lt;/li&gt;</span>
<a name="l00304"></a>00304 <span class="stringliteral">&lt;li&gt;Polar mapping separates the stereo image</span>
<a name="l00305"></a>00305 <span class="stringliteral">into point and diffuse components which may be analyzed and handled</span>
<a name="l00306"></a>00306 <span class="stringliteral">differently.&lt;/li&gt;</span>
<a name="l00307"></a>00307 <span class="stringliteral">&lt;/ul&gt;</span>
<a name="l00308"></a>00308 <span class="stringliteral"></span>
<a name="l00309"></a>00309 <span class="stringliteral">&lt;h2&gt;Stereo Models&lt;/h2&gt;</span>
<a name="l00310"></a>00310 <span class="stringliteral"></span>
<a name="l00311"></a>00311 <span class="stringliteral">&lt;h3&gt;Dual Stereo&lt;/h3&gt;</span>
<a name="l00312"></a>00312 <span class="stringliteral"></span>
<a name="l00313"></a>00313 <span class="stringliteral">&lt;p&gt;Dual stereo refers to stereo encoding where the channels are entirely</span>
<a name="l00314"></a>00314 <span class="stringliteral">separate; they are analyzed and encoded as entirely distinct entities.</span>
<a name="l00315"></a>00315 <span class="stringliteral">This terminology is familiar from mp3.&lt;/p&gt;</span>
<a name="l00316"></a>00316 <span class="stringliteral"></span>
<a name="l00317"></a>00317 <span class="stringliteral">&lt;h3&gt;Lossless Stereo&lt;/h3&gt;</span>
<a name="l00318"></a>00318 <span class="stringliteral"></span>
<a name="l00319"></a>00319 <span class="stringliteral">&lt;p&gt;Using polar mapping and/or channel interleaving, it&#39;</span>s possible to
<a name="l00320"></a>00320 couple Vorbis channels losslessly, that is, construct a stereo
<a name="l00321"></a>00321 coupling encoding that both saves space but also decodes
<a name="l00322"></a>00322 bit-identically to dual stereo. OggEnc 1.0 and later uses <span class="keyword">this</span>
<a name="l00323"></a>00323 mode in all high-bitrate encoding.&lt;/p&gt;
<a name="l00324"></a>00324 
<a name="l00325"></a>00325 &lt;p&gt;Overall, <span class="keyword">this</span> stereo mode is overkill; however, it offers a safe
<a name="l00326"></a>00326 alternative to users concerned about the slightest possible
<a name="l00327"></a>00327 degradation to the stereo image or archival quality audio.&lt;/p&gt;
<a name="l00328"></a>00328 
<a name="l00329"></a>00329 &lt;h3&gt;Phase Stereo&lt;/h3&gt;
<a name="l00330"></a>00330 
<a name="l00331"></a>00331 &lt;p&gt;Phase stereo is the least aggressive means of gracefully dropping
<a name="l00332"></a>00332 resolution from the stereo image; it affects only diffuse imaging.&lt;/p&gt;
<a name="l00333"></a>00333 
<a name="l00334"></a>00334 &lt;p&gt;It<span class="stringliteral">&#39;s often quoted that the human ear is deaf to signal phase above</span>
<a name="l00335"></a>00335 <span class="stringliteral">about 4kHz; this is nearly true and a passable rule of thumb, but it</span>
<a name="l00336"></a>00336 <span class="stringliteral">can be demonstrated that even an average user can tell the difference</span>
<a name="l00337"></a>00337 <span class="stringliteral">between high frequency in-phase and out-of-phase noise. Obviously</span>
<a name="l00338"></a>00338 <span class="stringliteral">then, the statement is not entirely true. However, it&#39;</span>s also the <span class="keywordflow">case</span>
<a name="l00339"></a>00339 that one must resort to nearly such an extreme demonstration before
<a name="l00340"></a>00340 finding the counterexample.&lt;/p&gt;
<a name="l00341"></a>00341 
<a name="l00342"></a>00342 &lt;p&gt;<span class="stringliteral">&#39;Phase stereo&#39;</span> is simply a more aggressive quantization of the polar
<a name="l00343"></a>00343 angle vector; above 4kHz it<span class="stringliteral">&#39;s generally quite safe to quantize noise</span>
<a name="l00344"></a>00344 <span class="stringliteral">and noisy elements to only a handful of allowed phases, or to thin the</span>
<a name="l00345"></a>00345 <span class="stringliteral">phase with respect to the magnitude. The phases of high amplitude</span>
<a name="l00346"></a>00346 <span class="stringliteral">pure tones may or may not be preserved more carefully (they are</span>
<a name="l00347"></a>00347 <span class="stringliteral">relatively rare and L/R tend to be in phase, so there is generally</span>
<a name="l00348"></a>00348 <span class="stringliteral">little reason not to spend a few more bits on them)&lt;/p&gt;</span>
<a name="l00349"></a>00349 <span class="stringliteral"></span>
<a name="l00350"></a>00350 <span class="stringliteral">&lt;h4&gt;example: eight phase stereo&lt;/h4&gt;</span>
<a name="l00351"></a>00351 <span class="stringliteral"></span>
<a name="l00352"></a>00352 <span class="stringliteral">&lt;p&gt;Vorbis may implement phase stereo coupling by preserving the entirety</span>
<a name="l00353"></a>00353 <span class="stringliteral">of the magnitude vector (essential to fine amplitude and energy</span>
<a name="l00354"></a>00354 <span class="stringliteral">resolution overall) and quantizing the angle vector to one of only</span>
<a name="l00355"></a>00355 <span class="stringliteral">four possible values. Given that the magnitude vector may be positive</span>
<a name="l00356"></a>00356 <span class="stringliteral">or negative, this results in left and right phase having eight</span>
<a name="l00357"></a>00357 <span class="stringliteral">possible permutation, thus &#39;</span>eight phase stereo<span class="stringliteral">&#39;:&lt;/p&gt;</span>
<a name="l00358"></a>00358 <span class="stringliteral"></span>
<a name="l00359"></a>00359 <span class="stringliteral">&lt;p&gt;&lt;img src=&quot;eightphase.png&quot; alt=&quot;eight phase&quot;/&gt;&lt;/p&gt;</span>
<a name="l00360"></a>00360 <span class="stringliteral"></span>
<a name="l00361"></a>00361 <span class="stringliteral">&lt;p&gt;Left and right may be in phase (positive or negative), the most common</span>
<a name="l00362"></a>00362 <span class="stringliteral">case by far, or out of phase by 90 or 180 degrees.&lt;/p&gt;</span>
<a name="l00363"></a>00363 <span class="stringliteral"></span>
<a name="l00364"></a>00364 <span class="stringliteral">&lt;h4&gt;example: four phase stereo&lt;/h4&gt;</span>
<a name="l00365"></a>00365 <span class="stringliteral"></span>
<a name="l00366"></a>00366 <span class="stringliteral">&lt;p&gt;Similarly, four phase stereo takes the quantization one step further;</span>
<a name="l00367"></a>00367 <span class="stringliteral">it allows only in-phase and 180 degree out-out-phase signals:&lt;/p&gt;</span>
<a name="l00368"></a>00368 <span class="stringliteral"></span>
<a name="l00369"></a>00369 <span class="stringliteral">&lt;p&gt;&lt;img src=&quot;fourphase.png&quot; alt=&quot;four phase&quot;/&gt;&lt;/p&gt;</span>
<a name="l00370"></a>00370 <span class="stringliteral"></span>
<a name="l00371"></a>00371 <span class="stringliteral">&lt;h3&gt;example: point stereo&lt;/h3&gt;</span>
<a name="l00372"></a>00372 <span class="stringliteral"></span>
<a name="l00373"></a>00373 <span class="stringliteral">&lt;p&gt;Point stereo eliminates the possibility of out-of-phase signal</span>
<a name="l00374"></a>00374 <span class="stringliteral">entirely. Any diffuse quality to a sound source tends to collapse</span>
<a name="l00375"></a>00375 <span class="stringliteral">inward to a point somewhere within the stereo image. A practical</span>
<a name="l00376"></a>00376 <span class="stringliteral">example would be balanced reverberations within a large, live space;</span>
<a name="l00377"></a>00377 <span class="stringliteral">normally the sound is diffuse and soft, giving a sonic impression of</span>
<a name="l00378"></a>00378 <span class="stringliteral">volume. In point-stereo, the reverberations would still exist, but</span>
<a name="l00379"></a>00379 <span class="stringliteral">sound fairly firmly centered within the image (assuming the</span>
<a name="l00380"></a>00380 <span class="stringliteral">reverberation was centered overall; if the reverberation is stronger</span>
<a name="l00381"></a>00381 <span class="stringliteral">to the left, then the point of localization in point stereo would be</span>
<a name="l00382"></a>00382 <span class="stringliteral">to the left). This effect is most noticeable at low and mid</span>
<a name="l00383"></a>00383 <span class="stringliteral">frequencies and using headphones (which grant perfect stereo</span>
<a name="l00384"></a>00384 <span class="stringliteral">separation). Point stereo is is a graceful but generally easy to</span>
<a name="l00385"></a>00385 <span class="stringliteral">detect degradation to the sound quality and is thus used in frequency</span>
<a name="l00386"></a>00386 <span class="stringliteral">ranges where it is least noticeable.&lt;/p&gt;</span>
<a name="l00387"></a>00387 <span class="stringliteral"></span>
<a name="l00388"></a>00388 <span class="stringliteral">&lt;h3&gt;Mixed Stereo&lt;/h3&gt;</span>
<a name="l00389"></a>00389 <span class="stringliteral"></span>
<a name="l00390"></a>00390 <span class="stringliteral">&lt;p&gt;Mixed stereo is the simultaneous use of more than one of the above</span>
<a name="l00391"></a>00391 <span class="stringliteral">stereo encoding models, generally using more aggressive modes in</span>
<a name="l00392"></a>00392 <span class="stringliteral">higher frequencies, lower amplitudes or &#39;</span>nearly<span class="stringliteral">&#39; in-phase sound.&lt;/p&gt;</span>
<a name="l00393"></a>00393 <span class="stringliteral"></span>
<a name="l00394"></a>00394 <span class="stringliteral">&lt;p&gt;It is also the case that near-DC frequencies should be encoded using</span>
<a name="l00395"></a>00395 <span class="stringliteral">lossless coupling to avoid frame blocking artifacts.&lt;/p&gt;</span>
<a name="l00396"></a>00396 <span class="stringliteral"></span>
<a name="l00397"></a>00397 <span class="stringliteral">&lt;h3&gt;Vorbis Stereo Modes&lt;/h3&gt;</span>
<a name="l00398"></a>00398 <span class="stringliteral"></span>
<a name="l00399"></a>00399 <span class="stringliteral">&lt;p&gt;Vorbis, as of 1.0, uses lossless stereo and a number of mixed modes</span>
<a name="l00400"></a>00400 <span class="stringliteral">constructed out of lossless and point stereo. Phase stereo was used</span>
<a name="l00401"></a>00401 <span class="stringliteral">in the rc2 encoder, but is not currently used for simplicity&#39;</span>s sake. It
<a name="l00402"></a>00402 will likely be re-added to the stereo model in the future.&lt;/p&gt;
<a name="l00403"></a>00403 
<a name="l00404"></a>00404 &lt;div <span class="keywordtype">id</span>=<span class="stringliteral">&quot;copyright&quot;</span>&gt;
<a name="l00405"></a>00405   The Xiph Fish Logo is a
<a name="l00406"></a>00406   trademark (&amp;trade;) of Xiph.Org.&lt;br/&gt;
<a name="l00407"></a>00407 
<a name="l00408"></a>00408   These pages &amp;copy; 1994 - 2005 Xiph.Org. All rights reserved.
<a name="l00409"></a>00409 &lt;/div&gt;
<a name="l00410"></a>00410 
<a name="l00411"></a>00411 &lt;/body&gt;
<a name="l00412"></a>00412 &lt;/html&gt;
<a name="l00413"></a>00413 
<a name="l00414"></a>00414 
<a name="l00415"></a>00415 
<a name="l00416"></a>00416 
<a name="l00417"></a>00417 
<a name="l00418"></a>00418 
</pre></div>
<hr size="1"/><address style="text-align: right;"><small>Generated by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.2 </small></address>
</body>

<!-- Mirrored from devlib.symbian.slions.net/belle/GUID-6013A680-57F9-415B-8851-C4FA63356636/4_2src_2libvorbis_2doc_2stereo_8html_source.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 08:17:59 GMT -->
</html>
