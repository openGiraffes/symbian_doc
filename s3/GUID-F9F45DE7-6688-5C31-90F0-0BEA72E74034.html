
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<!-- Mirrored from devlib.symbian.slions.net/s3/GUID-F9F45DE7-6688-5C31-90F0-0BEA72E74034.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 06:12:43 GMT -->
<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="copyright" content="(C) Copyright 2011" /><meta name="DC.rights.owner" content="(C) Copyright 2011" /><meta name="DC.Type" content="concept" /><meta name="DC.Title" content="Creating Email Messages in Rich Text Format" /><meta name="abstract" content="This tutorial explains how to store the email message data in rich text format. Storing email messages in rich text format results in increased RAM storage space, when compared to storing messages in plain text format." /><meta name="description" content="This tutorial explains how to store the email message data in rich text format. Storing email messages in rich text format results in increased RAM storage space, when compared to storing messages in plain text format." /><meta name="DC.Relation" scheme="URI" content="GUID-2C8653F9-8873-59E8-9FD2-4215F6877ABC" /><meta name="DC.Relation" scheme="URI" content="GUID-D73AD200-BE4D-50BF-BCF9-14627DE530B7" /><meta name="DC.Relation" scheme="URI" content="GUID-BB35DBCC-FE56-547F-BADA-9EF854691ADC" /><meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7" /><meta name="DC.Relation" scheme="URI" content="GUID-5DD1010C-1648-5086-BA80-BC25F3C7A2C4" /><meta name="DC.Relation" scheme="URI" content="GUID-C290FA5E-8E41-5D19-B8C1-F88491EE6388" /><meta name="DC.Relation" scheme="URI" content="GUID-B394A824-8745-505E-8429-8B9B6D418387" /><meta name="DC.Relation" scheme="URI" content="GUID-DD27A452-8B0F-5C6D-A2E6-FC21145468B6" /><meta name="DC.Relation" scheme="URI" content="GUID-179099DA-1CD9-5912-B41B-363C132C7A86" /><meta name="DC.Relation" scheme="URI" content="GUID-9A3E0279-4F87-594D-A987-66DC77F408A0" /><meta name="DC.Format" content="XHTML" /><meta name="DC.Identifier" content="GUID-F9F45DE7-6688-5C31-90F0-0BEA72E74034" /><meta name="DC.Language" content="en" /><title>Creating
Email Messages in Rich Text Format </title><link href="css/s60/style.css" rel="stylesheet" type="text/css" /><link href="PLUGINS_ROOT/com.nokia.forum.library/css/category_design.html" rel="stylesheet" type="text/css" /></head><body><div class="body"><div class="contentLeft prTxt"><h1 class="pageHeading" id="GUID-F9F45DE7-6688-5C31-90F0-0BEA72E74034">Creating
Email Messages in Rich Text Format</h1><div><p>This tutorial explains how to store the email message data in rich
text format. Storing email messages in rich text format results in increased
RAM storage space, when compared to storing messages in plain text format.</p>
<div><h3 class="section-title">Procedure</h3> <ol id="GUID-F7EF7462-A65E-50B0-BCDA-C915EB69DAAE">
<li id="GUID-022C69C9-BFBF-5540-ABA1-DEAB836BCC26"><a name="GUID-022C69C9-BFBF-5540-ABA1-DEAB836BCC26"><!-- --></a><p>Create an email entry
in the message store using CImEmailOperation::CreateNewL(),
which takes all the following nine parameters. </p> <div class="p"><pre class="codeblock">static IMPORT_C CImEmailOperation *CreateNewL(TRequestStatus &amp;aObserverRequestStatus,
CMsvSession &amp;aMsvSession, TMsvId aDestination, TMsvId aSmtpServiceId,
TMsvPartList aPartList, const TMsvEmailTypeList &amp;aMsvEmailTypeList,
TUid aMsgType, TInt aPriority, TBool aUsePlainTextStorage);</pre> </div> </li>
<li id="GUID-83FDEF9F-DD2A-502B-9A80-3FBA28347261"><a name="GUID-83FDEF9F-DD2A-502B-9A80-3FBA28347261"><!-- --></a><p>Set the TBool parameter
to <code class="codeph">EFalse</code>. </p> </li>
<li id="GUID-DC8EEF57-35F8-5A28-83E7-7C98069C357C"><a name="GUID-DC8EEF57-35F8-5A28-83E7-7C98069C357C"><!-- --></a><p>Use the CImEmailOperation::ProgressL() function
to obtain the TMsvId parameter of the newly created email.
This is returned through a <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-36B29964-420D-38D0-AF08-4DA70BED8B6E.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-36B29964-420D-38D0-AF08-4DA70BED8B6E.html"><code class="apiname">TPckgC</code></a> &lt;TMsvId &gt;
descriptor. </p> </li>
<li id="GUID-16CDC45A-B8A6-5141-80A1-569182A2E642"><a name="GUID-16CDC45A-B8A6-5141-80A1-569182A2E642"><!-- --></a><p>Create a CMsvEntry object
using the TMsvId <code class="codeph">aMessageId</code> parameter
of the newly created email. </p> </li>
<li id="GUID-FBDF917D-2265-524A-B574-500DC13F0095"><a name="GUID-FBDF917D-2265-524A-B574-500DC13F0095"><!-- --></a><p>Use the CMsvEntry object
to the create a CImEmailMessage object. </p> </li>
<li id="GUID-F52E2F63-5A8C-566A-B1B9-7B7D3EBEB4FE"><a name="GUID-F52E2F63-5A8C-566A-B1B9-7B7D3EBEB4FE"><!-- --></a><p>Create the body text
of the email and insert into a CRichText object. </p> </li>
<li id="GUID-D1E2F8C6-8DB8-564F-8F46-08AD7329BA99"><a name="GUID-D1E2F8C6-8DB8-564F-8F46-08AD7329BA99"><!-- --></a><p>Call the CImEmailMessage::StoreBodyTextL() function
and pass the CRichText class that contains the body text
of the message. </p> </li>
</ol> </div>
</div><h3>Related concepts</h3><ul><li><a href="GUID-2C8653F9-8873-59E8-9FD2-4215F6877ABC.html">Chunk Method
to Process Emails</a></li><li><a href="GUID-D73AD200-BE4D-50BF-BCF9-14627DE530B7.html">Imap4Example:
An Email manager using IMAP4 and SMTP</a></li><li><a href="GUID-BB35DBCC-FE56-547F-BADA-9EF854691ADC.html">Pop3Example:
An Email manager using POP3 and SMTP</a></li></ul></div></div><div class="footer"><p class="metadata">Last updated October 21st, 2009</p><hr /><div class="copy">Â© Nokia 2011.</div></div></body>
<!-- Mirrored from devlib.symbian.slions.net/s3/GUID-F9F45DE7-6688-5C31-90F0-0BEA72E74034.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 06:12:43 GMT -->
</html>