
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<!-- Mirrored from devlib.symbian.slions.net/s3/GUID-277BD68B-70CF-5798-A77D-E2B901FA613B.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 06:18:02 GMT -->
<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="copyright" content="(C) Copyright 2011" /><meta name="DC.rights.owner" content="(C) Copyright 2011" /><meta name="DC.Type" content="task" /><meta name="DC.Title" content="Central Repository Data Access Tutorial" /><meta name="abstract" content="This tutorial describes how to access and modify the data in Central Repository at run time on the Symbian platform." /><meta name="description" content="This tutorial describes how to access and modify the data in Central Repository at run time on the Symbian platform." /><meta name="DC.Relation" scheme="URI" content="GUID-AA5DEEB2-0B13-5FA8-8494-EC2F5C654FEF" /><meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7" /><meta name="DC.Relation" scheme="URI" content="GUID-FBCBF8A0-7922-5881-A1C5-5DB41630E75A" /><meta name="DC.Relation" scheme="URI" content="GUID-F8824165-4B33-50D1-9706-BD2438B5A2EE" /><meta name="DC.Relation" scheme="URI" content="GUID-50BA6AEB-E968-5CCA-8F5D-A65969263D90" /><meta name="DC.Format" content="XHTML" /><meta name="DC.Identifier" content="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B" /><meta name="DC.Language" content="en" /><title>Central Repository Data Access Tutorial </title><link href="css/s60/style.css" rel="stylesheet" type="text/css" /><link href="PLUGINS_ROOT/com.nokia.forum.library/css/category_design.html" rel="stylesheet" type="text/css" /></head><body><div class="body"><div class="contentLeft prTxt"><h1 class="pageHeading" id="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B">Central Repository Data Access Tutorial</h1><div><p>This tutorial describes how to access and modify the data in Central Repository at run time on the Symbian platform. </p> <div id="GUID-58A8A8B0-EAFA-5AEB-B978-10048CE3B821"><h3 class="section-title">Context</h3><p>Repositories cannot be created at runtime. Applications must register with Central Repository using the initialisation file. The Central Repository API is provided by the <strong class="conversion-error-message" title="[NOKX000E] Unable to find definition for key reference 'CRepository'">[[[ERROR: [NOKX000E] Unable to find definition for key reference 'CRepository']]]</strong><a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html"><code class="apiname">CRepository</code></a> class. Applications access the repository with the UID of the repository. Applications must have appropriate access to the repositories. </p> </div><div id="GUID-04C96E61-FBDE-5A4E-AAD9-75FF4BB80531"><h3 class="section-title">Prerequisites</h3><p>Before you start, you must: </p> <ul><li id="GUID-5B3953CA-CFC3-52D9-8177-9D08EC7CEF87"><a name="GUID-5B3953CA-CFC3-52D9-8177-9D08EC7CEF87"><!-- --></a><p>understand the <a href="GUID-CBC57511-7F28-596A-9763-5674EB41BCAC.html">Central Repository</a> </p> </li> <li id="GUID-B2FFA28E-192F-5982-A331-557D8228BF4A"><a name="GUID-B2FFA28E-192F-5982-A331-557D8228BF4A"><!-- --></a><p>know how to <a href="GUID-E3BE62B2-9625-5F79-84A4-0248A3F36225.html">register and use the repositories</a> in the Central Repository </p> </li> </ul> </div> <h3>Steps</h3><ol id="GUID-6E0FE2B1-5AAD-5B2C-B304-6DDCFE312B6A"><a name="GUID-6E0FE2B1-5AAD-5B2C-B304-6DDCFE312B6A"><!-- --></a> <li id="GUID-5F2291E4-C723-5F10-BBCC-0FF996DE8201"><a name="GUID-5F2291E4-C723-5F10-BBCC-0FF996DE8201"><!-- --></a><p> Open a repository</p> <p>The repositories are identified by a <code class="codeph">UID</code>. To access the data in the Central Repository create a new <strong class="conversion-error-message" title="[NOKX000E] Unable to find definition for key reference 'CRepository'">[[[ERROR: [NOKX000E] Unable to find definition for key reference 'CRepository']]]</strong><a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html"><code class="apiname">CRepository</code></a> object with the <code class="codeph">UID</code> of the repository. </p> <pre class="codeblock">CRepository* repository = CRepository::NewL(KMyRepositoryUid);</pre>  One <strong class="conversion-error-message" title="[NOKX000E] Unable to find definition for key reference 'CRepository'">[[[ERROR: [NOKX000E] Unable to find definition for key reference 'CRepository']]]</strong><a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html"><code class="apiname">CRepository</code></a> object must be created for each repository.  </li> <li id="GUID-B986A80F-A665-563D-9B73-AA60DD6BE395"><a name="GUID-B986A80F-A665-563D-9B73-AA60DD6BE395"><!-- --></a><p> Retrieve data from the repository</p> <p>The data can be retrieved by using <strong class="conversion-error-message" title="[NOKX000E] Unable to find definition for key reference 'CRepository'">[[[ERROR: [NOKX000E] Unable to find definition for key reference 'CRepository']]]</strong><a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html"><code class="apiname">Get()</code></a> or <strong class="conversion-error-message" title="[NOKX000E] Unable to find definition for key reference 'CRepository'">[[[ERROR: [NOKX000E] Unable to find definition for key reference 'CRepository']]]</strong><a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html"><code class="apiname">Find()</code></a> functions of the <strong class="conversion-error-message" title="[NOKX000E] Unable to find definition for key reference 'CRepository'">[[[ERROR: [NOKX000E] Unable to find definition for key reference 'CRepository']]]</strong><a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html"><code class="apiname">CRepository</code></a> class. </p> <ol type="i" id="GUID-610E555C-C29C-59D4-8931-4E1085943D09"><a name="GUID-610E555C-C29C-59D4-8931-4E1085943D09"><!-- --></a><li id="GUID-A7BE9113-5ECE-575B-A6F5-2AB183DE7774"><a name="GUID-A7BE9113-5ECE-575B-A6F5-2AB183DE7774"><!-- --></a><p></p>Use <strong class="conversion-error-message" title="[NOKX000E] Unable to find definition for key reference 'CRepository'">[[[ERROR: [NOKX000E] Unable to find definition for key reference 'CRepository']]]</strong><a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html"><code class="apiname">Get()</code></a> to retrieve an individual value   <pre class="codeblock">TInt Get(TUint32 aKey, TInt&amp; aVal);    </pre> </li> <li id="GUID-D965F3C6-AAC0-5738-AB6B-9632AD7BA0E4"><a name="GUID-D965F3C6-AAC0-5738-AB6B-9632AD7BA0E4"><!-- --></a><p></p>Use <strong class="conversion-error-message" title="[NOKX000E] Unable to find definition for key reference 'CRepository'">[[[ERROR: [NOKX000E] Unable to find definition for key reference 'CRepository']]]</strong><a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html"><code class="apiname">Find()</code></a> function to retrieve the values by passing a range of keys  The input parameters are a partial key and a key mask and the function returns all the settings that match the input range.   <pre class="codeblock">TInt FindL(TUint32 aPartialKey, TUint32 aKeyMask, RArray&lt;TUint32&gt;&amp; aFoundKeys);</pre> <code class="codeph">aKey</code> parameter represents a setting in a 32 bit unsigned integer and <code class="codeph">aVal</code> represents the corresponding value of the setting.  </li> </ol> </li> <li id="GUID-A916E538-CF26-512C-B47E-8A0AFF2AFD93"><a name="GUID-A916E538-CF26-512C-B47E-8A0AFF2AFD93"><!-- --></a><p>Modify the data of the repository
                  opened</p> <p>The <strong class="conversion-error-message" title="[NOKX000E] Unable to find definition for key reference 'CRepository'">[[[ERROR: [NOKX000E] Unable to find definition for key reference 'CRepository']]]</strong><a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html"><code class="apiname">Set()</code></a> functions of the <strong class="conversion-error-message" title="[NOKX000E] Unable to find definition for key reference 'CRepository'">[[[ERROR: [NOKX000E] Unable to find definition for key reference 'CRepository']]]</strong><a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html"><code class="apiname">CRepository</code></a> class allows the applications to modify the data in the Central Repository. </p>  Set new values using <strong class="conversion-error-message" title="[NOKX000E] Unable to find definition for key reference 'CRepository'">[[[ERROR: [NOKX000E] Unable to find definition for key reference 'CRepository']]]</strong><a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html"><code class="apiname">Set()</code></a> <pre class="codeblock">
TInt Set(TUint32 aKey, TInt aVal);
</pre> </li> <li id="GUID-54F13AB8-9276-5B96-9355-2D8A5ADF5315"><a name="GUID-54F13AB8-9276-5B96-9355-2D8A5ADF5315"><!-- --></a><p></p>  Read the metadata of the repository   <ol type="i" id="GUID-C7CCC06D-A51A-504E-9B48-9568BF9183DB"><a name="GUID-C7CCC06D-A51A-504E-9B48-9568BF9183DB"><!-- --></a><li id="GUID-AD5DE28B-4C8E-5F24-BDED-9C2528D0BAE5"><a name="GUID-AD5DE28B-4C8E-5F24-BDED-9C2528D0BAE5"><!-- --></a><p></p>Use <strong class="conversion-error-message" title="[NOKX000E] Unable to find definition for key reference 'CRepository'">[[[ERROR: [NOKX000E] Unable to find definition for key reference 'CRepository']]]</strong><a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html"><code class="apiname">GetMeta()</code></a> to get the metadata of the repository.  The eight most significant bits are reserved for internal purpose and clients must not use these values. The value of the reserved bits may change for each <strong class="conversion-error-message" title="[NOKX000E] Unable to find definition for key reference 'CRepository'">[[[ERROR: [NOKX000E] Unable to find definition for key reference 'CRepository']]]</strong><a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html"><code class="apiname">GetMeta()</code></a> call.  </li> <li id="GUID-21F48A2A-F372-5ABF-B067-80D34527D667"><a name="GUID-21F48A2A-F372-5ABF-B067-80D34527D667"><!-- --></a><p></p>Applications must use logical AND function with the retun value of <strong class="conversion-error-message" title="[NOKX000E] Unable to find definition for key reference 'CRepository'">[[[ERROR: [NOKX000E] Unable to find definition for key reference 'CRepository']]]</strong><a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html"><code class="apiname">GetMeta()</code></a> and the constant <strong class="conversion-error-message" title="[NOKX000E] Unable to find definition for key reference 'CRepository'">[[[ERROR: [NOKX000E] Unable to find definition for key reference 'CRepository']]]</strong><a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html"><code class="apiname">KMetaUnreserved</code></a> to retrieve the user bits of the metadata.  The constant <code class="codeph">KMetaUnreserved</code> is defined in <code class="codeph">centralrepository.h</code>.  </li> </ol> <pre class="codeblock">TInt GetMeta(TUint32 aKey, TUint32&amp; aMeta);</pre> </li> <li id="GUID-92638DAF-1888-5D21-8607-E159637193D5"><a name="GUID-92638DAF-1888-5D21-8607-E159637193D5"><!-- --></a><p> Add a new setting</p> <p>To add a new setting in the repository use <strong class="conversion-error-message" title="[NOKX000E] Unable to find definition for key reference 'CRepository'">[[[ERROR: [NOKX000E] Unable to find definition for key reference 'CRepository']]]</strong><a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html"><code class="apiname">Create()</code></a>. </p> <pre class="codeblock">TInt Create(TUint32 aKey, TInt aVal);</pre>  To delete an existing setting use <strong class="conversion-error-message" title="[NOKX000E] Unable to find definition for key reference 'CRepository'">[[[ERROR: [NOKX000E] Unable to find definition for key reference 'CRepository']]]</strong><a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html"><code class="apiname">Delete()</code></a> <pre class="codeblock">TInt Delete(TUint32 aKey);</pre> </li> <li id="GUID-47F70785-7460-5052-85F4-C63CC042F77D"><a name="GUID-47F70785-7460-5052-85F4-C63CC042F77D"><!-- --></a><p>Move settings</p> <p>To move one or more settings from one key to another key use <strong class="conversion-error-message" title="[NOKX000E] Unable to find definition for key reference 'CRepository'">[[[ERROR: [NOKX000E] Unable to find definition for key reference 'CRepository']]]</strong><a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html"><code class="apiname">Move()</code></a> </p> <pre class="codeblock">TInt Move (TUint32 aSourcePartialKey, TUint32 aTargetPartialKey, TUint32 aMask, TUint32 &amp;aErrorKey) ;</pre>  The source key, target key and the partial mask must be provided by the clients.  </li> <li id="GUID-90C11E03-6017-502C-A569-FDE22C18B753"><a name="GUID-90C11E03-6017-502C-A569-FDE22C18B753"><!-- --></a><p></p> Reset the settings   <ol type="i" id="GUID-749BC68F-C733-5571-8086-E0B9F6E370A8"><a name="GUID-749BC68F-C733-5571-8086-E0B9F6E370A8"><!-- --></a><li id="GUID-AE2FCCFC-5E47-5511-917A-4B6F2A5CDDEC"><a name="GUID-AE2FCCFC-5E47-5511-917A-4B6F2A5CDDEC"><!-- --></a><p></p>To reset the settings of a repository to the default values use <strong class="conversion-error-message" title="[NOKX000E] Unable to find definition for key reference 'CRepository'">[[[ERROR: [NOKX000E] Unable to find definition for key reference 'CRepository']]]</strong><a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html"><code class="apiname">Reset()</code></a> <pre class="codeblock">TInt Reset();</pre> </li> <li id="GUID-5B520C2F-5742-5053-B880-A1333A7A02A2"><a name="GUID-5B520C2F-5742-5053-B880-A1333A7A02A2"><!-- --></a><p></p>To reset a particular setting, pass the key of the setting as a parameter to the <strong class="conversion-error-message" title="[NOKX000E] Unable to find definition for key reference 'CRepository'">[[[ERROR: [NOKX000E] Unable to find definition for key reference 'CRepository']]]</strong><a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html"><code class="apiname">Reset()</code></a> function.   <pre class="codeblock">TInt Reset(TUint32 aKey);</pre>  Go back to step 2 if you want to modify the settings after a reset or continue to step 8  </li> </ol> </li> <li id="GUID-A7CEAD38-A92E-5A06-AC16-8FC91BD6CDF7"><a name="GUID-A7CEAD38-A92E-5A06-AC16-8FC91BD6CDF7"><!-- --></a><p> Close the repository</p> <p>To close repository, use delete. </p> <pre class="codeblock">delete repository;
</pre>  Each instance of the <strong class="conversion-error-message" title="[NOKX000E] Unable to find definition for key reference 'CRepository'">[[[ERROR: [NOKX000E] Unable to find definition for key reference 'CRepository']]]</strong><a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html"><code class="apiname">CRepository</code></a> object must be deleted to clean up the resources.  </li> </ol> <div id="GUID-6A19D562-87BE-5BAA-A523-4C7B0CC4C01F"><h3 class="section-title">Results</h3><p>The data in a repository will be modified with the new values by the application. </p> </div> </div><h3>Related concepts</h3><ul><li><a href="GUID-AA5DEEB2-0B13-5FA8-8494-EC2F5C654FEF.html">CentRepExample: Using central repository for
                persistent storage</a></li></ul></div></div><div class="footer"><p class="metadata">Last updated October 10th, 2009</p><hr /><div class="copy">© Nokia 2011.</div></div></body>
<!-- Mirrored from devlib.symbian.slions.net/s3/GUID-277BD68B-70CF-5798-A77D-E2B901FA613B.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 06:18:02 GMT -->
</html>