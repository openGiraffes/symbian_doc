<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en-us" xml:lang="en-us">

<!-- Mirrored from devlib.symbian.slions.net/s3/GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-1562832D-3EAF-3400-A868-D24AD6C12835.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 07:38:27 GMT -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2011"/>
<meta name="DC.rights.owner" content="(C) Copyright 2011"/>
<meta name="DC.Type" content="cxxClass"/>
<meta name="DC.Title" content="CVersitTlsData"/>
<meta name="abstract" content=""/>
<meta name="description" content=""/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-1562832D-3EAF-3400-A868-D24AD6C12835"/>
<link rel="stylesheet" type="text/css" href="css/commonltr.css"/>
<title>CVersitTlsData</title>
<meta name="keywords" content="api"/><link rel="stylesheet" type="text/css" href="css/nokiacxxref.css"/><link href="css/html.css" rel="stylesheet" type="text/css"/><link href="css/style.css" rel="stylesheet" type="text/css"/><link href="css/nwg.css" rel="stylesheet" type="text/css"/><link href="css/eclipse.css" rel="stylesheet" type="text/css"/></head>
<body id="GUID-1562832D-3EAF-3400-A868-D24AD6C12835"><a name="GUID-1562832D-3EAF-3400-A868-D24AD6C12835"><!-- --></a><div class="body"><div class="contentLeft prTxt">

	<h1 class="sectiontitle">CVersitTlsData Class Reference</h1>
	
	<div class="section include"><p>#include 
            
                    &lt;app/versittls.h&gt;
                </p></div>
<div class="section linkagainst" id="GUID-1562832D-3EAF-3400-A868-D24AD6C12835__linkagainst"><a name="GUID-1562832D-3EAF-3400-A868-D24AD6C12835__linkagainst"><!-- --></a><p>Link against: versit.lib</p></div>
<div class="section signature"><table class="signature"><tr><td>class CVersitTlsData : public CBase</td></tr></table></div><div class="section derivation"><h2 class="sectiontitle">Inherits from</h2><ul class="derivation derivation-root"><li class="derivation-depth-0 ">CVersitTlsData<ul class="derivation"/></li></ul></div>
<div class="section member-index"><table class="member-index"><thead><tr><th colspan="2">Public Member Functions</th></tr></thead><tbody><tr><td align="right" class="code">
					<a href="GUID-B0B08904-0D0E-3BE5-96DB-14E39BE17DB4.html">CVersitAdditionalStorage</a> &amp;</td><td><a href="#GUID-1B2BD29C-32CA-3A89-922F-DC1B81CEACBC">AdditionalStorage</a>()</td></tr><tr class="bg"><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-99FB355A-7C2C-3B92-B272-1D5B2585D3B4">CloseVersitTlsData</a>()</td></tr><tr><td align="right" class="code">
					<a href="GUID-5004C110-E210-3557-BC9A-852AEE737EE1.html">CVersitUnicodeUtils</a> &amp;</td><td><a href="#GUID-2E5D62D9-1904-3BFD-9460-C16F69E08FAD">UnicodeUtils</a>()</td></tr><tr class="bg"><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-0881D657-6322-3973-B6D4-4F821698A74E">VersitTlsDataClose</a>()</td></tr><tr><td align="right" class="code">IMPORT_C <a href="GUID-1562832D-3EAF-3400-A868-D24AD6C12835.html">CVersitTlsData</a> &amp;</td><td><a href="#GUID-95CAAC61-5CB7-3D8F-B644-429E2E366D7B">VersitTlsDataL</a>()</td></tr></tbody></table><table class="member-index"><thead><tr><th colspan="2">Inherited Functions</th></tr></thead><tbody><tr><td> </td><td><a href="GUID-8F6FE089-E2A8-30F4-B67E-10F286347681.html">CBase::CBase()</a></td></tr><tr class="bg"><td> </td><td><a href="GUID-8F6FE089-E2A8-30F4-B67E-10F286347681.html">CBase::Delete(CBase *)</a></td></tr><tr><td> </td><td><a href="GUID-8F6FE089-E2A8-30F4-B67E-10F286347681.html">CBase::Extension_(TUint,TAny *&amp;,TAny *)</a></td></tr><tr class="bg"><td> </td><td><a href="GUID-8F6FE089-E2A8-30F4-B67E-10F286347681.html">CBase::operator new(TUint)</a></td></tr><tr><td> </td><td><a href="GUID-8F6FE089-E2A8-30F4-B67E-10F286347681.html">CBase::operator new(TUint,TAny *)</a></td></tr><tr class="bg"><td> </td><td><a href="GUID-8F6FE089-E2A8-30F4-B67E-10F286347681.html">CBase::operator new(TUint,TLeave)</a></td></tr><tr><td> </td><td><a href="GUID-8F6FE089-E2A8-30F4-B67E-10F286347681.html">CBase::operator new(TUint,TLeave,TUint)</a></td></tr><tr class="bg"><td> </td><td><a href="GUID-8F6FE089-E2A8-30F4-B67E-10F286347681.html">CBase::operator new(TUint,TUint)</a></td></tr><tr><td> </td><td><a href="GUID-8F6FE089-E2A8-30F4-B67E-10F286347681.html">CBase::~CBase()</a></td></tr></tbody></table></div><div class="section apidesc"><h2 class="sectiontitle">Detailed Description</h2>
			<p>
				<a href="GUID-7BAF7E07-B177-39A1-B719-6A8D055DA3FA.html#GUID-7BAF7E07-B177-39A1-B719-6A8D055DA3FA">Versit</a> thread local storage.</p>

			<p>This class provides a performance improvement by allowing a <a href="GUID-5004C110-E210-3557-BC9A-852AEE737EE1.html#GUID-5004C110-E210-3557-BC9A-852AEE737EE1">CVersitUnicodeUtils</a> instance to be shared between parsers operating in the same thread, so that a new instance does not have to be created for each parser. A pointer to the unicode utilities object is held in thread local storage: a single word (32bits) of data. Each unicode utilities object is managed by an instance of this class.</p>

			<p>Every time a parser is created, <a href="GUID-6D7CB0C1-2311-30A3-B0E8-A9B5BBBA395C.html#GUID-445DF1EF-01E4-3DC8-8F85-961072D3EA37">CVersitParser::ConstructL()</a> calls the <a href="GUID-1562832D-3EAF-3400-A868-D24AD6C12835.html#GUID-1562832D-3EAF-3400-A868-D24AD6C12835">CVersitTlsData</a> constructor, and when the parser is destroyed the <a href="GUID-1562832D-3EAF-3400-A868-D24AD6C12835.html#GUID-1562832D-3EAF-3400-A868-D24AD6C12835">CVersitTlsData</a> destructor is called. If a <a href="GUID-1562832D-3EAF-3400-A868-D24AD6C12835.html#GUID-1562832D-3EAF-3400-A868-D24AD6C12835">CVersitTlsData</a> object exists, the constructor returns a pointer to it, otherwise a new one is constructed. The <a href="GUID-1562832D-3EAF-3400-A868-D24AD6C12835.html#GUID-1562832D-3EAF-3400-A868-D24AD6C12835">CVersitTlsData</a> object is only destroyed when no more parsers refer to it: a count is kept, which is incremented every time the constructor is called and decremented each time the destructor is called, and the object is only destroyed when the count reaches zero.</p>

			<p>This class provides an additional major performance improvement if you are sequentially constructing and destructing multiple parsers. By default, when the count of parsers reaches zero, the thread local storage object is destroyed (even if the thread has not finished). However, by using the technique described below, the thread local storage object, and therefore the unicode utilities object, can be made to persist, significantly reducing the overhead of sequentially constructing and destructing parsers.</p>

			<p>The constructor needs to be called an extra time before creating any parsers, and the destructor needs to be called an extra time once the parsers have been destroyed. This has the effect of adding one to the reference count so that during all the parser construction and deletion the count never hits zero, which would trigger the TLS object's destruction.</p>

			<p>This can be implemented as follows:</p>

			<div class="p">1. Create a thread local storage data class instance as follows: <pre class="codeblock">CVersitTlsData* versitTLS = CVersitTlsData::VersitTlsDataL(); </pre>
</div>

			<p>2. Create and delete the parsers.</p>

			<div class="p">3. Delete the Thread Local Storage Data class instance: <pre class="codeblock">delete versitTLS; </pre>
   </div>

		</div>
<h2 class="sectiontitle">Member Function Documentation</h2><div class="nested1" id="GUID-1B2BD29C-32CA-3A89-922F-DC1B81CEACBC"><a name="GUID-1B2BD29C-32CA-3A89-922F-DC1B81CEACBC"><!-- --></a>
		<h3 class="sectiontitle">AdditionalStorage (  )</h3>
		
		<div class="section functiondetail"><div class="section signature"><table class="signature"><tr><td>
					<a href="GUID-B0B08904-0D0E-3BE5-96DB-14E39BE17DB4.html">CVersitAdditionalStorage</a> &amp;</td><td>AdditionalStorage</td><td>(</td><td>)</td><td>[inline]</td></tr></table></div><div class="section apidesc">
				<p>Returns a pointer to the additional property storage object.</p>

				<p/>

			</div>
<div class="section returnsdoc"><p><span class="returnsdoclabel">Returns: </span><span class="returnsdocvalue">A pointer to the additional property storage. </span></p></div>
</div>

	</div>
<div class="nested1" id="GUID-99FB355A-7C2C-3B92-B272-1D5B2585D3B4"><a name="GUID-99FB355A-7C2C-3B92-B272-1D5B2585D3B4"><!-- --></a>
		<h3 class="sectiontitle">CloseVersitTlsData (  )</h3>
		
		<div class="section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C void</td><td>CloseVersitTlsData</td><td>(</td><td>)</td><td>[static]</td></tr></table></div><div class="section apidesc"/>
</div>

	</div>
<div class="nested1" id="GUID-2E5D62D9-1904-3BFD-9460-C16F69E08FAD"><a name="GUID-2E5D62D9-1904-3BFD-9460-C16F69E08FAD"><!-- --></a>
		<h3 class="sectiontitle">UnicodeUtils (  )</h3>
		
		<div class="section functiondetail"><div class="section signature"><table class="signature"><tr><td>
					<a href="GUID-5004C110-E210-3557-BC9A-852AEE737EE1.html">CVersitUnicodeUtils</a> &amp;</td><td>UnicodeUtils</td><td>(</td><td>)</td><td>[inline]</td></tr></table></div><div class="section apidesc">
				<p>Returns a pointer to the current Unicode utilities object.</p>

				<p/>

			</div>
<div class="section returnsdoc"><p><span class="returnsdoclabel">Returns: </span><span class="returnsdocvalue">A pointer to the current Unicode utilities object. </span></p></div>
</div>

	</div>
<div class="nested1" id="GUID-0881D657-6322-3973-B6D4-4F821698A74E"><a name="GUID-0881D657-6322-3973-B6D4-4F821698A74E"><!-- --></a>
		<h3 class="sectiontitle">VersitTlsDataClose (  )</h3>
		
		<div class="section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C void</td><td>VersitTlsDataClose</td><td>(</td><td>)</td><td/></tr></table></div><div class="section apidesc">
				<p>Frees all resources owned by the object if there are no parsers left (i.e. created and not destroyed), prior to its destruction. </p>

			</div>
</div>

	</div>
<div class="nested1" id="GUID-95CAAC61-5CB7-3D8F-B644-429E2E366D7B"><a name="GUID-95CAAC61-5CB7-3D8F-B644-429E2E366D7B"><!-- --></a>
		<h3 class="sectiontitle">VersitTlsDataL (  )</h3>
		
		<div class="section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C <a href="GUID-1562832D-3EAF-3400-A868-D24AD6C12835.html">CVersitTlsData</a> &amp;</td><td>VersitTlsDataL</td><td>(</td><td>)</td><td>[static]</td></tr></table></div><div class="section apidesc">
				<p>Returns a reference to the current Thread Local Storage (TLS) object or, if there isn't one, it creates one.</p>

				<p>If a new TLS object is being created, the object also creates (and owns) a Unicode utilities object, and creates a Unicode converter using this object.</p>

				<p>If creating a new object, it calls the <a href="GUID-5004C110-E210-3557-BC9A-852AEE737EE1.html#GUID-5004C110-E210-3557-BC9A-852AEE737EE1">CVersitUnicodeUtils</a> constructor followed by <a href="GUID-5004C110-E210-3557-BC9A-852AEE737EE1.html#GUID-34A83AD9-9BF7-3A74-B8D5-13AD8F8BA1CB">CVersitUnicodeUtils::CreateConverterL()</a>.</p>

				<p/>

			</div>
<div class="section returnsdoc"><p><span class="returnsdoclabel">Returns: </span><span class="returnsdocvalue">The current Thread Local Storage object. </span></p></div>
</div>

	</div>

	
	
	
	
	
	
</div></div><div class="footer"><hr/><div class="copy">© Nokia 2011.</div></div>
</body>
<!-- Mirrored from devlib.symbian.slions.net/s3/GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-1562832D-3EAF-3400-A868-D24AD6C12835.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 07:38:27 GMT -->
</html>