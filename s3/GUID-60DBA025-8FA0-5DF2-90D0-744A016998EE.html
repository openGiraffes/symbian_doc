
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<!-- Mirrored from devlib.symbian.slions.net/s3/GUID-60DBA025-8FA0-5DF2-90D0-744A016998EE.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 06:14:36 GMT -->
<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="copyright" content="(C) Copyright 2011" /><meta name="DC.rights.owner" content="(C) Copyright 2011" /><meta name="DC.Type" content="concept" /><meta name="DC.Title" content="Panoramic Stitching Guide" /><meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7" /><meta name="DC.Relation" scheme="URI" content="GUID-1DE5CDAD-8D71-5384-9E98-5665D5A4C792" /><meta name="DC.Relation" scheme="URI" content="GUID-3E341F9F-2635-589B-A59A-B999FE7DF9BE" /><meta name="DC.Relation" scheme="URI" content="GUID-7DB86BF1-0485-5CBA-9554-4C474B0EC1FB" /><meta name="DC.Relation" scheme="URI" content="GUID-042868E6-88BF-5797-BB53-8E34283DCF16" /><meta name="DC.Relation" scheme="URI" content="GUID-AD6CF225-CFF9-5F76-AA00-3535EA7D6FF1" /><meta name="DC.Relation" scheme="URI" content="GUID-03866ADB-5916-5B31-BCF0-44F94E12B740" /><meta name="DC.Relation" scheme="URI" content="GUID-AFAB4B17-1E9B-562D-AC36-48C4B0FFDD50" /><meta name="DC.Format" content="XHTML" /><meta name="DC.Identifier" content="GUID-60DBA025-8FA0-5DF2-90D0-744A016998EE" /><meta name="DC.Language" content="en" /><title>Panoramic
Stitching Guide </title><link href="css/s60/style.css" rel="stylesheet" type="text/css" /><link href="PLUGINS_ROOT/com.nokia.forum.library/css/category_design.html" rel="stylesheet" type="text/css" /></head><body><div class="body"><div class="contentLeft prTxt"><h1 class="pageHeading" id="GUID-60DBA025-8FA0-5DF2-90D0-744A016998EE">Panoramic
Stitching Guide</h1><div>
<p>This document introduces you to the panoramic stitching functionality. </p>
<div id="GUID-3333CA2A-EF84-5E7B-B9BE-8FF00523897F-GENID-GUID-52F56FF3-0BA1-4F79-9CBC-02DC6DA0837C"><h3 class="section-title">Purpose</h3> <p>Panoramic
stitching involves combining a collection of images into a single image. </p> </div>
<div><h3 class="section-title">Panoramic stitching overview</h3> <p>The panorama image
is created by stitching a collection of several separate image into one large
image. The panoramic stitching process is done by, </p> <ul>
<li id="GUID-0DA59FD4-B817-5B51-8E83-F56FC42E1675"><a name="GUID-0DA59FD4-B817-5B51-8E83-F56FC42E1675"><!-- --></a><p>image registration </p> </li>
<li id="GUID-74941275-9681-51AB-B1FB-4F0829B47075"><a name="GUID-74941275-9681-51AB-B1FB-4F0829B47075"><!-- --></a><p>cylindrical projection
of images </p> </li>
<li id="GUID-70E87CA6-B8BC-5CE9-A545-FC3782A81A69"><a name="GUID-70E87CA6-B8BC-5CE9-A545-FC3782A81A69"><!-- --></a><p>image blending. </p> </li>
</ul> <p>The panoramic stitch can be done eihter interactively by using camera
viewfinder, for tracking the camera movements or by stitching pre-captured
images together. </p> <p><strong>Introduction
about the panoramic stitching</strong> </p> <p>The <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4DBD1F07-42C5-3CD7-B809-A391F315E0D4.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4DBD1F07-42C5-3CD7-B809-A391F315E0D4.html"><code class="apiname">CImagePanorama</code></a> stitches
a set of images into a single panorama image. The input to <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4DBD1F07-42C5-3CD7-B809-A391F315E0D4.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4DBD1F07-42C5-3CD7-B809-A391F315E0D4.html"><code class="apiname">CImagePanorama</code></a> is
a collection of high resolution images together with some guidance on the
relative positioning between the images expressed by <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-27BD164A-9283-3BE0-A0BF-A475539D86EA.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-27BD164A-9283-3BE0-A0BF-A475539D86EA.html"><code class="apiname">CPanoramaTransform</code></a> instances. </p> <p>For
the panorama creation, the most common use is rendering a full size panorama
image to the device file system. </p> <p>The high level steps to use <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4DBD1F07-42C5-3CD7-B809-A391F315E0D4.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4DBD1F07-42C5-3CD7-B809-A391F315E0D4.html"><code class="apiname">CImagePanorama</code></a> are
shown below: </p> <ul>
<li id="GUID-EF02A22B-B4B1-5E97-97E7-F09DE26DA93A"><a name="GUID-EF02A22B-B4B1-5E97-97E7-F09DE26DA93A"><!-- --></a><p>To construct <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4DBD1F07-42C5-3CD7-B809-A391F315E0D4.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4DBD1F07-42C5-3CD7-B809-A391F315E0D4.html"><code class="apiname">CImagePanorama</code></a>,
use <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4DBD1F07-42C5-3CD7-B809-A391F315E0D4.html#GUID-39BE88C3-C617-3AF8-A13D-CEC60AE798B1"><code class="apiname">CImagePanorama::NewL()</code></a> which loads the image panorama
plugin. </p> </li>
<li id="GUID-690408AF-782D-5E67-93BC-238EBCBD0C20"><a name="GUID-690408AF-782D-5E67-93BC-238EBCBD0C20"><!-- --></a><p>To initialise <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4DBD1F07-42C5-3CD7-B809-A391F315E0D4.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4DBD1F07-42C5-3CD7-B809-A391F315E0D4.html"><code class="apiname">CImagePanorama</code></a>,
use <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4DBD1F07-42C5-3CD7-B809-A391F315E0D4.html#GUID-B6D24921-92B8-3FD8-B666-91C56E1E7984"><code class="apiname">CImagePanorama::InitialiseL()</code></a>. </p> </li>
<li id="GUID-3E167564-6974-571E-99A0-196A5A18133D"><a name="GUID-3E167564-6974-571E-99A0-196A5A18133D"><!-- --></a><p>To correct the lens
parameter use <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-90D79D23-97BC-3EE5-98DD-594DF6EFA0EE.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-90D79D23-97BC-3EE5-98DD-594DF6EFA0EE.html"><code class="apiname">TPanoramaLens</code></a>. You need to correct the lens
for panorama stitching quality. The lens parameters are camera specific. </p> </li>
<li id="GUID-93217AEB-2AC5-5CCC-B5EE-36E8B99BAA85"><a name="GUID-93217AEB-2AC5-5CCC-B5EE-36E8B99BAA85"><!-- --></a><p>To add images to <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4DBD1F07-42C5-3CD7-B809-A391F315E0D4.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4DBD1F07-42C5-3CD7-B809-A391F315E0D4.html"><code class="apiname">CImagePanorama</code></a>,
use <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4DBD1F07-42C5-3CD7-B809-A391F315E0D4.html#GUID-B6591C30-F990-3D75-B9F3-922D41A5F1A1"><code class="apiname">CImagePanorama::AddFileL()</code></a>,<a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4DBD1F07-42C5-3CD7-B809-A391F315E0D4.html#GUID-19FBD32E-9B1F-38B0-963A-B361737818D2"><code class="apiname">CImagePanorama::AddBufferL()</code></a> or <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4DBD1F07-42C5-3CD7-B809-A391F315E0D4.html#GUID-66509DE8-2DBA-3FE0-8495-32E4256FA939"><code class="apiname">CImagePanorama::AddImageL()</code></a>, providing a hint on relative positioning or translation of the images through <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-27BD164A-9283-3BE0-A0BF-A475539D86EA.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-27BD164A-9283-3BE0-A0BF-A475539D86EA.html"><code class="apiname">CPanoramaTransform</code></a>.
This transform only needs to be approximate. </p> </li>
<li id="GUID-B445F73C-2910-56DE-B03D-2637ECED0963"><a name="GUID-B445F73C-2910-56DE-B03D-2637ECED0963"><!-- --></a><p>To make the stitched
image available call <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4DBD1F07-42C5-3CD7-B809-A391F315E0D4.html#GUID-A098A70C-050C-3592-BC37-E849A81890F2"><code class="apiname">CImagePanorama::RenderL()</code></a>. </p> </li>
<li id="GUID-B68A2C77-F19A-5999-82C1-F433269DAACB"><a name="GUID-B68A2C77-F19A-5999-82C1-F433269DAACB"><!-- --></a><p>The <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4DBD1F07-42C5-3CD7-B809-A391F315E0D4.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4DBD1F07-42C5-3CD7-B809-A391F315E0D4.html"><code class="apiname">CImagePanorama</code></a> instance
can then be deleted. </p> </li>
</ul> <p><strong> Introduction
about the CVFTracker</strong> </p> <p> <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html"><code class="apiname">CVFTracker</code></a> is used to
track viewfinder images to aid in capturing a panorama. The usage of <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html"><code class="apiname">CVFTracker</code></a> are
demonstrated as follows: </p> <ul>
<li id="GUID-3496F712-4FCD-5E89-BFEE-5AA6A22A1DA0"><a name="GUID-3496F712-4FCD-5E89-BFEE-5AA6A22A1DA0"><!-- --></a><p>The <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html"><code class="apiname">CVFTracker</code></a> output
is used for providing feedback and guidance to you, on how to move the camera
while capturing a panorama. </p> </li>
<li id="GUID-BDBC8A06-B2F8-507C-81F7-E2F344A94FEA"><a name="GUID-BDBC8A06-B2F8-507C-81F7-E2F344A94FEA"><!-- --></a><p>The <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html"><code class="apiname">CVFTracker</code></a> is
used as an aid for the stitching process in the <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4DBD1F07-42C5-3CD7-B809-A391F315E0D4.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4DBD1F07-42C5-3CD7-B809-A391F315E0D4.html"><code class="apiname">CImagePanorama</code></a>.
The input to the <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html"><code class="apiname">CVFTracker</code></a> is a rapid flow of raw images
from the viewfinder of the camera. The output is the movement of the camera. </p> </li>
</ul> <p>The high level steps to use the <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html"><code class="apiname">CVFTracker</code></a> are
shown below: </p> <ul>
<li id="GUID-5C25D0C8-49E1-5514-A90C-2B8A026D20CC"><a name="GUID-5C25D0C8-49E1-5514-A90C-2B8A026D20CC"><!-- --></a><p>To create <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html"><code class="apiname">CVFTracker</code></a>,
use the <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html#GUID-AE92A41F-388D-338C-A80E-C0B16DF3BDDC"><code class="apiname">CVFTracker::NewL()</code></a>. The <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html#GUID-AE92A41F-388D-338C-A80E-C0B16DF3BDDC"><code class="apiname">CVFTracker::NewL()</code></a> is
used to load the <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html"><code class="apiname">CVFTracker</code></a> plugin. </p> </li>
<li id="GUID-ECE3D707-B871-5EC5-A04D-CA2A632BECC6"><a name="GUID-ECE3D707-B871-5EC5-A04D-CA2A632BECC6"><!-- --></a><p>To initialise <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html"><code class="apiname">CVFTracker</code></a>,
use <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html#GUID-5E441486-3333-3B4F-81F3-3A86AE541CF8"><code class="apiname">CVFTracker::InitialiseL()</code></a>. </p> </li>
<li id="GUID-54FEF93A-68BB-5EFB-8DE4-21F6562DCF11"><a name="GUID-54FEF93A-68BB-5EFB-8DE4-21F6562DCF11"><!-- --></a><p>To reset <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html"><code class="apiname">CVFTracker</code></a>,
use <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html#GUID-AE707DEA-4747-3A1A-8C6F-8163F1DF0584"><code class="apiname">CVFTracker::Reset()</code></a>. </p> </li>
<li id="GUID-32F88242-4EDD-54C7-8D7A-574015A197F4"><a name="GUID-32F88242-4EDD-54C7-8D7A-574015A197F4"><!-- --></a><p>To perform the image
registration, use <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html#GUID-AB58BBEB-5EAE-3E2A-A94E-F59334402A2B"><code class="apiname">CVFTracker::RegisterImageL()</code></a>. </p> </li>
<li id="GUID-01DDC476-9596-55A1-B296-13877DB41B67"><a name="GUID-01DDC476-9596-55A1-B296-13877DB41B67"><!-- --></a><p>To destroy the <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html"><code class="apiname">CVFTracker</code></a>,
use <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html#GUID-C2B64F7D-04D8-324A-BD84-C588503881BC"><code class="apiname">CVFTracker::~CVFTracker()</code></a>. </p> </li>
</ul> <p><strong>Camera
requirements </strong> </p> <p>The camera requirements for the <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4DBD1F07-42C5-3CD7-B809-A391F315E0D4.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4DBD1F07-42C5-3CD7-B809-A391F315E0D4.html"><code class="apiname">CImagePanorama</code></a> and <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html"><code class="apiname">CVFTracker</code></a> are
as follows, </p> <ul>
<li id="GUID-C83A6919-C7BB-55C9-9D60-80EDAE0D4458"><a name="GUID-C83A6919-C7BB-55C9-9D60-80EDAE0D4458"><!-- --></a><p>The camera must provide
low resolution images (in the order of 160 by 120 up to 320 by 240 resolution)
as the raw format at a high frame rate to the <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html"><code class="apiname">CVFTracker</code></a> and
high resolution captured images to the <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4DBD1F07-42C5-3CD7-B809-A391F315E0D4.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4DBD1F07-42C5-3CD7-B809-A391F315E0D4.html"><code class="apiname">CImagePanorama</code></a>. </p> </li>
<li id="GUID-EF41F660-AAEE-5D31-A014-FD6C39C42C5E"><a name="GUID-EF41F660-AAEE-5D31-A014-FD6C39C42C5E"><!-- --></a><p>For the <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html"><code class="apiname">CVFTracker</code></a>,
it is better to have good frame rate than to have high resolution input images. </p> </li>
<li id="GUID-810B06D2-D45F-5E7C-BC62-88AEE0B0A071"><a name="GUID-810B06D2-D45F-5E7C-BC62-88AEE0B0A071"><!-- --></a><p>The use of large <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html"><code class="apiname">CVFTracker</code></a> images
can cause a lower frame rate on slow devices, and do not give accurate tracking
for the view finder. </p> </li>
<li id="GUID-DA5C3ED7-550D-5E4E-AD5A-E9119A56D8FB"><a name="GUID-DA5C3ED7-550D-5E4E-AD5A-E9119A56D8FB"><!-- --></a><p>The optimal size of
images is a tradeoff between the panorama quality and the time for rendering
the panorama. </p> </li>
</ul> </div>
<div><h3 class="section-title">How to use Panoramic Stitching</h3> <p>This section contains
some code snippets to show, how Panoramic stitching is accessed in several
situations. </p> <p><strong>Basic
stitching </strong> </p> <p>The basic stitching is demonstrated by a simple example
of stitching four JPEG images into a single JPEG image providing an approximate
translation between each image: </p> <p> </p> <pre class="codeblock">

    TSize imageSize(1200, 1000);
    
    TDirection direction = EPanoramaDirectionRight;
        
    //Lens parameters or internal camera characteristics should be available for the 
    //specific camera module in use. Here we use default values.
      TPanoramaLens lens;
        
    //Create transform. A transform is an approximate offset between each image.
      CPanoramaTransform* panTrans = CPanoramaTransform::NewL();
      CleanupStack::PushL(panTrans);
    
    //Create panorama object.This stitches the individual images together.
      CImagePanorama* panImage = CImagePanorama::NewL();
      CleanupStack::PushL(panImage);
        
    //Create panorama engine and set the lens and size
      panImage-&gt;InitializeL(imageSize, lens, direction);
        
    //Each file added is provided with an approximate translation. 
    //In this case there are 4 images.
      panTrans-&gt;SetTranslationL(TPoint(0, 0), imageSize);
      panImage-&gt;AddFileL(KTestFileName1, *panTrans);
        
    panTrans-&gt;SetTranslationL(TPoint(900, -30), imageSize);
    panImage-&gt;AddFileL(KTestFileName2, *panTrans);
        
    panTrans-&gt;SetTranslationL(TPoint(900, 60), imageSize);
    panImage-&gt;AddFileL(KTestFileName3, *panTrans);
    
    panTrans-&gt;SetTranslationL(TPoint(400, -30), imageSize);
    panImage-&gt;AddFileL(KTestFileName4, *panTrans);
        
    //The image size can be obtained before rendering (if required)
      TSize size;
      panImage-&gt;CurrentImageSizeL(size);
    
    //view the output image
      panImage-&gt;RenderL(KTestBSOutputFileName);

    CleanupStack::PopAndDestroy(2); //panTrans, panImage

</pre> <p>The main steps for using <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4DBD1F07-42C5-3CD7-B809-A391F315E0D4.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4DBD1F07-42C5-3CD7-B809-A391F315E0D4.html"><code class="apiname">CImagePanorama</code></a> are
as follows, </p> <ol id="GUID-D6872BA3-A3DF-566A-83AF-527870CBE997">
<li id="GUID-FB378114-769F-5404-BD20-8886D538191F"><a name="GUID-FB378114-769F-5404-BD20-8886D538191F"><!-- --></a><p>create <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4DBD1F07-42C5-3CD7-B809-A391F315E0D4.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4DBD1F07-42C5-3CD7-B809-A391F315E0D4.html"><code class="apiname">CImagePanorama</code></a> </p> </li>
<li id="GUID-D8A28AFC-4D37-59C4-91D9-92F4898F2302"><a name="GUID-D8A28AFC-4D37-59C4-91D9-92F4898F2302"><!-- --></a><p>some approximate transform
information for each image pair </p> </li>
<li id="GUID-146D95D7-14DE-57CA-96DA-45959EB895A4"><a name="GUID-146D95D7-14DE-57CA-96DA-45959EB895A4"><!-- --></a><p>add each images to <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4DBD1F07-42C5-3CD7-B809-A391F315E0D4.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4DBD1F07-42C5-3CD7-B809-A391F315E0D4.html"><code class="apiname">CImagePanorama</code></a> </p> </li>
<li id="GUID-FF479A52-24E3-5D0B-A821-44127DA5B60C"><a name="GUID-FF479A52-24E3-5D0B-A821-44127DA5B60C"><!-- --></a><p>render the output (for
example to the file) </p> </li>
<li id="GUID-0ADBEE3F-AA60-5787-92A0-C421D4EA8731"><a name="GUID-0ADBEE3F-AA60-5787-92A0-C421D4EA8731"><!-- --></a><p>delete the objects used. </p> </li>
</ol> <p> <strong>Note:</strong> The following points must be noted by you: </p> <ul>
<li id="GUID-D3EB4190-4B2B-5760-8E6C-D19DAFF439DF"><a name="GUID-D3EB4190-4B2B-5760-8E6C-D19DAFF439DF"><!-- --></a><p>The lens parameters
are not resolution dependant. It is enough to calibrate once for each camera
model and no need to recalibrate for each resolution. For best accuracy, use
the highest resolution possible when calibrating with a calibration tool. </p> <p>The
approximate translations in x co-ordinate and y co-ordinate ( as dx, dy) must
be compliant with the value of direction. </p> </li>
</ul> <p><strong>A
camera application example</strong> </p> <p>The <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4DBD1F07-42C5-3CD7-B809-A391F315E0D4.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4DBD1F07-42C5-3CD7-B809-A391F315E0D4.html"><code class="apiname">CImagePanorama</code></a> is
used in a camera application. The example is more complicated than the previous
example. In this example <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html"><code class="apiname">CVFTracker</code></a> provides the approximate
transform between the captured images. </p> <p><strong>Viewfinder
image tracking </strong> </p> <p>The <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4DBD1F07-42C5-3CD7-B809-A391F315E0D4.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4DBD1F07-42C5-3CD7-B809-A391F315E0D4.html"><code class="apiname">CImagePanorama</code></a> generates
panorama images. The application starts the process and then use the camera
for capturing the images. The <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html"><code class="apiname">CVFTracker</code></a> will give an indication
when to capture the high resolution images, which will later be stitched into
a panorama image. </p> <p>The <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html"><code class="apiname">CVFTracker</code></a> plays an important
role for getting the camera movement. The high level steps to use the <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html"><code class="apiname">CVFTracker</code></a> in
the <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4DBD1F07-42C5-3CD7-B809-A391F315E0D4.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4DBD1F07-42C5-3CD7-B809-A391F315E0D4.html"><code class="apiname">CImagePanorama</code></a> for a camera application, are shown
below: </p> <ol id="GUID-B6357C9E-1510-53C8-856B-2C06C7A6A69C">
<li id="GUID-54C90419-08DE-5406-BBF1-37C0B59FCA26"><a name="GUID-54C90419-08DE-5406-BBF1-37C0B59FCA26"><!-- --></a><p>To create the <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html"><code class="apiname">CVFTracker</code></a> object
and load the <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html"><code class="apiname">CVFTracker</code></a> plugin, use <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html#GUID-AE92A41F-388D-338C-A80E-C0B16DF3BDDC"><code class="apiname">CVFTracker::NewL()</code></a>. </p> </li>
<li id="GUID-D3E16606-ED81-5702-9F4F-9B19754D4768"><a name="GUID-D3E16606-ED81-5702-9F4F-9B19754D4768"><!-- --></a><p>To create <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4DBD1F07-42C5-3CD7-B809-A391F315E0D4.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4DBD1F07-42C5-3CD7-B809-A391F315E0D4.html"><code class="apiname">CImagePanorama</code></a> object
and load the <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4DBD1F07-42C5-3CD7-B809-A391F315E0D4.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4DBD1F07-42C5-3CD7-B809-A391F315E0D4.html"><code class="apiname">CImagePanorama</code></a> plugin, use <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4DBD1F07-42C5-3CD7-B809-A391F315E0D4.html#GUID-39BE88C3-C617-3AF8-A13D-CEC60AE798B1"><code class="apiname">CImagePanorama::NewL()</code></a>. </p> </li>
<li id="GUID-E5C6B072-64FE-554F-BAC4-8850E15B841D"><a name="GUID-E5C6B072-64FE-554F-BAC4-8850E15B841D"><!-- --></a><p>To create the <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-27BD164A-9283-3BE0-A0BF-A475539D86EA.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-27BD164A-9283-3BE0-A0BF-A475539D86EA.html"><code class="apiname">CPanoramaTransform</code></a> object
and set or get the values, use the <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-27BD164A-9283-3BE0-A0BF-A475539D86EA.html#GUID-ADB1D55B-CEA7-3151-B6E2-14F165F8BB9F"><code class="apiname">CPanoramaTransform::NewL()</code></a>. </p> </li>
<li id="GUID-FD68A411-E492-5492-88FD-E7A7307113F7"><a name="GUID-FD68A411-E492-5492-88FD-E7A7307113F7"><!-- --></a><p>To
create CCapsVFTracker, CCapsPanorama, and CCapsPanoramaTransform objects and
set or get the values, use <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html#GUID-5E441486-3333-3B4F-81F3-3A86AE541CF8"><code class="apiname">CVFTracker::InitialiseL()</code></a> and <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4DBD1F07-42C5-3CD7-B809-A391F315E0D4.html#GUID-B6D24921-92B8-3FD8-B666-91C56E1E7984"><code class="apiname">CImagePanorama::InitialiseL()</code></a> respectively. </p> </li>
<li id="GUID-A605F836-474D-55D4-A326-9AC8B0F8F86B"><a name="GUID-A605F836-474D-55D4-A326-9AC8B0F8F86B"><!-- --></a><p>To get a translation
value from a viewfinder image, register an image by using <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html#GUID-AB58BBEB-5EAE-3E2A-A94E-F59334402A2B"><code class="apiname">CVFTracker::RegisterImageL()</code></a>.
This will return translation information as a CPanoramaTransform object. </p> </li>
<li id="GUID-8E6E35D9-B20A-5BA2-987F-1A3447DEA146"><a name="GUID-8E6E35D9-B20A-5BA2-987F-1A3447DEA146"><!-- --></a><p>Check the right time
to capture the next image by using <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html#GUID-945FF7AD-31E5-3C6A-AD89-F1A5FC225B9D"><code class="apiname">CVFTracker::IsTimeToCapture()</code></a>. </p> </li>
<li id="GUID-A490A649-B910-5E1C-B317-EC5627547EF7"><a name="GUID-A490A649-B910-5E1C-B317-EC5627547EF7"><!-- --></a><p>Reset the <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html"><code class="apiname">CVFTracker</code></a> for
the next image, using <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html#GUID-AE707DEA-4747-3A1A-8C6F-8163F1DF0584"><code class="apiname">CVFTracker::Reset()</code></a>. </p> <p>In order
to capture many images to be stitched into a single panorama image, repeat
the steps 5, 6 and 7. </p> </li>
</ol> <div class="figure" id="GUID-7F48B2F5-D65B-52EC-8412-F3F56A5EE8E8"><img src="GUID-470FAFE8-2246-5E91-9F01-6CC95F975E54_d0e382996_href.jpg" /></div> <p><strong>Panorama
stitching </strong> </p> <p>The <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html"><code class="apiname">CVFTracker</code></a> helps to decide when
to capture each of the full resolution images using the camera. The images
can then be passed to CImagePanorama and the stitching is done. The high level
steps to do panorama stitching are listed below: </p> <ol id="GUID-763005A3-4098-534F-9CA1-E2F8654C95BD">
<li id="GUID-6866E73F-F1F7-53C8-BA64-8AF448318C53"><a name="GUID-6866E73F-F1F7-53C8-BA64-8AF448318C53"><!-- --></a><p>Capture the next image
using the camera, then add the image to the <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4DBD1F07-42C5-3CD7-B809-A391F315E0D4.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4DBD1F07-42C5-3CD7-B809-A391F315E0D4.html"><code class="apiname">CImagePanorama</code></a> by
using <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4DBD1F07-42C5-3CD7-B809-A391F315E0D4.html#GUID-66509DE8-2DBA-3FE0-8495-32E4256FA939"><code class="apiname">CImagePanorama::AddImageL()</code></a> or <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4DBD1F07-42C5-3CD7-B809-A391F315E0D4.html#GUID-201D0607-2D25-3B1D-B449-7A61419BB0C8"><code class="apiname">CImagePanorama::AddFileL</code></a>,
passing in the <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-27BD164A-9283-3BE0-A0BF-A475539D86EA.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-27BD164A-9283-3BE0-A0BF-A475539D86EA.html"><code class="apiname">CPanoramaTransform</code></a> object obtained from
the CVFTracker. </p> </li>
<li id="GUID-BC35AEEF-206E-5830-909E-07F645C2E063"><a name="GUID-BC35AEEF-206E-5830-909E-07F645C2E063"><!-- --></a><p>When all images have
been captured you can render the stitched image to file, image buffer, CFbsBitmap
or image frame using <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4DBD1F07-42C5-3CD7-B809-A391F315E0D4.html#GUID-A098A70C-050C-3592-BC37-E849A81890F2"><code class="apiname">CImagePanorama::RenderL()</code></a>. </p> </li>
</ol> <div class="figure" id="GUID-B5F7149F-1FB9-535E-9212-7C9E23B9347B"><img src="GUID-A8C80AA1-42CF-5866-B223-FCE1AEC9DF63_d0e383046_href.jpg" /></div> <p><strong>User Interface</strong> </p> <p>Provide a good user interface (UI) application
for the <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4DBD1F07-42C5-3CD7-B809-A391F315E0D4.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4DBD1F07-42C5-3CD7-B809-A391F315E0D4.html"><code class="apiname">CImagePanorama</code></a> is crucial. An example of UI design
is described below, which gives you a robust and easy application for generating
panorama images. </p> <p><strong>How
to shoot a panorama </strong> </p> <p>The steps to be followed for shooting a panorama
images: </p> <ol id="GUID-8FD3D305-BEAF-5414-BD49-5728C2504256">
<li id="GUID-92642922-D0A0-57CD-80A6-03722941E52C"><a name="GUID-92642922-D0A0-57CD-80A6-03722941E52C"><!-- --></a><p>You need to press the
start button of the camera and need to sweep the camera towards the wanted
scene. </p> <p> <strong>Note:</strong> You must try not to move the mobile phone, but
only rotate it. You see in the below diagram the camera is sweep in a clockwise
direction from left-to-right. The rotation is made around the imagined axis
through mobile (axis of rotation in the image). A panorama image covers approximately
a 100 degree field of view. </p> <div class="figure" id="GUID-8562E235-6D10-5097-A888-E27EE6D4E498"><img src="GUID-7B3578A0-7E2E-508A-A355-A39AEE0307AD_d0e383083_href.jpg" /></div> </li>
<li id="GUID-16CA0CFB-9D17-573C-9D7B-FEDBCFF4044C"><a name="GUID-16CA0CFB-9D17-573C-9D7B-FEDBCFF4044C"><!-- --></a><p> <strong>Application Start</strong> </p> <p>When
you launch the application the UI appears as shown in the below diagram. </p> <div class="figure" id="GUID-4A6082E2-1B7F-5A48-8FC5-7BC2786987B7"><img src="GUID-0E55E007-913C-56DA-8BEF-7EC00FFCCE51_d0e383099_href.jpg" /></div> <p>Here the screen area shows the viewfinder image. When you sweep
the mobile, several images are captured and then the images are stitched to
create a panorama image. </p> </li>
<li id="GUID-FE8D49DB-26CC-5546-A05D-B46045894313"><a name="GUID-FE8D49DB-26CC-5546-A05D-B46045894313"><!-- --></a><p> <strong>Capture a panorama
image during tracking</strong> </p> <p>When you choose to capture a panorama image
the UI changes, which is shown in the below diagram. </p> <div class="figure" id="GUID-930C8F54-4C13-50AC-B700-9D889FFE9DC7"><img src="GUID-9AB5481B-C321-56C9-937D-2397AA80DE8E_d0e383118_href.jpg" /></div> <p>In the above diagram you see three different boxes named 1, 2 and
3 which represent the position of the camera. The blue box representation
changes according to the rotation of the mobile phone. </p> <p>The boxes shown
in the above diagram is for illustrative purpose, so that it can be down scaled
for viewfinder image size. The total panorama coverage area box is estimated
by the number of images for capturing and the overlapping area size. </p> <p>The
code snippets below shows the <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html"><code class="apiname">CVFTracker</code></a> tracking. </p> <pre class="codeblock">

    _LIT(KFileOutput, "c:\\ICLExample\\viewfinder%d.mbm");
    _LIT(KFileCapturedImage, "c:\\ICLExample\\pancapture%d.jpg");
    TInt i = 0;

    TSize imageSize(1200,1000);
 CFbsBitmap* bmp = new (ELeave) CFbsBitmap;
 CleanupStack::PushL(bmp);

    // get 1st viewfinder image from camera into bmp (detail excluded)
             TSize bmpSize = bmp-&gt;SizeInPixels();

       CPanoramaTransform* panTrans = CPanoramaTransform::NewL();//create panorama transoform
       CleanupStack::PushL(panTrans);

       CVFTracker* vfTracker = CVFTracker::NewL(); //create VFTracker and load the plugin
       CleanupStack::PushL(vfTracker);
        
       vfTracker-&gt;InitializeL(bmpSize); //Create VFTracker and set size

       CImagePanorama* panImage = CImagePanorama::NewL(); //create CImagePanorama object
       CleanupStack::PushL(panImage);
        
       TDirection direction = EPanoramaDirectionRight; //assign direction
        
    // Lens parameters or internal camera characteristics should be available for the 
    // specific camera module in use. Here we use default values.
       TPanoramaLens lens;
       panImage-&gt;InitializeL(imageSize, lens, direction); //initialise size, lens, direction and create panorama engine

    // get the first captured image from the camera as a starting point - its name is given in capturedFileName
       TFileName capturedFileName;
    capturedFileName.Format(KFileCapturedImage(),i);
       panImage-&gt;AddFileL(capturedFileName, *panTrans); //add the captured image

    do 
        {
        // give the next camera viewfinder image to the tracker    (details ommitted)
           vfTracker-&gt;RegisterImageL(*bmp, *panTrans); // register viewfinder image
        
        // check if we have a good overlap with the previous image
           if(vfTracker-&gt;IsTimeToCapture(direction, KPanoramaDefaultOverlap)) 
              {
              // capture the next image from the camera (details ommitted)
              capturedFileName.Format(KFileCapturedImage(),i);
            
                 panImage-&gt;AddFileL(capturedFileName, *panTrans); //add the captured image
                 vfTracker-&gt;Reset(); //reset the VFTracker object
              }         
        if ( err != KErrNone )  // some termination condition usually a signal from user
            {
            // no more viewfinder images
            break;
            }
        }
    while (1);    
    panImage-&gt;RenderL(KTestVFTOutputFileName); // render the stitched image
    CleanupStack::PopAndDestroy(4,bmp); //panTrans, vfTracker, panImage, bmp
</pre> <p>The <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html"><code class="apiname">CVFTracker</code></a> is passed each viewfinder
images which it checks and determines whether it is right time to capture
the next image. In return it provides translation information <code class="codeph">CPanoramaTransform::GetTranslation()</code> which
indicates the shift of the current viewfinder image. </p> <p>The extracted
information is used to draw the blue rectangle on the screen. If it is time
to capture, then it triggers the capturing function and restarts the <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-0D12EA24-3BF5-3BEA-B0EA-CEB89D49D352.html"><code class="apiname">CVFTracker</code></a> again
for next image. </p> <p> <strong>Note:</strong> The box representation is used in the
UI, to help you to take better panorama images. In addition a vibration effect
can be used to provide additional feedback on when to capture an image. For
example, when you sweep the mobile phone, it is in tracking mode so it vibrates.
When the mobile phone is ready to capture, the vibration stops to let you
know that it must be static for capturing an accurate second image. Then when
it vibrates again, you must rotate the mobile and until it stop. </p> </li>
<li id="GUID-C7848E42-74B4-56D2-BB7B-2F20A4D30D32"><a name="GUID-C7848E42-74B4-56D2-BB7B-2F20A4D30D32"><!-- --></a><p> <strong>User interface updating
details </strong> </p> <p>The UI design detail is shown in step by step process.
They are as follows: </p> <ul>
<li id="GUID-99D23225-ECF9-5A34-ADAA-4E0A2326D768"><a name="GUID-99D23225-ECF9-5A34-ADAA-4E0A2326D768"><!-- --></a><p>The total panorama coverage
area is divided into four different image areas: </p> <div class="figure" id="GUID-0808E657-6313-510C-9EB6-F4D49722229B"><img src="GUID-023D30F0-C1E8-5E09-92AD-C5A7963DCF70_d0e383179_href.jpg" /></div> </li>
<li id="GUID-D06A8B59-81EE-5420-A3AE-FB036B7CE3F4"><a name="GUID-D06A8B59-81EE-5420-A3AE-FB036B7CE3F4"><!-- --></a><p>When you choose to capture
a panorama image the following steps are performed. The first image is captured
at position 0. The UI looks as follows: </p> <div class="figure" id="GUID-A17F50EC-3241-56CA-B96A-59515EAF161B"><img src="GUID-C2D99C88-09C7-55FA-AF95-3F689BA27484_d0e383189_href.jpg" /></div> </li>
<li id="GUID-BF4A2D67-EF8D-5F72-B2C2-9DC79E319023"><a name="GUID-BF4A2D67-EF8D-5F72-B2C2-9DC79E319023"><!-- --></a><p>When you rotate the
mobile phone clockwise, the blue box moves to the right using the translation
information from <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-27BD164A-9283-3BE0-A0BF-A475539D86EA.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-27BD164A-9283-3BE0-A0BF-A475539D86EA.html"><code class="apiname">CPanoramaTransform</code></a>. At the same time the
vibrator is set on to give direct feedback for the tracking process. When
the blue box and the grey box (which represent the position to capture the
next image) coincide, the blue box turns into a filled blue box and the vibrator
stops. You then known that the next image is captured. At this moment the
camera must be steady. </p> <p>After second image is captured the blue box
is moving again and vibrator is set-on. The UI looks as follows: </p> <div class="figure" id="GUID-C6E583BB-EE47-52EE-BBFB-D7EE37156C12"><img src="GUID-B985B750-9B42-55ED-B7E4-41B06B44C365_d0e383206_href.jpg" /></div> <p>Again, you rotate the mobile clockwise until the two boxes coincide
and vibrator stops; third image then captured. After this, the UI looks as
follows: </p> <div class="figure" id="GUID-FD9D81DA-E675-5C9C-BA6E-4E7DCE6F46D9"><img src="GUID-9E12593C-38EF-5052-A2E8-0AB25EEFF4D0_d0e383214_href.jpg" /></div> <p>You rotate the mobile phone until the boxes coincide and the fourth
(last) image is captured. </p> <p> <strong>Note:</strong> If the mobile phone rotation
deviates from chosen (clockwise) direction or translates up and down, the
blue box indicates this, and you must correct the mobile phone for the wrong
movement. </p> <p>At this point the stitched image can be saved or you can
reset the camera, to create another panorama image: </p> <div class="figure" id="GUID-1A527BEA-0C50-5910-9525-75336C02B2C9"><img src="GUID-8E2303E9-DB60-5F38-A4D4-8BF8F7A1EF9F_d0e383231_href.jpg" /></div> </li>
</ul> </li>
</ol> <p><strong>Camera
calibration </strong> </p> <p>In order to produce good panorama images, the internal
characteristics of the camera is calibrated by the TPanoramaLens().
The lens parameter such as the distance, the focal length, the principal point,
the skew, the width and the height are called the intrinsic parameters. </p> <p>The
camera module supplier should be able to provide this information or there
are a number of tools to get the camera parameters. A free tool that can be
used is the calibration functions in <a href="http://en.wikipedia.org/wiki/Opencv" target="_blank">OpenCV</a>. Typically these tools need an input of images
of a special reference pattern, for example a checker board like grid, photographed
from many directions. From that the tools automatically generate all the desired
lens parameters. </p> </div>
</div></div></div><div class="footer"><p class="metadata">Last updated November 10th, 2009</p><hr /><div class="copy">© Nokia 2011.</div></div></body>
<!-- Mirrored from devlib.symbian.slions.net/s3/GUID-60DBA025-8FA0-5DF2-90D0-744A016998EE.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 06:14:54 GMT -->
</html>