
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<!-- Mirrored from devlib.symbian.slions.net/s3/GUID-3AF1F492-3D7D-5F8C-B1AE-16FBD8224775.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 06:03:08 GMT -->
<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="copyright" content="(C) Copyright 2011" /><meta name="DC.rights.owner" content="(C) Copyright 2011" /><meta name="DC.Type" content="concept" /><meta name="DC.Title" content="Resource Files" /><meta name="DC.Relation" scheme="URI" content="GUID-EA107811-240C-5F95-922B-7C042FA00A87" /><meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7" /><meta name="DC.Relation" scheme="URI" content="GUID-5072BE46-B1B4-5C3A-BF55-BEA7443E7657" /><meta name="DC.Relation" scheme="URI" content="GUID-324107D1-6E0B-56DD-BDC0-7296F688A9CF" /><meta name="DC.Relation" scheme="URI" content="GUID-D02B5AF1-B1C3-560D-9654-971A5CC1A904" /><meta name="DC.Relation" scheme="URI" content="GUID-C8BD333E-8384-534B-822B-F61B2F7C8B9F" /><meta name="DC.Relation" scheme="URI" content="GUID-F61D1710-2D52-5B9B-A25F-6DFA606DAC0F" /><meta name="DC.Format" content="XHTML" /><meta name="DC.Identifier" content="GUID-3AF1F492-3D7D-5F8C-B1AE-16FBD8224775" /><meta name="DC.Language" content="en" /><title>Resource
Files  </title><link href="css/s60/style.css" rel="stylesheet" type="text/css" /><link href="PLUGINS_ROOT/com.nokia.forum.library/css/category_design.html" rel="stylesheet" type="text/css" /></head><body><div class="body"><div class="contentLeft prTxt"><h1 class="pageHeading" id="GUID-3AF1F492-3D7D-5F8C-B1AE-16FBD8224775">Resource
Files </h1><div>
<p>Resource files contain data separated from executable code. The purpose
of using resource files are to define user interface components and store
localisable data. </p>
<p>The application framework defined by the Uikon Core expects features of
the application UI, such as menus, to be supplied in a resource file. The
framework reads these resources itself. Other user interface components, such
as dialogs, can also be easily created from resources, without the application
needing to use this API itself. </p>
<p>The API has two key concepts - resource file reader and resource component
reader. </p>
<div><h3 class="section-title">Resource file reader</h3> <p>Resource files contain data
in numbered resources. The resource file reader allows such files to be opened
and closed, and individual resources within them, as identified by symbolic
identifiers, to be read into binary descriptors. Data items are then extracted
from these descriptors using the resource component reader. </p> <p>The resource
file can be read using <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-AA6DEF11-6F23-3523-A9F7-F15DF918E1BA.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-AA6DEF11-6F23-3523-A9F7-F15DF918E1BA.html"><code class="apiname">RResourceFile</code></a>. </p> </div>
<div><h3 class="section-title">Resource component reader</h3> <p>A resource is defined
as a struct. Struct members can be simple, such as integers and strings, or
complex, such as other structs, or arrays of structs. The resource component
reader is used to read these struct members from a binary descriptor holding
the resource into C++ variables. The application must ensure that it places
the struct members into variables of appropriate types. </p> <p>The resource
component header information can be accessed using <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-B375D32E-1F91-30FA-8605-A2E163111F9A.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-B375D32E-1F91-30FA-8605-A2E163111F9A.html"><code class="apiname">TResourceReader</code></a>. </p> </div>
<div id="GUID-EA9C30E1-AB21-5042-9417-CFDE320C519D"><h3 class="section-title">Basic resource
file use</h3> <p>The basic concepts involved with using resource files
are as follows: </p> <ul>
<li id="GUID-67FFC98D-2829-5146-B4B6-5DEB3A4966BA"><a name="GUID-67FFC98D-2829-5146-B4B6-5DEB3A4966BA"><!-- --></a><p>In a resource file,
define structs or use appropriate pre-defined structs and then define resources
that use those structs. </p> </li>
<li id="GUID-C57BD780-2B6F-547F-B008-FAD1F51B565F"><a name="GUID-C57BD780-2B6F-547F-B008-FAD1F51B565F"><!-- --></a><p>Run the resource compiler
to produce both a generated header file and a resource file. The generated
header file defines the symbols which a program uses to refer to the resources. </p> </li>
</ul> <p>A program which requires a resource file then performs the following: </p> <ul>
<li id="GUID-6E6F8010-F264-5F28-A540-D122530C98ED"><a name="GUID-6E6F8010-F264-5F28-A540-D122530C98ED"><!-- --></a><p>Includes the generated
header file in the appropriate source file to get symbolic access to the IDs
of the resources contained within the file. </p> </li>
<li id="GUID-8E1FFF9C-6D4A-5926-AE9E-703E2B224F23"><a name="GUID-8E1FFF9C-6D4A-5926-AE9E-703E2B224F23"><!-- --></a><p>Opens a <code class="codeph">RResourceFile</code> object,
specifying the generated resource file name. </p> </li>
<li id="GUID-AB22B5E3-1C8E-5994-B4E4-28CCD62297BD"><a name="GUID-AB22B5E3-1C8E-5994-B4E4-28CCD62297BD"><!-- --></a><p>Reads any resource that
is required. The resource is identified by a symbolic ID which has been <code class="codeph">#define</code> d
as a number; the content of the resource is read into a binary descriptor,
derived from <code class="codeph">TDesC8</code>. </p> </li>
<li id="GUID-E743799B-77A2-51F6-AC73-1D8A9325FD5E"><a name="GUID-E743799B-77A2-51F6-AC73-1D8A9325FD5E"><!-- --></a><p>Converts the binary
descriptor into whatever target format is appropriate for the data in the
resource file. </p> </li>
<li id="GUID-83832E00-F8A1-5F42-80A7-AA29C11D1CFD"><a name="GUID-83832E00-F8A1-5F42-80A7-AA29C11D1CFD"><!-- --></a><p>Discards the descriptor,
if appropriate, when the binary descriptor has been fully converted into its
target format. </p> </li>
<li id="GUID-8E5F9573-7180-5E44-ABAD-53D4F9608E33"><a name="GUID-8E5F9573-7180-5E44-ABAD-53D4F9608E33"><!-- --></a><p>Closes the <code class="codeph">RResourceFile</code> when
all operations on the resource file are complete. </p> </li>
</ul> <p>The resource text can be changed and the resources recompiled without
altering or recompiling the C++ program. For example, to alter the language
used by text strings. </p> </div>
<div><h3 class="section-title">Resource File Interface</h3><p>Resource files contain data
in numbered resources. A resource file has the following format:</p><div class="figure" id="GUID-9CFB3B14-9C09-42E2-A87E-ED07BD2E7E36"><img src="GUID-FB479891-8788-5548-B875-A5C637EC2DE6_d0e220917_href.png" /></div><p>A resource file is generated from text input using the resource compiler.
The index can be used to efficiently find a resource given its numeric ID.
There can be 1 to 4095 resources in a resource file. Each resource contains
binary data whose length is determined by subtracting the start position of
the resource from the start of the next resource (or from the start of the
index, for the last resource in the file). </p><p> Functions for handling
resources in a resource file are encapsulated in the <code class="codeph">RResourceFile</code> class.
This class provides functions for: </p><div class="p"><ul>
<li><p>opening and closing the file</p></li>
<li><p>reading resources</p></li>
<li><p>support for using multiple resource files</p></li>
</ul></div><p>Generally, the process for reading a resource is to read it into
a buffer of sufficient length, analyse it and place its data into C++ classes.
Then, if appropriate, release the buffer.   </p><p>The <code class="codeph">TResourceReader</code> class
must be used to simplify the process of resource data analysis.  </p> </div>
<div id="GUID-3E43B598-5857-5660-B9F0-432FD9AC56AA"><h3 class="section-title">File types
in resource file usage</h3> <p>The file types involved in resource file
usage are defined in the following diagram: </p> <div class="figure" id="GUID-4C93BFC7-89BD-5E88-BA68-D6273F13BB8D"><img src="GUID-4A5A50EB-261E-5739-904E-1D14D1A6BAD9_d0e220963_href.png" /><p class="figure-title"><strong>Figure: </strong>              File types            </p></div> <p>These files work together as follows: </p> <ul>
<li id="GUID-CA9BB1F1-0535-5F18-9CD2-AC2C02DACE8D"><a name="GUID-CA9BB1F1-0535-5F18-9CD2-AC2C02DACE8D"><!-- --></a><p>the C++ compiler and
linker, together, take <code>.cpp</code> source files and produce <code>.exe</code> output
(or <code>.dll</code>, or <code>.app</code>, or another such
extension). </p> </li>
<li id="GUID-D1E44783-4179-5E25-9C2A-715E167E8177"><a name="GUID-D1E44783-4179-5E25-9C2A-715E167E8177"><!-- --></a><p>the resource compiler
takes a <code>.rss</code> source file containing <code class="codeph">RESOURCE</code> statements
and converts it into a <code>.rsc</code> resource file which contains
the resources the executable program will use. It also produces a <code>.rsg</code> generated
header file, which contains the symbolic IDs of these resources. </p> </li>
<li id="GUID-5E468821-D48B-5633-9801-F3ACFA96024C"><a name="GUID-5E468821-D48B-5633-9801-F3ACFA96024C"><!-- --></a><p>the <code>.rsg</code> file
is <code class="codeph">#include</code> d by the <code>.cpp</code> file, so that
the C++ compiler has access to the symbolic IDs of the resources that will
be used. </p> </li>
<li id="GUID-99F5E649-D5E6-59F0-A6F0-C51A52756FA7"><a name="GUID-99F5E649-D5E6-59F0-A6F0-C51A52756FA7"><!-- --></a><p>C++ class definitions
are specified in a <code>.h</code> file; a typical application will
include several system header files and usually one or more of its own. </p> </li>
<li id="GUID-84ED8144-AEBD-51CD-A9CE-240D143A773A"><a name="GUID-84ED8144-AEBD-51CD-A9CE-240D143A773A"><!-- --></a><p>resource structs are
specified in a <code>.rh</code> file. A typical application will use
system-provided resource headers, which define standard controls etc. Only
if the application requires its own structs, will it include its own <code>.rh</code> file. </p> </li>
<li id="GUID-BDDFAD1C-48FD-52F0-85A0-553CB2BAC5AA"><a name="GUID-BDDFAD1C-48FD-52F0-85A0-553CB2BAC5AA"><!-- --></a><p>flag values are <code class="codeph">#define</code> d
in a file which must be available to both the C++ compiler and the resource
compiler: the <code>.hrh</code> extension is used for this and <code>.hrh</code> files
are typically <code class="codeph">#include</code> d into the <code>.h</code> file
that defines the classes (for C++) and the <code>.rh</code> file that
defines the structs (for the resource compiler). </p> </li>
</ul> </div>
<div id="GUID-41C5ABE7-C081-5259-9814-0436844C85AD"><h3 class="section-title">Type safety
issues</h3> <p>Software systems implemented in C++ are designed to be type-safe.
Proper use of header files, make utilities, type declarations, classes and
templates makes it difficult to pass data of the wrong type to functions,
to assign data of the wrong type to variables, or to construct a program whose
modules are inconsistent with one another. Thus a major source of programming
errors is detected while the program is being built, before running it. </p> <p>A
program which uses resources must have a resource file which matches that
program's requirements. However, the resource file and the executable program
are only loosely bound together. A variety of errors are possible while dealing
with resources, which cannot be detected during the build process. Programmers
should be aware of these and take appropriate measures to avoid them. </p> <p>Additional
sources of error include: </p> <ul>
<li id="GUID-C08B03AF-E50C-577A-90F7-1462B223E9D0"><a name="GUID-C08B03AF-E50C-577A-90F7-1462B223E9D0"><!-- --></a><p>Having a program and
resource file which do not correspond. </p> <p>This can arise because the
resource file formats were updated, or the program was updated, but the resource
file was not updated. When the program is run, the resources it loads are
in the wrong format. </p> </li>
<li id="GUID-81AB0840-8122-5C34-9DE9-A10DCB02E39D"><a name="GUID-81AB0840-8122-5C34-9DE9-A10DCB02E39D"><!-- --></a><p>The structures in the
resource file may be of a different format from that expected by the C++ program. </p> <p>If
the C++ program expects a <code class="codeph">LONG</code> while a <code class="codeph">WORD</code> is
present in the resource file, then the C++ program will read two extra bytes
from the data item in the resource file. Any subsequent data read from that
resource will be an error. </p> <p>This kind of error can only be avoided
by C++ programs knowing which structs they are dealing with, knowing the data
layouts of those structs in a resource file and writing code which works in
that context. </p> </li>
<li id="GUID-E61214E6-9FC8-5A6E-8EEC-452FF135A89C"><a name="GUID-E61214E6-9FC8-5A6E-8EEC-452FF135A89C"><!-- --></a><p>Having resources of
unexpected type. </p> <p>The most likely reason for this to arise is because
there is no type safety in the resource compiler. Thus, it is possible for
a programmer to wrongly guess what kind of struct a particular resource must
use. Appropriate comments in the <code>.rh</code> files and the documentation
of the resource file, will help to reduce this kind of error. </p> </li>
</ul> <p>The resource compiler does provide some elementary safety features: </p> <ul>
<li id="GUID-736C2471-93C2-5AD6-8E73-CBA30DF5C6C0"><a name="GUID-736C2471-93C2-5AD6-8E73-CBA30DF5C6C0"><!-- --></a><p>All resources are represented
by a symbolic ID. This ensures that the resource IDs used by the C++ program
and those expected by the compiler match, if the recommended build procedures
are followed. </p> </li>
<li id="GUID-8DE5ABAE-2504-5DC9-BDCC-70C8ABF806AA"><a name="GUID-8DE5ABAE-2504-5DC9-BDCC-70C8ABF806AA"><!-- --></a><p>Flag values, maximum
length constants and some other values, may be defined in a <code>.hrh</code> file.
This ensures that C++ programs uses correct resource. </p> </li>
</ul> </div>
</div><h3>Related tasks</h3><ul><li><a href="GUID-EA107811-240C-5F95-922B-7C042FA00A87.html">Reading a
string resource</a></li></ul></div></div><div class="footer"><p class="metadata">Last updated October 20th, 2009</p><hr /><div class="copy">© Nokia 2011.</div></div></body>
<!-- Mirrored from devlib.symbian.slions.net/s3/GUID-3AF1F492-3D7D-5F8C-B1AE-16FBD8224775.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 06:03:09 GMT -->
</html>