
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<!-- Mirrored from devlib.symbian.slions.net/s3/GUID-A97AD7EB-43C2-545A-9756-57D65A4905D9.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 05:52:20 GMT -->
<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="copyright" content="(C) Copyright 2011" /><meta name="DC.rights.owner" content="(C) Copyright 2011" /><meta name="DC.Type" content="concept" /><meta name="DC.Title" content="How to create a basic animation" /><meta name="DC.Relation" scheme="URI" content="GUID-829761B6-ECF7-5E15-A475-AEE357687067" /><meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7" /><meta name="DC.Relation" scheme="URI" content="GUID-94005A46-B4C6-4A30-A8E8-1B9C2D583D50" /><meta name="DC.Relation" scheme="URI" content="GUID-E079315A-E5B6-4D33-B7E3-88697A3F11A4" /><meta name="DC.Relation" scheme="URI" content="GUID-16E7CF5D-4364-5F42-94FF-9F79BB52523D" /><meta name="DC.Format" content="XHTML" /><meta name="DC.Identifier" content="GUID-A97AD7EB-43C2-545A-9756-57D65A4905D9" /><meta name="DC.Language" content="en" /><title>How to create a basic animation </title><link href="css/s60/style.css" rel="stylesheet" type="text/css" /><link href="PLUGINS_ROOT/com.nokia.forum.library/css/category_design.html" rel="stylesheet" type="text/css" /></head><body><div class="body"><div class="contentLeft prTxt"><h1 class="pageHeading" id="GUID-A97AD7EB-43C2-545A-9756-57D65A4905D9">How to create a basic animation</h1><div><p>The animation framework provides a concrete implementation of the <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-40CEAB8C-2202-3E88-929F-35DA5BD554A4.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-40CEAB8C-2202-3E88-929F-35DA5BD554A4.html"><code class="apiname">CAnimation</code></a> class called CBasicAnimation class to create a basic client-side animation. A basic client-side animation needs data, which can range from a simple file to a complex data structure. The data provider is responsible for handling this data and cater to the needs of the animation whenever required. The CICLAnimationDataProvider class acts as a data provider and handles the data needed for any type of animation. </p> <p>To create a basic client-side animation, create an object of the <code class="codeph">CICLAnimationDataProvider</code> class. Associate the data required for the animation with the data provider object. In the example used below, the data needed for the animation is a simple animated <code>GIF</code> file. </p> <p>The following code shows how to create a data provider object and associate a <code>GIF</code> file with it: </p> <pre class="codeblock">//Path to the GIF file
_LIT(KAnimExGuitarPlayer,"Z:\\resource\\apps\\AnimExample\\GuitarPlayer.gif");

//Creating the data provider object and setting the GIF file using the string literal created above.
//The iEikonEnv macro is used to open a session with the file system, before setting the GIF file to the data provider. 
CICLAnimationDataProvider* basicDataProvider = new (ELeave)CICLAnimationDataProvider;
basicDataProvider-&gt;SetFileL(iEikonEnv-&gt;FsSession(), KAnimExGuitarPlayer());</pre> <p>Now that the data provider object is ready with the required data, you can create an object of <code class="codeph">CBasicAnimation</code> class. The control and behaviour for the animation is defined using the <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-7B02B3D6-D460-3274-8CE6-839549E6EFD3.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-7B02B3D6-D460-3274-8CE6-839549E6EFD3.html"><code class="apiname">TAnimationConfig</code></a> class. You should create such an object and provide it to the animation. The behaviour of the animation can be set to any of the following: </p> <ul><li id="GUID-9A2A1585-3D12-5FFE-8F73-069A5848B5FA"><a name="GUID-9A2A1585-3D12-5FFE-8F73-069A5848B5FA"><!-- --></a><p>Play in a loop: Set the <code class="codeph">iFlags</code> variable of the <code class="codeph">TAnimationConfig</code> class to <code class="codeph">ELoop</code>, and set the number of cycles the animation should complete using the <code class="codeph">iData</code> variable. If you want the animation to be played for an indefinite number of cycles, set <code class="codeph">iData</code> to <code class="codeph">-1</code>. </p> </li> <li id="GUID-F554156C-6481-5E8E-AADA-3DA956BB29B4"><a name="GUID-F554156C-6481-5E8E-AADA-3DA956BB29B4"><!-- --></a><p>Play immediately: Set the <code class="codeph">iFlags</code> variable of the <code class="codeph">TAnimationConfig</code> class to <code class="codeph">EStartImmediately</code>. By default, the animations will wait till the data is loaded completely. </p> </li> <li id="GUID-A5DF5715-5A9F-5EC5-A1D7-7309B2FA2174"><a name="GUID-A5DF5715-5A9F-5EC5-A1D7-7309B2FA2174"><!-- --></a><p>Play only specified number of frames: Set the <code class="codeph">iFlags</code> variable of the <code class="codeph">TAnimationConfig</code> class to <code class="codeph">ECountFrames</code>, and set the number of frames the animation should play using the <code class="codeph">iData</code> variable. </p> </li> <li id="GUID-0A7DC95B-0ECC-597E-9008-132C9E67DC95"><a name="GUID-0A7DC95B-0ECC-597E-9008-132C9E67DC95"><!-- --></a><p>Stop the animation at the last frame: Set the <code class="codeph">iFlags</code> variable of the <code class="codeph">TAnimationConfig</code> class to <code class="codeph">EEndOnLastFrame</code>. By default, when animations stop they return to the first frame. </p> </li> </ul> <p>In this case, the animation is configured to play in an infinite loop. </p> <p>The following code shows how to create and start a basic client-side animation. It loads an animated <code>GIF</code> file and plays it in an infinite loop : </p> <pre class="codeblock">//Integer constant defining the X and Y co-ordinates of the animation
const TInt KAnimExBasicPositionX = 300;
const TInt KAnimExBasicPositionY = 100;
TPoint position = TPoint(KAnimExBasicPositionX, KAnimExBasicPositionY);

//configure the animation to play in an infinite loop
TAnimationConfig config;
config.iFlags = TAnimationConfig::ELoop;
config.iData = -1;

//Creating the basic animation object using the data provider object and the X and Y coordinates defined above
iBasicAnim = CBasicAnimation::NewL(basicDataProvider,position, iEikonEnv-&gt;WsSession(), Window());        

//Starting the animation using the configuration created above
iBasicAnim-&gt;Start(config);</pre> <p>The animation will be visible only when it is rendered to the window. To do so, implement a private virtual member function of <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-B06F99BD-F032-3B87-AB26-5DD6EBE8C160.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-B06F99BD-F032-3B87-AB26-5DD6EBE8C160.html"><code class="apiname">CCoeControl</code></a> class called <code class="codeph">Draw()</code> in your client application view class. This function should in-turn call the CBasicAnimation::Draw function by passing the windows graphics context as an argument. </p> <p>The following code shows how to draw the animation to the window: </p> <pre class="codeblock">void CClientAppView::Draw(const TRect&amp;) const
{
    
    CWindowGc&amp; gc = SystemGc();    
    if( iBasicAnim )
        {
        iBasicAnim-&gt;Draw( gc );    
        }
}</pre> <p> <em>Note that you should include proper error checks in the given code before using it for production.</em> </p> <p>When a new frame is required for the animation, the entire window or an area within in the window need to be redrawn using the <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-683603DD-F3D3-3193-BEB3-8236C7DE7F79.html#GUID-28202F81-52FE-30F5-8B8C-ABED0915822E"><code class="apiname">RWindow::Invalidate()</code></a> function. This function will force a client redraw. </p> <p>This code creates a client-side animation which loads an animated <code>GIF</code> file and plays it in an infinite loop. </p> </div><h3>Related concepts</h3><ul><li><a href="GUID-829761B6-ECF7-5E15-A475-AEE357687067.html">Animation
                overview</a></li></ul></div></div><div class="footer"><p class="metadata">Last updated October 8th, 2009</p><hr /><div class="copy">Â© Nokia 2011.</div></div></body>
<!-- Mirrored from devlib.symbian.slions.net/s3/GUID-A97AD7EB-43C2-545A-9756-57D65A4905D9.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 05:52:20 GMT -->
</html>