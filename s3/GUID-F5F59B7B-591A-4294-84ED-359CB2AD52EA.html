
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<!-- Mirrored from devlib.symbian.slions.net/s3/GUID-F5F59B7B-591A-4294-84ED-359CB2AD52EA.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 06:16:24 GMT -->
<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="copyright" content="(C) Copyright 2011" /><meta name="DC.rights.owner" content="(C) Copyright 2011" /><meta name="DC.Type" content="task" /><meta name="DC.Title" content="Writing to NFC Forum Type 1, 2, 3 Tags" /><meta name="abstract" content="This tutorial describes how to write data to NFC Forum Type 1, Type 2 and Type 3 tags." /><meta name="description" content="This tutorial describes how to write data to NFC Forum Type 1, Type 2 and Type 3 tags." /><meta name="DC.Relation" scheme="URI" content="GUID-3DC13AA4-6CC8-45CA-8FF8-8B222DFFC00B" /><meta name="DC.Relation" scheme="URI" content="GUID-0039F43D-82BF-438D-A394-1DEC44797D95" /><meta name="DC.Relation" scheme="URI" content="GUID-B6BDE53C-A583-4CC1-B8B9-5A1BBA59C8B1" /><meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7" /><meta name="DC.Relation" scheme="URI" content="GUID-76C9285D-5C89-4CBC-AB05-F14D6A95BC90" /><meta name="DC.Relation" scheme="URI" content="GUID-7A72B008-901E-454D-AD93-F99555CA904A" /><meta name="DC.Relation" scheme="URI" content="GUID-D2E1F93F-5320-4CDA-A760-86B9146620A3" /><meta name="DC.Format" content="XHTML" /><meta name="DC.Identifier" content="GUID-F5F59B7B-591A-4294-84ED-359CB2AD52EA" /><meta name="DC.Language" content="en" /><title>Writing to NFC Forum Type 1, 2, 3 Tags </title><link href="css/s60/style.css" rel="stylesheet" type="text/css" /><link href="PLUGINS_ROOT/com.nokia.forum.library/css/category_design.html" rel="stylesheet" type="text/css" /></head><body><div class="body"><div class="contentLeft prTxt"><h1 class="pageHeading" id="GUID-F5F59B7B-591A-4294-84ED-359CB2AD52EA">Writing to NFC Forum Type 1, 2, 3 Tags</h1><div><p>This tutorial describes how to write data to NFC Forum
Type 1, Type 2 and Type 3 tags.</p>
<div id="GUID-BBEE7DE5-26BA-498E-A947-51C1C99237BF"><h3 class="section-title">Context</h3><p>The NFC
Tag Extension API provides access to different types of tags. An instance
of a connection class is created and is passed to <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4278615F-1C20-31D7-87D4-996F988B732B.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4278615F-1C20-31D7-87D4-996F988B732B.html"><code class="apiname">MNfcTag</code></a> object which activates the connection. On activating the connection,
the tags can be accessed for writing data.</p></div><div id="GUID-1EFBD294-9EB4-4BA4-B2C3-C1260E4EE708"><h3 class="section-title">Prerequisites</h3><p>Before you
begin, refer to the following: </p><ul>
<li><p><a href="GUID-B6BDE53C-A583-4CC1-B8B9-5A1BBA59C8B1.html#GUID-CC637278-AD88-40BD-A99D-A65E1875B3BF">NFC Forum Tags</a></p></li>
<li><p>nfcconnection.h, <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-58818925-6366-30DB-8DEE-68AD60A34FE0.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-58818925-6366-30DB-8DEE-68AD60A34FE0.html"><code class="apiname">MNfcConnection</code></a></p></li>
<li><p>nfctype1connection.h, <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-6D102F2B-F74B-3B80-B244-C8BF902449B4.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-6D102F2B-F74B-3B80-B244-C8BF902449B4.html"><code class="apiname">CNfcType1Connection</code></a></p></li>
<li><p>nfctype2connection.h, <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-CDE7C968-FA04-368D-9189-00AEC2BE0B24.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-CDE7C968-FA04-368D-9189-00AEC2BE0B24.html"><code class="apiname">CNfcType2Connection</code></a></p></li>
<li><p>nfctype3connection.h, <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-2B1CEAFC-83C3-3D63-B347-46ADF6B40BFE.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-2B1CEAFC-83C3-3D63-B347-46ADF6B40BFE.html"><code class="apiname">CNfcType3Connection</code></a></p></li>
<li><p>nfctag.h, <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4278615F-1C20-31D7-87D4-996F988B732B.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4278615F-1C20-31D7-87D4-996F988B732B.html"><code class="apiname">MNfcTag</code></a></p></li>
</ul></div>
<h3>Steps</h3><ol id="GUID-4DD07DEC-6017-4237-BE46-1D69E5FBD744-GENID-GUID-E2AADF6C-23E2-4806-8D1D-6A9A2AFC796E"><a name="GUID-4DD07DEC-6017-4237-BE46-1D69E5FBD744-GENID-GUID-E2AADF6C-23E2-4806-8D1D-6A9A2AFC796E"><!-- --></a>
<li id="GUID-9A69E5AD-E938-4092-A8C2-CB65C37C8962-GENID-GUID-E2AADF6C-23E2-4806-8D1D-6A9A2AFC796E"><a name="GUID-9A69E5AD-E938-4092-A8C2-CB65C37C8962-GENID-GUID-E2AADF6C-23E2-4806-8D1D-6A9A2AFC796E"><!-- --></a><p>Follow the
steps in <a href="GUID-B961F4BB-ABF3-442E-A6E9-7AB103E9CAA6.html">Discovering
NFC Tags</a> to detect the type 1 tag.</p>
</li>
<li id="GUID-9612878A-7130-46C8-9910-D9A71EB3BC10"><a name="GUID-9612878A-7130-46C8-9910-D9A71EB3BC10"><!-- --></a><p>Create a
new instance of the specific tag class.</p>
<ul>
<li><div class="p"><strong>Tag Type 1</strong>: Create a new instance of <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-6D102F2B-F74B-3B80-B244-C8BF902449B4.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-6D102F2B-F74B-3B80-B244-C8BF902449B4.html"><code class="apiname">CNfcType1Connection</code></a> class. For example, <pre class="codeblock">CNfcType1Connection* Type1Connection;
Type1Connection = CNfcType1Connection::NewL(iNfcServer);</pre></div></li>
<li><div class="p"><strong>Tag Type 2</strong>: Create a new instance of <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-CDE7C968-FA04-368D-9189-00AEC2BE0B24.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-CDE7C968-FA04-368D-9189-00AEC2BE0B24.html"><code class="apiname">CNfcType2Connection</code></a> class. For example, <pre class="codeblock">CNfcType2Connection* Type2Connection;
Type2Connection = CNfcType2Connection::NewL(iNfcServer);</pre></div></li>
<li><div class="p"><strong>Tag Type 3</strong>: Create a new instance of <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-2B1CEAFC-83C3-3D63-B347-46ADF6B40BFE.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-2B1CEAFC-83C3-3D63-B347-46ADF6B40BFE.html"><code class="apiname">CNfcType3Connection</code></a> class. For example, <pre class="codeblock">CNfcType3Connection* Type3Connection;
Type3Connection = CNfcType3Connection::NewL(iNfcServer);</pre></div></li>
</ul>
</li>
<li id="GUID-6EB403D5-85EC-4EDE-9F9F-792154C3228C"><a name="GUID-6EB403D5-85EC-4EDE-9F9F-792154C3228C"><!-- --></a><p>Open the
connection to the tag using <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-4278615F-1C20-31D7-87D4-996F988B732B.html#GUID-E2A1B6F0-8544-3D7A-BCA0-54212098A7F7"><code class="apiname">MNfcTag::OpenConnection()</code></a> and pass the instance of the tag class.</p>
<p>For example for the Type 1 tag:</p><pre class="codeblock">MNfcTag* iTag; 
iTag-&gt;OpenConnection(*Type1Connection);       </pre>
</li>
<li id="GUID-33A87653-5685-4851-9BF7-94355E3C5029"><a name="GUID-33A87653-5685-4851-9BF7-94355E3C5029"><!-- --></a><p>Write data
to the tags using the specific tag methods .</p>
<div class="note"><p><strong class="note_title">Note: </strong>Only one write command can be requested at a time
for a specific type of tag.</p></div>
<ul>
<li><p><strong>Type 1 Tag</strong>: Write data to Type 1 tag using <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-6D102F2B-F74B-3B80-B244-C8BF902449B4.html#GUID-B2C3AB7C-18E7-31D6-BA9E-92840C42F6D1"><code class="apiname">CNfcType1Connection::Write()</code></a>. </p><pre class="codeblock">void CMyTagInitializer::Type1WriteL()
{
	_LIT8(KSendText,"class1TagData"); 
  iWriteBuffer.ReAlloc(KSendText().Size()); 
  
	//Specify the block address
  TInt block = 0; 
  
  //Specify the byte address
	TInt byte = 6;    
  
	TNfcType1Address address(byte, block); 
  iWriteBuffer = KSendText;       
	 
  //Write data to the target NFC Forum Type 1 tag.
  iNfcType1Connection-&gt;Write( iWriteWait-&gt;iStatus, iWriteBuffer, address );    
  iWriteWait-&gt;SetActive(); 
}</pre></li>
<li><p><strong>Type 2 Tag</strong>: Write data to Type 2 tag using <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-CDE7C968-FA04-368D-9189-00AEC2BE0B24.html#GUID-EE052CBE-933C-37E2-A696-0B904291CDBB"><code class="apiname">CNfcType2Connection::Write()</code></a>. </p><pre class="codeblock">void CMyTagInitializer::Type2WriteL()
{
	_LIT8(KSendText,"class2TagData"); 
  iWriteBuffer.ReAlloc(KSendText().Size()); 
  
	//Specify the block address
  TInt block = 0; 
  
  //Specify the byte address
	TInt byte = 6;    
  
	TNfcType2Address address(byte, block); 
  iWriteBuffer = KSendText;       
	 
  //Write data to the target NFC Forum Type 2 tag.
  iNfcType2Connection-&gt;Write( iWriteWait-&gt;iStatus, iWriteBuffer, address );    
  iWriteWait-&gt;SetActive(); 
}</pre></li>
<li><p><strong>Type 3 Tag</strong>: Write data to Type 3 tag using <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-2B1CEAFC-83C3-3D63-B347-46ADF6B40BFE.html#GUID-AF2C7E9F-75B0-3DB1-A913-E840DFB3C1E3"><code class="apiname">CNfcType3Connection::Update()</code></a>. </p><pre class="codeblock">void CMyTagInitializer::UpdateClass3Tag()
{
	_LIT8(KSendText,"class2TagData"); 
  iWriteBuffer.ReAlloc(KSendText().Size()); 
  
	//Specify the block address
  TInt block = 0; 
  
  //Specify the byte address
	TInt byte = 6;    
  
  //Specify the servicecode address.
	TInt service = 11;	

  TNfcType2Address address(byte, block, service); 
  iWriteBuffer = KSendText;       
	 
  //Write data to the target NFC Forum Type 2 tag.
  iNfcType3Connection-&gt;Update( iWriteWait-&gt;iStatus, iWriteBuffer, address );    
  iWriteWait-&gt;SetActive(); 
}</pre></li>
</ul><div class="note"><p><strong class="note_title">Note: </strong>The <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-D283C457-DD37-366E-866F-8620494A3599.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-D283C457-DD37-366E-866F-8620494A3599.html"><code class="apiname">TNfcType1Address</code></a>, <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-FFF0FED5-8AE5-37DC-BB28-A3A2D6F0E758.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-FFF0FED5-8AE5-37DC-BB28-A3A2D6F0E758.html"><code class="apiname">TNfcType2Address</code></a> and <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-910B80CA-DF08-3BA1-8A1E-F49684D8457F.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-910B80CA-DF08-3BA1-8A1E-F49684D8457F.html"><code class="apiname">TNfcType3Address</code></a> are helper classes which
provides access to manage NFC Forum Type 1, Type 2 and Type 3 addresses
respectively.</p></div>
<p>The sequence diagram below illustrates how writing to a tag
works:</p><div class="figure" id="GUID-1F406422-2317-4655-AE67-A67D9D0B963D"><img src="GUID-5BD8FCFD-BAB1-472B-8056-DD43A93640C8_d0e417075_href.png" /></div>
</li>
</ol>
</div><h3>Related concepts</h3><ul><li><a href="GUID-B6BDE53C-A583-4CC1-B8B9-5A1BBA59C8B1.html">NFC
Services Concepts</a></li></ul><h3>Related tasks</h3><ul><li><a href="GUID-3DC13AA4-6CC8-45CA-8FF8-8B222DFFC00B.html">Exchanging
Data with NFC Forum Type 4 Tag</a></li><li><a href="GUID-0039F43D-82BF-438D-A394-1DEC44797D95.html">Reading
NFC Forum Type 1, 2, 3 Tags</a></li></ul></div></div><div class="footer"><p class="metadata">Last updated December 14th, 2010</p><hr /><div class="copy">© Nokia 2011.</div></div></body>
<!-- Mirrored from devlib.symbian.slions.net/s3/GUID-F5F59B7B-591A-4294-84ED-359CB2AD52EA.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 06:16:25 GMT -->
</html>