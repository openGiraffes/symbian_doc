
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<!-- Mirrored from devlib.symbian.slions.net/s3/GUID-5107ABD8-6408-5501-8073-ACAF3719247B.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 06:07:08 GMT -->
<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="copyright" content="(C) Copyright 2011" /><meta name="DC.rights.owner" content="(C) Copyright 2011" /><meta name="DC.Type" content="concept" /><meta name="DC.Title" content="Resizable buffer descriptors" /><meta name="abstract" content="Describes descriptor behaviour and resizable buffer descriptors." /><meta name="description" content="Describes descriptor behaviour and resizable buffer descriptors." /><meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7" /><meta name="DC.Relation" scheme="URI" content="GUID-E3D2A6ED-8192-563D-8966-DD96B3AF1783" /><meta name="DC.Relation" scheme="URI" content="GUID-0DF9E318-BE97-531E-AB39-A7B5E8787C87" /><meta name="DC.Relation" scheme="URI" content="GUID-A63025D1-7FD4-5120-8A1F-537D6B70103D" /><meta name="DC.Relation" scheme="URI" content="GUID-DBF88873-21B1-5493-8EBF-C9071D314A09" /><meta name="DC.Relation" scheme="URI" content="GUID-11EEFB3D-0414-5BEB-9D78-56A4B9154008" /><meta name="DC.Relation" scheme="URI" content="GUID-4C4B6098-38B4-5BD0-8E58-712511EBE074" /><meta name="DC.Format" content="XHTML" /><meta name="DC.Identifier" content="GUID-5107ABD8-6408-5501-8073-ACAF3719247B" /><meta name="DC.Language" content="en" /><title>Resizable buffer descriptors </title><link href="css/s60/style.css" rel="stylesheet" type="text/css" /><link href="PLUGINS_ROOT/com.nokia.forum.library/css/category_design.html" rel="stylesheet" type="text/css" /></head><body><div class="body"><div class="contentLeft prTxt"><h1 class="pageHeading" id="GUID-5107ABD8-6408-5501-8073-ACAF3719247B">Resizable buffer descriptors</h1><div><p>Describes descriptor behaviour and resizable buffer descriptors.</p>
<p>A resizable buffer descriptor provides a buffer, allocated on the
heap, to contain and access data. The data is not part of the descriptor
object. </p>
<p>The data represented by this descriptor can be both accessed and
changed through the descriptor itself. Data is accessed through functions
provided by the base class. The size of the buffer used by this descriptor
can also be changed. Note that unlike dynamic buffers, reallocation
is not done automatically; the descriptor provides an API that allows
you to do reallocation. </p>
<p>The descriptor has similarities to the standard heap descriptor, <code class="codeph">HBufC</code>, but is <em>easier to use</em>. The standard heap descriptor
is recommended for use when the data it represents rarely changes.
The resizable buffer descriptor is recommended for use when the data
changes frequently. </p>
<p>This descriptor also has the following additional useful behaviour: </p>
<ul>
<li id="GUID-A40D7342-C864-51A3-B53B-DA73988501C2"><a name="GUID-A40D7342-C864-51A3-B53B-DA73988501C2"><!-- --></a><p>ownership of
an existing heap descriptor can be transferred to a resizable buffer
descriptor. </p> </li>
<li id="GUID-63EA50EE-1DD4-5ABE-9676-0347E95F07CA"><a name="GUID-63EA50EE-1DD4-5ABE-9676-0347E95F07CA"><!-- --></a><p>ownership of
memory that has already been allocated elsewhere can be transferred
to a resizable buffer descriptor; this memory becomes the buffer used
by the descriptor. </p> </li>
<li id="GUID-D16CAA95-26A4-5B45-AEA2-58DDB28F16CB"><a name="GUID-D16CAA95-26A4-5B45-AEA2-58DDB28F16CB"><!-- --></a><p>ownership of
memory owned by a resizable buffer descriptor can be transferred to
another resizable buffer descriptor. </p> </li>
</ul>
<p>The important point is that the user of the class need not be concerned
about the 'origins' of the memory. </p>
<p>A resizable buffer descriptor is supplied in two variants: </p>
<ul>
<li id="GUID-017A1851-A5FE-5179-87BC-0F0BF748761A"><a name="GUID-017A1851-A5FE-5179-87BC-0F0BF748761A"><!-- --></a><p>a 16-bit variant,
a <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-BEFF9C91-DA64-3032-96E8-F5054405DC74.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-BEFF9C91-DA64-3032-96E8-F5054405DC74.html"><code class="apiname">RBuf16</code></a>, to contain wide strings, and 16-bit wide
data. </p> </li>
<li id="GUID-55A2D978-C16A-58E7-BE55-9CB681484473"><a name="GUID-55A2D978-C16A-58E7-BE55-9CB681484473"><!-- --></a><p>an 8-bit variant,
a <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-955061A8-A83E-39E5-8745-8FAC7DEA7BCC.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-955061A8-A83E-39E5-8745-8FAC7DEA7BCC.html"><code class="apiname">RBuf8</code></a>, to contain narrow strings and binary data. </p> </li>
</ul>
<p>There is also a build independent type, <code class="codeph">RBuf</code>.
This is the type that is most commonly used in program code; this
is set (i.e. typedef) to the appropriate 'real' variant at build time,
and by default equates to <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-BEFF9C91-DA64-3032-96E8-F5054405DC74.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-BEFF9C91-DA64-3032-96E8-F5054405DC74.html"><code class="apiname">RBuf16</code></a>. </p>
<p>You would use an explicit 8-bit variant for binary data. An explicit
16-bit variant is rarely used. </p>
<p>When discussing a resizable buffer descriptor, we normally refer
to <code class="codeph">RBuf</code>, rather than <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-955061A8-A83E-39E5-8745-8FAC7DEA7BCC.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-955061A8-A83E-39E5-8745-8FAC7DEA7BCC.html"><code class="apiname">RBuf8</code></a> or <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-BEFF9C91-DA64-3032-96E8-F5054405DC74.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-BEFF9C91-DA64-3032-96E8-F5054405DC74.html"><code class="apiname">RBuf16</code></a>. We only refer to <code class="codeph">RBuf8</code> or <code class="codeph">RBuf16</code> when they explicitly need to be used. </p>
<p>The following drawing shows how an <code class="codeph">RBuf</code> type is
constructed. It is derived from TDes and TDesC; the member data of these base classes hold the length
and maximum length for the descriptor data. <code class="codeph">RBuf</code> itself
only contains a single pointer. The pointer is interpreted
in one of two ways, depending on how its buffer has been set up: </p>
<ul>
<li id="GUID-8EB79399-9FAF-5CFE-9542-C015215B0D8D"><a name="GUID-8EB79399-9FAF-5CFE-9542-C015215B0D8D"><!-- --></a><p>as a simple
pointer to memory on the heap. </p> </li>
<li id="GUID-645528B9-2786-59E1-9F6F-7DD875AE1B1E"><a name="GUID-645528B9-2786-59E1-9F6F-7DD875AE1B1E"><!-- --></a><p>as a pointer
to a previously created <code class="codeph">HBufC</code> heap descriptor; ownership
of the <code class="codeph">HBufC</code> descriptor buffer will have been transferred
to the <code class="codeph">RBuf</code>. </p> </li>
</ul>
<p>The way descriptors in Symbian platform are implemented allows <code class="codeph">RBuf</code> to distinguish between the two. </p>
<p>The following drawing shows the internal representation of an <code class="codeph">RBuf</code> object initialised with a string of five characters
representing the English word "Hello". There are two possibilities: </p>
<ul>
<li id="GUID-3934910A-431A-582A-A117-3B1C497CE880"><a name="GUID-3934910A-431A-582A-A117-3B1C497CE880"><!-- --></a><p>the case where
the buffer consists of simple memory, either allocated directly by
the object itself, or assigned to it after having been allocated elsewhere. </p> </li>
<li id="GUID-5AD86C97-66DF-5B88-95D7-2169D4CFD8A2"><a name="GUID-5AD86C97-66DF-5B88-95D7-2169D4CFD8A2"><!-- --></a><p>the case where
the buffer was originally allocated as a standard heap descriptor,
a HBufC type, and whose ownership has been transferred. </p> </li>
</ul>
<p>Remember that <code class="codeph">RBuf</code> is derived from both <code class="codeph">TDes</code> and <code class="codeph">TDesC</code>, and these classes provide
the data members the contain the maximum length and the current length
of the data. </p>
<div class="figure" id="GUID-50810FFC-9A97-5EC1-B6A6-7E371AEC9FF6"><img src="GUID-2F0008EB-715C-50EC-87AD-C78619F44858_d0e281863_href.png" /></div>
<p>While an <code class="codeph">RBuf</code> descriptor has similarities to a
heap descriptor, it behaves more like a standard 'R' type resource
class, i.e. as a handle to a real resource maintained elsewhere. </p>
</div></div></div><div class="footer"><p class="metadata">Last updated December 31st, 2010</p><hr /><div class="copy">Â© Nokia 2011.</div></div></body>
<!-- Mirrored from devlib.symbian.slions.net/s3/GUID-5107ABD8-6408-5501-8073-ACAF3719247B.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 06:07:09 GMT -->
</html>