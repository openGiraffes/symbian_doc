
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<!-- Mirrored from devlib.symbian.slions.net/s3/GUID-653A92FB-F752-5210-8C98-9F107D74DC67.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 06:12:43 GMT -->
<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="copyright" content="(C) Copyright 2011" /><meta name="DC.rights.owner" content="(C) Copyright 2011" /><meta name="DC.Type" content="concept" /><meta name="DC.Title" content="Forwarding or Replying to Email Messages Stored as Rich Text" /><meta name="abstract" content="This tutorial explains how to forward email messages that are stored as rich text." /><meta name="description" content="This tutorial explains how to forward email messages that are stored as rich text." /><meta name="DC.Relation" scheme="URI" content="GUID-2C8653F9-8873-59E8-9FD2-4215F6877ABC" /><meta name="DC.Relation" scheme="URI" content="GUID-D73AD200-BE4D-50BF-BCF9-14627DE530B7" /><meta name="DC.Relation" scheme="URI" content="GUID-BB35DBCC-FE56-547F-BADA-9EF854691ADC" /><meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7" /><meta name="DC.Relation" scheme="URI" content="GUID-5DD1010C-1648-5086-BA80-BC25F3C7A2C4" /><meta name="DC.Relation" scheme="URI" content="GUID-C290FA5E-8E41-5D19-B8C1-F88491EE6388" /><meta name="DC.Relation" scheme="URI" content="GUID-B394A824-8745-505E-8429-8B9B6D418387" /><meta name="DC.Relation" scheme="URI" content="GUID-DD27A452-8B0F-5C6D-A2E6-FC21145468B6" /><meta name="DC.Relation" scheme="URI" content="GUID-179099DA-1CD9-5912-B41B-363C132C7A86" /><meta name="DC.Relation" scheme="URI" content="GUID-9A3E0279-4F87-594D-A987-66DC77F408A0" /><meta name="DC.Format" content="XHTML" /><meta name="DC.Identifier" content="GUID-653A92FB-F752-5210-8C98-9F107D74DC67" /><meta name="DC.Language" content="en" /><title>Forwarding
or Replying to Email Messages Stored as Rich Text </title><link href="css/s60/style.css" rel="stylesheet" type="text/css" /><link href="PLUGINS_ROOT/com.nokia.forum.library/css/category_design.html" rel="stylesheet" type="text/css" /></head><body><div class="body"><div class="contentLeft prTxt"><h1 class="pageHeading" id="GUID-653A92FB-F752-5210-8C98-9F107D74DC67">Forwarding
or Replying to Email Messages Stored as Rich Text</h1><div><p>This tutorial explains how to forward email messages that are stored
as rich text. </p>
<div><h3 class="section-title">Procedure</h3> <ol id="GUID-4F6BB3EC-586E-5EAE-97DA-A4CF0E5017C8">
<li id="GUID-CB2BFF6E-193F-55F9-9559-B61FDFEE15E1"><a name="GUID-CB2BFF6E-193F-55F9-9559-B61FDFEE15E1"><!-- --></a><p>Use the CImEmailOperation::CreateForwardL() function
or the CreateReplyL() function to forward or reply to an
email. </p> <p>The newly created email will be stored in the same format as
the original email. In this case, it is rich text format and the formatting
information is preserved while forwarding or replying to the email. </p> </li>
<li id="GUID-38843C43-005E-5B42-9AAC-E098573C19AF"><a name="GUID-38843C43-005E-5B42-9AAC-E098573C19AF"><!-- --></a><p>Use the CImEmailOperation::ProgressL() function
to obtain the TMsvId parameter of the newly created email.
This is returned through a <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-36B29964-420D-38D0-AF08-4DA70BED8B6E.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-36B29964-420D-38D0-AF08-4DA70BED8B6E.html"><code class="apiname">TPckgC</code></a> &lt;TMsvId &gt;
descriptor. </p> </li>
<li id="GUID-86C3A5DB-6F5D-5E5C-9701-A74547EBAA97"><a name="GUID-86C3A5DB-6F5D-5E5C-9701-A74547EBAA97"><!-- --></a><p>Use the TMsvId <code class="codeph">aMessageId</code> parameter
to create a CMsvEntry object. </p> </li>
<li id="GUID-E3378D43-F39E-5C6C-96F6-9086713D0C84"><a name="GUID-E3378D43-F39E-5C6C-96F6-9086713D0C84"><!-- --></a><p>Use the CMsvEntry object
to create a CImEmailMessage object. </p> </li>
<li id="GUID-EE96F019-D147-5FD9-974B-A5C34ABD2A1D"><a name="GUID-EE96F019-D147-5FD9-974B-A5C34ABD2A1D"><!-- --></a><p>Use the  CImEmailMessage::GetBodyTextL() function
to get the body text of the message that is being replied to or forwarded.
This will return a CRichText class. </p> </li>
<li id="GUID-E3B9F2CC-512E-56DB-BC9C-825426C6FF45"><a name="GUID-E3B9F2CC-512E-56DB-BC9C-825426C6FF45"><!-- --></a><p>If you want to use the
rich text format, complete the following step 1. If you want to store the
body text in plain text format, complete the following steps from 2  to 4. </p> <ol type="a" id="GUID-CABBF3DD-DFB5-56EB-862A-E6A4CEC1C6C6">
<li id="GUID-57FC7507-A8D8-58B7-8282-3F349A69D0BD"><a name="GUID-57FC7507-A8D8-58B7-8282-3F349A69D0BD"><!-- --></a><p>Edit the CRichText class
and call the CImEmailMessage::StoreBodyTextL() function
to store the edited body text. </p> </li>
<li id="GUID-531982EB-3274-5891-BCB3-27D89EA075F1"><a name="GUID-531982EB-3274-5891-BCB3-27D89EA075F1"><!-- --></a><p>Call the CImEmailMessage::OpenPlainBodyTextForWriteL() function
to get CImPlainBody Text. </p> </li>
<li id="GUID-0CD62596-7491-541F-95EE-754904620B47"><a name="GUID-0CD62596-7491-541F-95EE-754904620B47"><!-- --></a><p>Call the CImPlainBodyText::StoreRichTextAsPlainTexL() function
and pass the edited CRichText class to store the message. </p> </li>
<li id="GUID-6BE40DD9-4D5F-527E-A7DB-2D5E1BEBB718"><a name="GUID-6BE40DD9-4D5F-527E-A7DB-2D5E1BEBB718"><!-- --></a><p>Call the CImPlainBodyText::CommitL() function
to complete the operation. </p> </li>
</ol> </li>
</ol> </div>
</div><h3>Related concepts</h3><ul><li><a href="GUID-2C8653F9-8873-59E8-9FD2-4215F6877ABC.html">Chunk Method
to Process Emails</a></li><li><a href="GUID-D73AD200-BE4D-50BF-BCF9-14627DE530B7.html">Imap4Example:
An Email manager  using IMAP4 and SMTP</a></li><li><a href="GUID-BB35DBCC-FE56-547F-BADA-9EF854691ADC.html">Pop3Example:
An Email manager using POP3 and SMTP</a></li></ul></div></div><div class="footer"><p class="metadata">Last updated November 9th, 2009</p><hr /><div class="copy">Â© Nokia 2011.</div></div></body>
<!-- Mirrored from devlib.symbian.slions.net/s3/GUID-653A92FB-F752-5210-8C98-9F107D74DC67.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 06:12:43 GMT -->
</html>