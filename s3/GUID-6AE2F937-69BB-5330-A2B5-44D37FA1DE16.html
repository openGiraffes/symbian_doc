
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<!-- Mirrored from devlib.symbian.slions.net/s3/GUID-6AE2F937-69BB-5330-A2B5-44D37FA1DE16.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 06:05:52 GMT -->
<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="copyright" content="(C) Copyright 2011" /><meta name="DC.rights.owner" content="(C) Copyright 2011" /><meta name="DC.Type" content="concept" /><meta name="DC.Title" content="Using TZoomFactor and MGraphicsDeviceMap" /><meta name="DC.Relation" scheme="URI" content="GUID-067BC702-4F66-5CAF-952D-7CFA35F5EB1E" /><meta name="DC.Relation" scheme="URI" content="GUID-1E68A78A-52E5-5DF7-B540-85C7194E4617" /><meta name="DC.Relation" scheme="URI" content="GUID-E9FF94D2-AFFD-54A4-A6C2-00929BC70DB0" /><meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7" /><meta name="DC.Relation" scheme="URI" content="GUID-975CBC70-81E6-5FA2-80CE-88DD2ABE9595" /><meta name="DC.Relation" scheme="URI" content="GUID-E89F034F-C807-5FF9-B06B-F7CCD2441041" /><meta name="DC.Relation" scheme="URI" content="GUID-1E68A78A-52E5-5DF7-B540-85C7194E4617" /><meta name="DC.Relation" scheme="URI" content="GUID-9BF04EB2-7050-51D2-9559-66BC47ECC5B1" /><meta name="DC.Format" content="XHTML" /><meta name="DC.Identifier" content="GUID-6AE2F937-69BB-5330-A2B5-44D37FA1DE16" /><meta name="DC.Language" content="en" /><title>Using TZoomFactor and MGraphicsDeviceMap </title><link href="css/s60/style.css" rel="stylesheet" type="text/css" /><link href="PLUGINS_ROOT/com.nokia.forum.library/css/category_design.html" rel="stylesheet" type="text/css" /></head><body><div class="body"><div class="contentLeft prTxt"><h1 class="pageHeading" id="GUID-6AE2F937-69BB-5330-A2B5-44D37FA1DE16">Using TZoomFactor and MGraphicsDeviceMap</h1><div><p>This topic provides examples that demonstrate the effects of different zoom factors on text and graphics. Example code displays some text, a rectangle, and a bitmap at various different zoom factors, with commentary text set at a fixed zoom factor. </p> <div><h3 class="section-title">Setting up a TZoomFactor</h3> <p>The following fragment of code demonstrates how to set up a zoom factor object. The zoom factor is first set to 1-to-1 (no zoom) using the value <code class="codeph">TZoomFactor::EZoomOneToOne</code>. Then it is shown how to set a zoom factor by multiplying or dividing <code class="codeph">EZoomOneToOne</code>. </p> <p>In actual applications, for example, one zoom factor could be used for the client area of an application which can be zoomed, and another for drawing menus and button-bars which should not be zoomed. </p> <pre class="codeblock">// Create zoom factor object
TZoomFactor devicemap(iCoeEnv-&gt;ScreenDevice());
    
// Set zoom factor at 1 to 1
devicemap.SetZoomFactor(TZoomFactor::EZoomOneToOne);
    
// Set zoom factor at 200%
devicemap.SetZoomFactor(TZoomFactor::EZoomOneToOne*2);</pre> </div> <div><h3 class="section-title">Twips to pixels conversions using a zoom factor</h3> <ol id="GUID-C7A9D77A-4074-513E-96C8-64771CD9DBE9"><li id="GUID-08C11537-63B4-5CC6-AA18-EFF020908395"><a name="GUID-08C11537-63B4-5CC6-AA18-EFF020908395"><!-- --></a><p>Define a rectangle in twips </p> </li> <li id="GUID-D91476D5-2244-5AA3-8536-C78A4A6DD4B5"><a name="GUID-D91476D5-2244-5AA3-8536-C78A4A6DD4B5"><!-- --></a><p>Use the device map’s conversion function <code class="codeph">TwipsToPixels()</code> to convert the rectangles co-ordinates into pixels </p> </li> <li id="GUID-2CDC8C9B-D04C-5DF7-BD15-0E6C03E46F35"><a name="GUID-2CDC8C9B-D04C-5DF7-BD15-0E6C03E46F35"><!-- --></a><p>Draw the rectangle using <code class="codeph">DrawRect()</code> in the graphics context <code class="codeph">gc</code> </p> </li> </ol> <pre class="codeblock">// set up example box in twips
TRect boxInTwips(TPoint(0,0),TPoint(500,300));
     
// convert rectangle co-ordinates into pixels
TRect boxInPixels = deviceMap-&gt;TwipsToPixels(boxInTwips);
gc.DrawRect(boxInPixels);</pre> <p> <strong>Note</strong>: The actual conversion that <code class="codeph">TwipsToPixels()</code> applies is dependent on the device map’s zoom factor setting, and the twips to pixels mapping of the graphics device which the device map is associated with. </p> </div> <div><h3 class="section-title">Drawing text using a zoom factor</h3> <p>This fragment of code shows how to draw text using a zoom factor. </p> <ol id="GUID-EF916973-472C-5CF8-8DA7-0C57811C610E"><li id="GUID-BD44D220-1803-5DE4-AEB2-7384B7AEAE11"><a name="GUID-BD44D220-1803-5DE4-AEB2-7384B7AEAE11"><!-- --></a><p>Create a font specification (in this case for a 10 point Times New Roman font) </p> </li> <li id="GUID-6F7C648C-C126-5E5D-BCDE-EEB700556BA2"><a name="GUID-6F7C648C-C126-5E5D-BCDE-EEB700556BA2"><!-- --></a><p>Find the nearest device font, using <code class="codeph">MGraphicsDeviceMap::GetNearestFontInTwips()</code>, to that specified. This takes into account the map’s zoom factor and twips to pixel mapping. </p> </li> <li id="GUID-C0A1C89C-5061-5D64-88AC-010C942E978D"><a name="GUID-C0A1C89C-5061-5D64-88AC-010C942E978D"><!-- --></a><p>Use this device font to draw the text using <code class="codeph">CGraphicsContext::DrawText()</code> </p> </li> <li id="GUID-531E3DEF-30EA-5526-854B-9848909950A3"><a name="GUID-531E3DEF-30EA-5526-854B-9848909950A3"><!-- --></a><p>Discard the font using <code class="codeph">CGraphicsContext::DiscardFont()</code> and <code class="codeph">MGraphicsDeviceMap::ReleaseFont()</code> </p> </li> </ol> <pre class="codeblock">// set up absolute font-spec and text box for 200 twip Roman font
TFontSpec fontSpec(_L("Times New Roman"),200);
    
// find the nearest font to the specified one
CFont* screenFont;
deviceMap-&gt;GetNearestFontInTwips(screenFont,fontSpec);
    
// use it for this graphics context
gc.UseFont(screenFont);
gc.DrawText(_L("some example text"),TPoint(20,20));
    
// discard and release font
gc.DiscardFont();
deviceMap-&gt;ReleaseFont(screenFont);</pre> <p> <strong>Note</strong>: Due to the overhead of running <code class="codeph">GetNearestFontInTwips()</code>, the caller would normally cache any fonts provided by it at the start of an application and after each change to the zoom factor, and only release them when the application is exited or the zoom factor changed. </p> </div> <div><h3 class="section-title">Zooming bitmaps</h3> <p>You can draw a bitmap to the graphics device, scaled according to the current zoom factor. </p> <ol id="GUID-8D34A01B-6AFC-50AE-8361-F4DACDF5F996"><li id="GUID-8DEB5B9C-9645-5E87-8246-3DAF8E7A8ABB"><a name="GUID-8DEB5B9C-9645-5E87-8246-3DAF8E7A8ABB"><!-- --></a><p>Define a rectangle in twips </p> </li> <li id="GUID-655DAAF4-D6F9-5DDD-8B6F-532BC8F67AE3"><a name="GUID-655DAAF4-D6F9-5DDD-8B6F-532BC8F67AE3"><!-- --></a><p>Use the device map’s conversion function <code class="codeph">TwipsToPixels()</code> to convert the rectangle's co-ordinates into pixels according to the current zoom factor. </p> </li> <li id="GUID-30E099EC-7864-5836-800B-BE06998AED0F"><a name="GUID-30E099EC-7864-5836-800B-BE06998AED0F"><!-- --></a><p>Draw the bitmap using <code class="codeph">DrawBitmap()</code> stretched/compressed into the rectangle. </p> </li> </ol> <pre class="codeblock">// set up rectangle for bitmap to be stretched into
TRect bitmapRectInTwips(TPoint(0,0),TPoint(500,500));
TRect bitmapRectInPixels = iLeftMap-&gt;TwipsToPixels(bitmapRectInTwips);
bitmapRectInPixels.iTl.iY+=125;
bitmapRectInPixels.iBr.iY+=125;
bitmapRectInPixels.iTl.iX+=100;
bitmapRectInPixels.iBr.iX+=100;
    
// draw the bitmap, stretched into the rectangle
SystemGc.DrawBitmap(bitmapRectInPixels, iBitmap);</pre> </div> </div><h3>Related concepts</h3><ul><li><a href="GUID-067BC702-4F66-5CAF-952D-7CFA35F5EB1E.html">Twip to Pixel Mapping</a></li><li><a href="GUID-1E68A78A-52E5-5DF7-B540-85C7194E4617.html">Graphics Device Interface Tutorials</a></li><li><a href="GUID-E9FF94D2-AFFD-54A4-A6C2-00929BC70DB0.html">Bitmaps</a></li></ul></div></div><div class="footer"><p class="metadata">Last updated October 8th, 2009</p><hr /><div class="copy">© Nokia 2011.</div></div></body>
<!-- Mirrored from devlib.symbian.slions.net/s3/GUID-6AE2F937-69BB-5330-A2B5-44D37FA1DE16.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 06:05:52 GMT -->
</html>