
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<!-- Mirrored from devlib.symbian.slions.net/s3/GUID-497930CE-4D61-50EE-A63B-3656158EE29C.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 05:50:09 GMT -->
<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="copyright" content="(C) Copyright 2011" /><meta name="DC.rights.owner" content="(C) Copyright 2011" /><meta name="DC.Type" content="concept" /><meta name="DC.Title" content="Thin Templates" /><meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7" /><meta name="DC.Relation" scheme="URI" content="GUID-35D7EEFC-B2E4-5444-8875-2A24790E08C2" /><meta name="DC.Format" content="XHTML" /><meta name="DC.Identifier" content="GUID-497930CE-4D61-50EE-A63B-3656158EE29C" /><meta name="DC.Language" content="en" /><title>Thin Templates </title><link href="css/s60/style.css" rel="stylesheet" type="text/css" /><link href="PLUGINS_ROOT/com.nokia.forum.library/css/category_design.html" rel="stylesheet" type="text/css" /></head><body><div class="body"><div class="contentLeft prTxt"><h1 class="pageHeading" id="GUID-497930CE-4D61-50EE-A63B-3656158EE29C">Thin Templates</h1><div><p>Symbian platform C++ uses C++ templates in an efficient way called the thin template idiom. </p> <p>Templates are particularly useful for collection classes, such as arrays. The class declaration: </p> <pre class="codeblock">class CArrayFixFlat&lt;T&gt; ...</pre> <p>specifies a family of array classes, which may contain any type. The template may be instantiated, for instance, as </p> <pre class="codeblock">CArrayFixFlat&lt;CCoeControl*&gt;* iControls;</pre> <p>which declares an array of <code class="codeph">CCoeControl*</code> pointers. Other collection classes use the same idea, for instance <code class="codeph">TPckgBuf&lt;T&gt;</code>, <code class="codeph">TSglQue&lt;T&gt;</code> etc. </p> <p>Templates may also use other parameters, such as an integer: </p> <pre class="codeblock">class TBufC&lt;TInt S&gt; ...;</pre> <p>This type of template class may be instantiated also: </p> <pre class="codeblock">TBufC&lt;20&gt; name; </pre> <p>The functionality provided by templates is powerful, and highly desirable. Without templates, collection classes usually use <code class="codeph">void*</code> pointers: as a result, they are not typesafe. </p> <p>Templates can be difficult to manage. A template really defines a whole family of classes. Each member of that family that is instantiated requires its own object code. Avoidance of object code duplication is a difficult issue in a C++ implementation. For the Symbian platform, object code duplication must be avoided at all costs. The solution used is the <em>thin template idiom</em>. </p> <p>The thin template idiom begins with a base class, code in terms of <code class="codeph">TAny*</code> parameters: </p> <pre class="codeblock">class CArrayFixBase ... {
    IMPORT_C const TAny* At(TInt aIndex) const;</pre> <p>This base class has the real code, just once. The code resides in a single DLL and is exported from that DLL. The base class may be fat: it may contain an arbitrary amount of code. </p> <p>Then, a derived class is used as follows: </p> <pre class="codeblock">class CArrayFix&lt;T&gt; : public CArrayFixBase {
    inline const T&amp; At(TInt aIndex) const
    {return(*((const T *)CArrayFixBase::At(anIndex)));}</pre> <p>Because this class uses only inline functions, it generates no extra code. But because the casting is encapsulated in the inline function, the class is typesafe to its users. The templated class is thin: it generates no code at all. </p> </div></div></div><div class="footer"><p class="metadata">Last updated November 11th, 2010</p><hr /><div class="copy">Â© Nokia 2011.</div></div></body>
<!-- Mirrored from devlib.symbian.slions.net/s3/GUID-497930CE-4D61-50EE-A63B-3656158EE29C.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 05:50:09 GMT -->
</html>