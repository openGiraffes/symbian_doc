
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<!-- Mirrored from devlib.symbian.slions.net/s3/GUID-A3320A1E-E85E-508D-A47E-E35824C947A3.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 06:00:55 GMT -->
<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="copyright" content="(C) Copyright 2011" /><meta name="DC.rights.owner" content="(C) Copyright 2011" /><meta name="DC.Type" content="concept" /><meta name="DC.Title" content="Non-embeddable Applications" /><meta name="DC.Relation" scheme="URI" content="GUID-940F3F6E-BA9C-5E19-9AC5-D848B5E175FB" /><meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7" /><meta name="DC.Relation" scheme="URI" content="GUID-58035B49-2EAE-5144-B226-28AF2EDD62E7" /><meta name="DC.Relation" scheme="URI" content="GUID-58CA15F8-D984-5D07-8C00-161FA16A8FD3" /><meta name="DC.Relation" scheme="URI" content="GUID-1578590A-FC00-5C3B-8BF9-F6E43CA9D9A0" /><meta name="DC.Relation" scheme="URI" content="GUID-D2E19490-4179-548F-9DA8-9AE637FAC9E2" /><meta name="DC.Relation" scheme="URI" content="GUID-C4CC3CA3-8C02-5F73-A482-4F849DD08111" /><meta name="DC.Relation" scheme="URI" content="GUID-3CAD7211-2164-5F93-9EA7-7167E1C14012" /><meta name="DC.Format" content="XHTML" /><meta name="DC.Identifier" content="GUID-A3320A1E-E85E-508D-A47E-E35824C947A3" /><meta name="DC.Language" content="en" /><title>Non-embeddable Applications </title><link href="css/s60/style.css" rel="stylesheet" type="text/css" /><link href="PLUGINS_ROOT/com.nokia.forum.library/css/category_design.html" rel="stylesheet" type="text/css" /></head><body><div class="body"><div class="contentLeft prTxt"><h1 class="pageHeading" id="GUID-A3320A1E-E85E-508D-A47E-E35824C947A3">Non-embeddable Applications</h1><div><div><h3 class="section-title">Procedure</h3> <p>The <code class="codeph">TARGETTYPE</code> in the MMP file changes from <code class="codeph">app</code> to <code class="codeph">exe</code>. However, for applications that need to also run on the EKA1 emulator, the <code class="codeph">TARGETTYPE</code> must be <code class="codeph">exedll</code>. Hence, the following lines should replace the existing <code class="codeph">TARGET</code> and <code class="codeph">TARGETTYPE</code> lines: </p> <pre class="codeblock">#if !defined(EKA2) &amp;&amp; defined(WINS) 
TARGET ExeAppTest.app 
TARGETTYPE exedll 
deffile \epoc32\release\wins\exedllapp.def 
#else 
TARGET ExeAppTest.exe 
TARGETTYPE exe 
#endif</pre> <p>The <code class="codeph">TARGET</code> filename's extension should be <code>.exe</code>. It is also important is that the second UID (the application identifier) remains the same: <code class="codeph">0x100039CE</code>. For EKA1 emulator builds, the binary produced is a DLL with the entry point exported at ordinal one. Therefore, as in the example above, a <code class="codeph">deffile</code> statement is used to define the export. </p> <p>The stack size should be explicitly set to a value greater than the default of 8K. Previously, applications were launched in a process initiated by <code>apprun.exe</code> which had a stack size of 20K. Therefore, to ensure the converted application will not have any problems with stack size, this is the minimum value the stack size should be set to. This is done in the MMP file with the line: </p> <pre class="codeblock">epocstacksize 0x5000</pre> <p>Note that embedding an EXE-app inside another EXE-app (see the <a href="GUID-BD7C45B2-11BF-5162-9F9B-B84E51C5C6D4.html#GUID-4CE56897-FEB9-523F-843A-E5BAFFDBBCDB">Embeddable applications</a> section below) is enough to overflow the default 8K stack. </p> <p>The API for starting the application framework is in <code>eikcore.dll</code>, so <code>eikcore.lib</code> needs to be listed in the <code class="codeph">LIBRARY</code> section of the MMP file. </p> <p>The <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-E5533B10-D01F-3133-8E74-28071766885B.html#GUID-275C4B9B-53BD-38C5-8C8E-05D480358836"><code class="apiname">EikStart::RunApplication()</code></a> function needs to be called from the EXE's entry point, passing as an argument a pointer-to-function which creates an instance of the <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-C0297A58-2E39-3211-A2B4-C334192CE2A7.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-C0297A58-2E39-3211-A2B4-C334192CE2A7.html"><code class="apiname">CApaApplication</code></a> -derived class (this is the same function that is exported at ordinal 1 for DLL-apps). In EKA1 emulator builds, the command line also needs to be passed to this function. This is demonstrated by the following code, which works for all builds: </p> <pre class="codeblock">#include &lt;eikstart.h&gt; 
LOCAL_C CApaApplication* NewApplication()
    {
    return new CExampleApplication;
    } 
GLDEF_C TInt E32Main()
    {
    return EikStart::RunApplication(NewApplication);
    }

#if defined(__WINS__) &amp;&amp; !defined(EKA2) 
GLDEF_C TInt E32Dll(TDllReason)
    {
    return KErrNone;
    } 
EXPORT_C TInt WinsMain(TDesC* aCmdLine)
    {
    return EikStart::RunApplication(NewApplication, aCmdLine);
    } 
#endif</pre> <p>If the application needs to store configuration or application data, a private directory will need to be created. For more information on private directories, see the documentation on the <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-E263C747-946F-35AA-9F1D-41833BD350FC.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-E263C747-946F-35AA-9F1D-41833BD350FC.html"><code class="apiname">RFs</code></a> class. </p> <p>The relevant functions in the <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-E263C747-946F-35AA-9F1D-41833BD350FC.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-E263C747-946F-35AA-9F1D-41833BD350FC.html"><code class="apiname">RFs</code></a> class for private directories are are: </p> <dl><dt class="dlterm"><code class="codeph"> RFs::PrivatePath</code> </dt> <dd><p>gets the private path for a process </p> </dd> <dt class="dlterm"> <code class="codeph">RFs::CreatePrivatePath</code> </dt> <dd><p>creates the private directory for a process on the specified drive </p> </dd> <dt class="dlterm"><code class="codeph">RFs::SetSessionToPrivate</code> </dt> <dd><p>sets the session path to point to the private directory on the specified drive </p> </dd> </dl> </div> </div><h3>Related concepts</h3><ul><li><a href="GUID-940F3F6E-BA9C-5E19-9AC5-D848B5E175FB.html">Application
                Architecture Overview</a></li></ul></div></div><div class="footer"><p class="metadata">Last updated October 8th, 2009</p><hr /><div class="copy">Â© Nokia 2011.</div></div></body>
<!-- Mirrored from devlib.symbian.slions.net/s3/GUID-A3320A1E-E85E-508D-A47E-E35824C947A3.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 06:00:55 GMT -->
</html>