
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<!-- Mirrored from devlib.symbian.slions.net/s3/GUID-ACE7D63F-9544-56DB-A72D-FFB0A35661EC.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 05:59:55 GMT -->
<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="copyright" content="(C) Copyright 2011" /><meta name="DC.rights.owner" content="(C) Copyright 2011" /><meta name="DC.Type" content="task" /><meta name="DC.Title" content="Loading a Symbian platform Defined Table, Changing a Field, Write Changed Record: Tutorial" /><meta name="abstract" content="This tutorial shows you how to load a Symbian platform defined table from the Comms Database, change a field, and write the changed record to the database." /><meta name="description" content="This tutorial shows you how to load a Symbian platform defined table from the Comms Database, change a field, and write the changed record to the database." /><meta name="DC.Relation" scheme="URI" content="GUID-1AFDDD6F-CB99-587D-A0B5-D3F5B27F7135" /><meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7" /><meta name="DC.Relation" scheme="URI" content="GUID-8F2D6AC8-8357-55C7-970B-CD2684BA9B04" /><meta name="DC.Relation" scheme="URI" content="GUID-C3018CEE-865B-595A-A735-40E11665E50A" /><meta name="DC.Relation" scheme="URI" content="GUID-BD971173-E009-58DA-AF9C-F4AAFF77B138" /><meta name="DC.Format" content="XHTML" /><meta name="DC.Identifier" content="GUID-ACE7D63F-9544-56DB-A72D-FFB0A35661EC" /><meta name="DC.Language" content="en" /><title>Loading
a Symbian platform Defined Table, Changing a Field, Write Changed Record:
Tutorial </title><link href="css/s60/style.css" rel="stylesheet" type="text/css" /><link href="PLUGINS_ROOT/com.nokia.forum.library/css/category_design.html" rel="stylesheet" type="text/css" /></head><body><div class="body"><div class="contentLeft prTxt"><h1 class="pageHeading" id="GUID-ACE7D63F-9544-56DB-A72D-FFB0A35661EC">Loading
a Symbian platform Defined Table, Changing a Field, Write Changed Record:
Tutorial</h1><div><p>This tutorial shows you how to load a Symbian platform defined
table from the Comms Database, change a field, and write the changed record
to the database. </p>
<div id="GUID-9837C422-F698-5621-AE3D-2410D5FBDA37"><h3 class="section-title">Context</h3><p>This tutorial shows
you: </p> <ul>
<li id="GUID-72E9465D-1003-521A-8449-37ABB8A5F84E"><a name="GUID-72E9465D-1003-521A-8449-37ABB8A5F84E"><!-- --></a><p>how to load the <em>Internet
Access Points Configuration</em> table. This table is also called the IAP table </p> </li>
<li id="GUID-E4E3455F-1A38-53A2-B609-314580025107"><a name="GUID-E4E3455F-1A38-53A2-B609-314580025107"><!-- --></a><p>how to search for a
records that have a specific <em>Service Type</em> field. </p> </li>
<li id="GUID-810269E0-5159-5028-9A8F-E9DEA5BCB815"><a name="GUID-810269E0-5159-5028-9A8F-E9DEA5BCB815"><!-- --></a><p>how to change the <em>Network
Weighting</em> field in the last record found </p> </li>
<li id="GUID-240F862B-4292-5E86-A7F2-AEF989BBAF7F"><a name="GUID-240F862B-4292-5E86-A7F2-AEF989BBAF7F"><!-- --></a><p>how to store the changed
record in the Comms Database. </p> </li>
</ul> <p>The principles that apply here also apply to the other Symbian platform
defined tables. </p> </div><div id="GUID-A9D46D95-97E9-537C-BDAA-80CF7A780A99"><h3 class="section-title">Prerequisites</h3><p>Before you start,
you must understand: </p> <ul>
<li id="GUID-A70B727A-1BE6-5443-91DD-103CD9842F16"><a name="GUID-A70B727A-1BE6-5443-91DD-103CD9842F16"><!-- --></a><p>the general concept
of the Comms Database </p> </li>
<li id="GUID-15D683C4-D755-5BEC-845D-A81891190114"><a name="GUID-15D683C4-D755-5BEC-845D-A81891190114"><!-- --></a><p>the specific concept
of fields, records, links and tables </p> </li>
<li id="GUID-686874B2-2B58-5B2A-A9FF-71C156232E62"><a name="GUID-686874B2-2B58-5B2A-A9FF-71C156232E62"><!-- --></a><p>how to write and build
application code to run on Symbian platform </p> </li>
</ul> </div>
<h3>Steps</h3><ol id="GUID-DCCB1FCB-FC9C-5D02-AD5C-F85560BE77E4"><a name="GUID-DCCB1FCB-FC9C-5D02-AD5C-F85560BE77E4"><!-- --></a>
<li id="GUID-F8378F77-253C-5FC0-9235-05E15F8A7E2F"><a name="GUID-F8378F77-253C-5FC0-9235-05E15F8A7E2F"><!-- --></a><p>Make sure that you
have created a session. </p>
</li>
<li id="GUID-6FD057FB-F78B-5524-8DAB-9EF7EEE03DC7"><a name="GUID-6FD057FB-F78B-5524-8DAB-9EF7EEE03DC7"><!-- --></a><p>Create the table
object in the tool or application process. </p>

You create a <strong class="conversion-error-message" title="[NOKX000E] Unable to find definition for key reference 'CommsDat'">[[[ERROR: [NOKX000E] Unable to find definition for key reference 'CommsDat']]]</strong><a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-1CDD0B97-8B00-3373-9908-512C9BC1CF51.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-1CDD0B97-8B00-3373-9908-512C9BC1CF51.html"><code class="apiname">CMDBRecordSet</code></a> <code class="codeph">&lt;T&gt;</code> object
and specify <strong class="conversion-error-message" title="[NOKX000E] Unable to find definition for key reference 'CommsDat'">[[[ERROR: [NOKX000E] Unable to find definition for key reference 'CommsDat']]]</strong><a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-1CDD0B97-8B00-3373-9908-512C9BC1CF51.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-1CDD0B97-8B00-3373-9908-512C9BC1CF51.html"><code class="apiname">CCDIAPRecord</code></a> as the template
parameter. 

Symbian platform defines the <code class="codeph">CCDIAPRecord</code> class to
represent a IAP record. The class is a schema for the record. The class defines
the fields and links that make a IAP record. 
Symbian platform defines <a href="GUID-6DAF85AD-E412-5823-81C2-FC1755A90A84.html#GUID-32E556BC-55C3-5FBD-9A60-9708139C20D6">unique
numeric Id</a> s for Symbian platform defined tables. The symbol <strong class="conversion-error-message" title="[NOKX000E] Unable to find definition for key reference 'CommsDat'">[[[ERROR: [NOKX000E] Unable to find definition for key reference 'CommsDat']]]</strong><a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-1CDD0B97-8B00-3373-9908-512C9BC1CF51.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-1CDD0B97-8B00-3373-9908-512C9BC1CF51.html"><code class="apiname">KCDTIdIAPRecord</code></a> defines the value of this Id for
the IAP table. The Id allows the CommsDat API to retrieve the table from the
Comms Database efficiently. 
To work with other Symbian platform defined tables, use the correct
class name and the correct unique numeric Id values. The <a href="GUID-58089281-9DD0-502D-8DFD-831E7BAA931E.html">Reference</a> section
contains a list of all Symbian platform defined tables. 
 <pre class="codeblock">...

// This code fragment assumes that a session with the Comms Database has been created.
// iDb is a pointer to a CMDBSession object
...

// Use the standard "new (ELeave)" construction to create the object to 
// represent the table. 
//
// Note:
// 1. the template parameter CCDIAPRecord defines 
//    the "IAP" record type.
// 2. the unique numeric Id KCDTIdIAPRecord is passed as a parameter
//    to the constructor.
CMDBRecordSet&lt;CCDIAPRecord&gt;* iapRecordSet = 
   new (ELeave) CMDBRecordSet&lt;CCDIAPRecord&gt;(KCDTIdIAPRecord);
...
             </pre>
</li>
<li id="GUID-78143DEF-8DA6-5FAB-A2D1-60891D85CED9"><a name="GUID-78143DEF-8DA6-5FAB-A2D1-60891D85CED9"><!-- --></a><p>Create a record
that contains the type of Service Typefield needed. </p>

To search for a record the tool or application creates a record in memory.
The fields in the record are set to the specific values on which the search
is to match. In this tutorial this record is called the "search record". The
record is appended to the set of records in the table object. At this point,
the search record is the only record in the table, because the Comms Database
has not yet been accessed. 

In this tutorial, the Service Type field in the search record is set
to DialOutISP. 
 <pre class="codeblock">...
// Searching for all IAP records that support the DialOutISP service.
_LIT(KServiceType, "DialOutISP");

    
// Create the "search record". You use the unique numeric Id KCDTIdIAPRecord 
// to identify the type record to the factory function.
CCDIAPRecord* ptrPrimingRecord = static_cast&lt;CCDIAPRecord *&gt;
    (CCDRecordBase::RecordFactoryL(KCDTIdIAPRecord));


// Prime the Service    Types field with the string "DialOutISP"
ptrPrimingRecord-&gt;iServiceType.SetMaxLengthL(KServiceType().Length());
ptrPrimingRecord-&gt;iServiceType = KServiceType; 


// Append the search record to the table in memory. Remember that the table only 
// contains this record. The Comms Database has not yet been accessed.
iapRecordSet-&gt;iRecords.AppendL(ptrPrimingRecord);


// Set the record pointer to NULL, because ownership of the "search record" has
// been passed to the table object.
ptrPrimingRecord = NULL; 
...</pre>
</li>
<li id="GUID-CAE140E8-AE1E-5B7A-A9E1-4A0885F02429"><a name="GUID-CAE140E8-AE1E-5B7A-A9E1-4A0885F02429"><!-- --></a><p>Perform the search. </p>

Use the <code class="codeph">FindL()</code> function to search the table in the
Comms Database. The function is called on the class that defines the table.
The function is implemented in the base class <strong class="conversion-error-message" title="[NOKX000E] Unable to find definition for key reference 'CommsDat'">[[[ERROR: [NOKX000E] Unable to find definition for key reference 'CommsDat']]]</strong><a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-1CDD0B97-8B00-3373-9908-512C9BC1CF51.html#GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-1CDD0B97-8B00-3373-9908-512C9BC1CF51.html"><code class="apiname">MMetaDatabase</code></a>.
You pass a reference to the session object into the <code class="codeph">FindL()</code> function. 
 <pre class="codeblock">...
// Perform the search. 
if(iapRecordSet-&gt;FindL(*iDb))
    {
    // At least one record found. 
    // Find the number of records found.   
    TInt iapRecordsFound = iapRecordSet-&gt;iRecords.Count();

    // Change the Network Weighting field in the last record.
    CCDIAPRecord* iapRecord = 
        static_cast&lt;CCDIAPRecord*&gt;( iapRecordSet-&gt;iRecords [iapRecordsFound-1]);
    iapRecord-&gt;iNetworkWeighting = 1;

    // Update the changed record in the Comms Database
    
    // EITHER
    // Check through all records and submit all changes
    // made by the tool or application.
    iapRecordSet-&gt;ModifyL(*iDb);

    // OR 
    // Explicitly submit this record only
    iapRecord -&gt;ModifyL(*iDb); 
    ...
    }
else 
    {
    // No matching records found.
    // Note that iRecords[0] still contains the "search record". The "search record"
    // only contains the priming values.
    // It is important to check the return code from the call to ModifyL()
    }           
...</pre>
</li>
</ol>
</div><h3>Related concepts</h3><ul><li><a href="GUID-1AFDDD6F-CB99-587D-A0B5-D3F5B27F7135.html">Comms Database
                concepts</a></li></ul></div></div><div class="footer"><p class="metadata">Last updated November 23rd, 2009</p><hr /><div class="copy">© Nokia 2011.</div></div></body>
<!-- Mirrored from devlib.symbian.slions.net/s3/GUID-ACE7D63F-9544-56DB-A72D-FFB0A35661EC.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 05:59:55 GMT -->
</html>